<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GLAMERDOC++: SLsimLib/include/lens_halos.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GLAMERDOC++
   </div>
   <div id="projectbrief">Gravitational Lensing Code Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_55925bd33ed9b71a1b473542f7ae7f24.html">SLsimLib</a></li><li class="navelem"><a class="el" href="dir_d255db3c0926674bed0b75f79a4d7ac7.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">lens_halos.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * lens_halos.h</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  Created on: 06.05.2013</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#ifndef LENS_HALOS_H_</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#define LENS_HALOS_H_</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//#include &quot;standard.h&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_input_params_8h.html">InputParams.h</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//#include &quot;source.h&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//#include &quot;point.h&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;quadTree.h&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="particle__types_8h.html">particle_types.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;image_processing.h&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;complex&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;complex.h&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#ifdef ENABLE_CERF</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;cerf.h&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#ifdef ENABLE_EIGEN</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//#include &lt;/usr/local/include/eigen3/Eigen/Dense&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;eigen3/Eigen/Dense&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;eigen3/Eigen/StdVector&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;boost/math/special_functions/gamma.hpp&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="class_lens_halo.html">   56</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_lens_halo.html">LensHalo</a>{</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; <a class="code" href="class_lens_halo.html#a813618bcd6d1f26dafa49a2e509a37db">LensHalo</a>();</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <a class="code" href="class_lens_halo.html#a813618bcd6d1f26dafa49a2e509a37db">LensHalo</a>(PosType z,<span class="keyword">const</span> COSMOLOGY &amp;cosmo);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <span class="comment">//LensHalo(InputParams&amp; params,COSMOLOGY &amp;cosmo,bool needRsize = true);</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="comment">//LensHalo(InputParams&amp; params,bool needRsize = true);</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <a class="code" href="class_lens_halo.html#a813618bcd6d1f26dafa49a2e509a37db">LensHalo</a>(<span class="keyword">const</span> <a class="code" href="class_lens_halo.html">LensHalo</a> &amp;h);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="class_lens_halo.html#a813618bcd6d1f26dafa49a2e509a37db">LensHalo</a>(<a class="code" href="class_lens_halo.html">LensHalo</a> &amp;&amp;h){</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">//    LensHalo(LensHalo &amp;&amp;h):star_tree(nullptr){</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    *<span class="keyword">this</span> = std::move(h);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; <span class="keyword">virtual</span> ~<a class="code" href="class_lens_halo.html">LensHalo</a>();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="class_lens_halo.html">LensHalo</a> &amp; <a class="code" href="class_lens_halo.html#aaa135c7e56a24de4a1dee76604a44141">operator=</a>(<span class="keyword">const</span> <a class="code" href="class_lens_halo.html">LensHalo</a> &amp;h);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="class_lens_halo.html">LensHalo</a> &amp; <a class="code" href="class_lens_halo.html#aaa135c7e56a24de4a1dee76604a44141">operator=</a>(<a class="code" href="class_lens_halo.html">LensHalo</a> &amp;&amp;h);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">int</span> tag=0; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  </div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a6aee0c9abc88ca6d3d8ed9e44a18e6e3">   79</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">float</span> <a class="code" href="class_lens_halo.html#a6aee0c9abc88ca6d3d8ed9e44a18e6e3">get_Rmax</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Rmax; }</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a2616defcc052fd9ab1e568cfd8a5c9a9">   81</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">float</span> <a class="code" href="class_lens_halo.html#a2616defcc052fd9ab1e568cfd8a5c9a9">getRsize</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> Rsize; }</div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a5f7d67a341a08313a8920a1b8bd3d8bf">   83</a></span>&#160;  <span class="keyword">inline</span> <span class="keywordtype">float</span> <a class="code" href="class_lens_halo.html#a5f7d67a341a08313a8920a1b8bd3d8bf">get_mass</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> mass; }</div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="class_lens_halo.html#ad13e77713ccce39fd925e810063cbae3">   85</a></span>&#160; <span class="keyword">inline</span> <span class="keywordtype">float</span> <a class="code" href="class_lens_halo.html#ad13e77713ccce39fd925e810063cbae3">get_rscale</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="class_lens_halo.html#ad0138e93c3a165ae25cd42bea42c4c4b">rscale</a>; }</div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a01ce57465ce8d14670804096aee578c7">   87</a></span>&#160; <span class="keyword">inline</span> PosType <a class="code" href="class_lens_halo.html#a01ce57465ce8d14670804096aee578c7">getZlens</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> zlens; }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="comment">// set the position of the Halo in physical Mpc on the lens plane</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">//void setX(PosType PosX, PosType PosY) { posHalo[0] = PosX ; posHalo[1] = PosY ; }</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <span class="comment">// set the position of the Halo in physical Mpc on the lens plane</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <span class="comment">//void setX(PosType *PosXY) { posHalo[0] = PosXY[0] ; posHalo[1] = PosXY[1] ; }</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  </div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a04e4a630ac49ff76831e06fb1ab0d669">   95</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a04e4a630ac49ff76831e06fb1ab0d669">getX</a>(PosType * MyPosHalo)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    assert(Dist != -1);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    MyPosHalo[0] = posHalo[0]*Dist;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    MyPosHalo[1] = posHalo[1]*Dist;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a1fe8d2ac9d3b276cc5c473107a999b2d">  102</a></span>&#160;  PosType <a class="code" href="class_lens_halo.html#a1fe8d2ac9d3b276cc5c473107a999b2d">operator[]</a>(<span class="keywordtype">int</span> i)<span class="keyword"> const</span>{<span class="keywordflow">return</span> posHalo[i]*Dist;}</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  </div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a4ad6ef27f481ed707031b3c5f9f5e435">  105</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a4ad6ef27f481ed707031b3c5f9f5e435">setTheta</a>(PosType PosX, PosType PosY) { posHalo[0] = PosX ; posHalo[1] = PosY ; }</div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a5a36eb5a13d944c34ad0cd56b1b8e598">  107</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a5a36eb5a13d944c34ad0cd56b1b8e598">setTheta</a>(PosType *PosXY) { posHalo[0] = PosXY[0] ; posHalo[1] = PosXY[1] ; }</div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a9abe01ec8275570e899e3675da663981">  109</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a9abe01ec8275570e899e3675da663981">setTheta</a>(<span class="keyword">const</span> <a class="code" href="struct_point__2d.html">Point_2d</a> &amp;p) { posHalo[0] = p[0] ; posHalo[1] = p[1] ; }</div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a65304f5eeabf9d8e0209691e3ee16820">  111</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a65304f5eeabf9d8e0209691e3ee16820">getTheta</a>(PosType * MyPosHalo)<span class="keyword"> const </span>{ MyPosHalo[0] = posHalo[0] ; MyPosHalo[1] = posHalo[1]; }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  </div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a88159eac5a61762fffca24e508c2dccd">  114</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a88159eac5a61762fffca24e508c2dccd">setDist</a>(COSMOLOGY &amp;co){Dist = co.angDist(zlens);}</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a50bd89dc5d7d11932c757eb4e962b6ba">  118</a></span>&#160;  PosType <a class="code" href="class_lens_halo.html#a50bd89dc5d7d11932c757eb4e962b6ba">getDist</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> Dist;}</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a81938111b0d90611edcff8b2d4dd8432">  122</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a81938111b0d90611edcff8b2d4dd8432">displayPos</a>() { std::cout &lt;&lt; <span class="stringliteral">&quot;Halo PosX = &quot;</span> &lt;&lt; posHalo[0] &lt;&lt; <span class="stringliteral">&quot; ; Halo PosY = &quot;</span> &lt;&lt; posHalo[1] &lt;&lt; std::endl; }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  </div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a645d2cbd9e686ce0d061d83d28c88eb0">  125</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a645d2cbd9e686ce0d061d83d28c88eb0">initFromFile</a>(<span class="keywordtype">float</span> my_mass, <span class="keywordtype">long</span> *seed, <span class="keywordtype">float</span> vmax, <span class="keywordtype">float</span> r_halfmass){};</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a8b31bdf68c61572e7a32dc3da6b139c8">initFromMassFunc</a>(<span class="keywordtype">float</span> my_mass, <span class="keywordtype">float</span> my_Rsize, <span class="keywordtype">float</span> my_rscale, PosType my_slope, <span class="keywordtype">long</span> *seed);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  </div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="class_lens_halo.html#ac43654064fefbfecd0d7c9c1887fadad">  130</a></span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#ac43654064fefbfecd0d7c9c1887fadad">set_RsizeRmax</a>(<span class="keywordtype">float</span> my_Rsize){Rmax = Rmax*my_Rsize/Rsize; Rsize = my_Rsize; xmax = Rsize/<a class="code" href="class_lens_halo.html#ad0138e93c3a165ae25cd42bea42c4c4b">rscale</a>;};</div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a55b64efb4df0a26188ee558afa90d6bf">  132</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a55b64efb4df0a26188ee558afa90d6bf">set_mass</a>(<span class="keywordtype">float</span> my_mass){mass=my_mass;};</div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a68e3f2ba68f2d93202985fb317cf0a14">  134</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a68e3f2ba68f2d93202985fb317cf0a14">set_rscale</a>(<span class="keywordtype">float</span> my_rscale){<a class="code" href="class_lens_halo.html#ad0138e93c3a165ae25cd42bea42c4c4b">rscale</a>=my_rscale; xmax = Rsize/<a class="code" href="class_lens_halo.html#ad0138e93c3a165ae25cd42bea42c4c4b">rscale</a>;};</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="comment">//void setZlens(PosType my_zlens){zlens=my_zlens; Dist=-1;}</span></div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a3c28739f7088e24bda7d67b14f50d4ba">  137</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a3c28739f7088e24bda7d67b14f50d4ba">setZlens</a>(PosType my_zlens,<span class="keyword">const</span> COSMOLOGY &amp;cosmo){</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    zlens=my_zlens;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    Dist=cosmo.angDist(my_zlens);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <span class="keywordtype">void</span> setRsize(PosType R){Rsize = R;}</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="comment">// ste redshift and distance</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordtype">void</span> setZlensDist(PosType my_zlens,<span class="keyword">const</span> COSMOLOGY &amp;cos){</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    zlens=my_zlens;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    Dist = cos.angDist(zlens);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordtype">void</span> setMass(PosType m){mass = m;}</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  </div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="class_lens_halo.html#ababdb795dfb3955b14078a8fe777d608">  152</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#ababdb795dfb3955b14078a8fe777d608">set_slope</a>(PosType my_slope){beta=my_slope;};</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a2deb914a879890de10a76323cf056aae">  154</a></span>&#160;  <span class="keyword">virtual</span> PosType <a class="code" href="class_lens_halo.html#a2deb914a879890de10a76323cf056aae">get_slope</a>(){<span class="keywordflow">return</span> beta;};</div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a122a8066d3746da81768627a19aaa69c">  156</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="class_lens_halo.html#a122a8066d3746da81768627a19aaa69c">get_flag_elliptical</a>(){<span class="keywordflow">return</span> elliptical_flag;};</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keywordtype">void</span> set_flag_elliptical(<span class="keywordtype">bool</span> ell){elliptical_flag=ell;};</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordtype">bool</span> get_switch_flag(){<span class="keywordflow">return</span> switch_flag;}; </div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a907cc0b6b9bc12f90ed7e61a674dff26">  159</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a907cc0b6b9bc12f90ed7e61a674dff26">set_switch_flag</a>(<span class="keywordtype">bool</span> swt){switch_flag=swt;}; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  </div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="class_lens_halo.html#ae93d20b6fdeaaab7d1f0a61a13e6d644">  163</a></span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#ae93d20b6fdeaaab7d1f0a61a13e6d644">setCosmology</a>(<span class="keyword">const</span> COSMOLOGY&amp; cosmo) {}</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; <span class="comment">/* calculate the lensing properties -- deflection, convergence, and shear</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">   if not overwritten by derived class it uses alpha_h(), gamma_h(), etc. of the</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">   derived case or for a point source in this class</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">   </span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">   xcm - the physical position on the lens plane relative to the center of the LensHalo in Mpc</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">  Units :</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">   </span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">  ALPHA    -    mass/PhysMpc - ALPHA / Sig_crit / Dl is the deflection in radians</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">  KAPPA    -    surface mass density , mass / /PhysMpc/PhysMpc - KAPPA / Sig_crit is the convergence</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">  GAMMA    -    mass / /PhysMpc/PhysMpc - GAMMA / Sig_crit is the shear</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">  PHI      -    mass - PHI / Sig_crit is the lensing potential</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">   </span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">* returns the lensing quantities of a ray in center of mass coordinates.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">   *  Warning: This adds to input value of alpha, kappa, gamma, and phi.  They need</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">   *  to be zeroed out if the contribution of just this halo is wanted.</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a460de105e52520a328d5912455c02fdd">force_halo</a>(</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      PosType *alpha          </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      ,KappaType *kappa     </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      ,KappaType *gamma     </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      ,KappaType *phi       </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      ,PosType <span class="keyword">const</span> *xcm   </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      ,<span class="keywordtype">bool</span> subtract_point=<span class="keyword">false</span> </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      ,PosType screening=1.0   </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  );</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; <span class="comment">//void force_stars(PosType *alpha,KappaType *kappa,KappaType *gamma,PosType const *xcm);</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  </div>
<div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a9125a5a6f4685d157dfbeacd00433ab2">  196</a></span>&#160; <span class="keywordtype">bool</span> <a class="code" href="class_lens_halo.html#a9125a5a6f4685d157dfbeacd00433ab2">compareZ</a>(PosType z){<span class="keywordflow">return</span> z &gt; zlens;};</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">//  bool AreStarsImplanted() const {return stars_implanted;}</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">//  void implant_stars(PosType **centers,int Nregions,long *seed, IMFtype type=One);</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">//  void implant_stars(PosType *center,long *seed,IMFtype type = One);</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">//  //void implant_stars(PosType *x,PosType *y,int Nregions,long *seed,IMFtype type=One);</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">//  void remove_stars();</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">//  IMFtype getStarIMF_type() const {return main_stars_imf_type;}</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">//  /// Fraction of surface density in stars</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">//  PosType getFstars() const {return star_fstars;}</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">//  /// The mass of the stars if they are all the same mass</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">//  PosType getStarMass() const {if(stars_implanted)return stars_xp[0].mass(); else return 0.0;}</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  </div>
<div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="class_lens_halo.html#ae4e6a8b770a38df28c9bee8799385923">  211</a></span>&#160;  <a class="code" href="_input_params_8h.html#abeeb8c8413457c56ac46767a52fc2618">EllipMethod</a> <a class="code" href="class_lens_halo.html#ae4e6a8b770a38df28c9bee8799385923">getEllipMethod</a>()<span class="keyword"> const </span>{<span class="keywordflow">return</span> main_ellip_method;}</div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="class_lens_halo.html#afbf395e2ec96c33289e7654732f05cf1">  213</a></span>&#160;  std::vector&lt;double&gt; <a class="code" href="class_lens_halo.html#afbf395e2ec96c33289e7654732f05cf1">get_mod</a>() { std::vector&lt;double&gt; fmodes(Nmod); <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;Nmod;i++){fmodes[i]= mod[i] ;}  ;<span class="keywordflow">return</span> fmodes;}</div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a37bed2edc60ce4932c7fc854fe972f01">  215</a></span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_lens_halo.html#a37bed2edc60ce4932c7fc854fe972f01">get_Nmod</a>() {<span class="keywordflow">return</span> Nmod;}</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; <span class="keyword">virtual</span> std::size_t <a class="code" href="class_lens_halo.html#a314019a0eac186c6fc7aca2e466ffd46">Nparams</a>() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; <span class="keyword">virtual</span> PosType <a class="code" href="class_lens_halo.html#a7c6257df5c75a20d7f306cc9f4980a52">getParam</a>(std::size_t p) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; <span class="keyword">virtual</span> PosType <a class="code" href="class_lens_halo.html#a53aa267154c7a5e2b60647be2d585bb9">setParam</a>(std::size_t p, PosType value);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#ab75f44fbd91c08d9f2bc03b5fe9d649a">printCSV</a>(std::ostream&amp;, <span class="keywordtype">bool</span> header = <span class="keyword">false</span>) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; <span class="comment">//void PrintStars(bool show_stars);</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  PosType <a class="code" href="class_lens_halo.html#a7184a202e39fac7cf8f7d0436abdc982">MassBy2DIntegation</a>(PosType R);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  PosType <a class="code" href="class_lens_halo.html#aeac398d7784e8a879eebeb2174349d61">MassBy1DIntegation</a>(PosType R);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  PosType <a class="code" href="class_lens_halo.html#accfed225ceb5c6684ac983ae89adfebd">test_average_gt</a>(PosType R);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  PosType test_average_kappa(PosType R);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  <span class="comment">// renomalize to make mass match</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordtype">void</span> set_norm_factor(){<a class="code" href="class_lens_halo.html#a43de5eba625d4c78e85e2fdb8bbeaa0e">mass_norm_factor</a>=1;<a class="code" href="class_lens_halo.html#a43de5eba625d4c78e85e2fdb8bbeaa0e">mass_norm_factor</a>=mass/<a class="code" href="class_lens_halo.html#aeac398d7784e8a879eebeb2174349d61">MassBy1DIntegation</a>(Rsize);}</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  </div>
<div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="class_lens_halo.html#ab67216d6042f33cd8d8482e6fceb8b39">  240</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#ab67216d6042f33cd8d8482e6fceb8b39">set_rsize</a>(<span class="keywordtype">float</span> my_rsize){ Rsize = my_rsize;};</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; <span class="keywordtype">float</span> get_rsize(){<span class="keywordflow">return</span> Rsize;};</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="comment">// all of the following functions were used for Ansatz III w derivatives of the Fourier modes</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="class_lens_halo.html#a9b357894d8d644741be0cec08e45bb30">test</a>();</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <span class="keywordtype">size_t</span> getID()<span class="keyword"> const </span>{<span class="keywordflow">return</span> idnumber;}</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="keywordtype">void</span> setID(<span class="keywordtype">size_t</span> <span class="keywordtype">id</span>){idnumber = id;}</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  PosType renormalization(PosType r_max);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <a class="code" href="class_pixel_map.html">PixelMap</a> <a class="code" href="class_lens_halo.html#a81b1a30f1fe716a34799469554693f6e">map_variables</a>(</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                         <a class="code" href="standard_8h.html#a73d5f5042d9b38366d0b3781d199f9e7">LensingVariable</a> lensvar </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                         ,<span class="keywordtype">size_t</span> Nx</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                         ,<span class="keywordtype">size_t</span> Ny</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                         ,<span class="keywordtype">double</span> res             </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  );</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="keywordtype">size_t</span> idnumber; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  PosType posHalo[2];</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  PosType zlens;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="comment">// This is the size of the halo beyond which it does not have the expected profile.</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordtype">float</span> Rsize = 0;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="comment">// total mass in Msun</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keywordtype">float</span> mass;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="comment">// angular size distance to this lens</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  PosType Dist;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  PosType mnorm;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">// Beyond Rmax the halo will be treated as a point mass.  Between Rsize and Rmax the deflection</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="comment">// and shear are interpolated.  For circularly symmetric lenses Rmax should be equal to Rsize</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keywordtype">float</span> Rmax;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  PosType <a class="code" href="class_lens_halo.html#a3e73f06df4d909f1bff909016cc839b2">alpha_int</a>(PosType x) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  PosType norm_int(PosType r_max);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a374d199861689b8186c04d29bf92d6a2">force_halo_sym</a>(PosType *alpha,KappaType *kappa,KappaType *gamma,KappaType *phi,PosType <span class="keyword">const</span> *xcm,<span class="keywordtype">bool</span> subtract_point=<span class="keyword">false</span>,PosType screening = 1.0);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a78cc531d36104d72bec891424aba9fcb">force_halo_asym</a>(PosType *alpha,KappaType *kappa,KappaType *gamma,KappaType *phi,PosType <span class="keyword">const</span> *xcm,<span class="keywordtype">bool</span> subtract_point=<span class="keyword">false</span>,PosType screening = 1.0);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordtype">bool</span> force_point(PosType *alpha,KappaType *kappa,KappaType *gamma</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                   ,KappaType *phi,PosType <span class="keyword">const</span> *xcm,PosType rcm2</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                   ,<span class="keywordtype">bool</span> subtract_point,PosType screening);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keyword">struct </span>norm_func{</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    norm_func(<a class="code" href="class_lens_halo.html">LensHalo</a>&amp; halo, PosType my_r_max): halo(halo), r_max(my_r_max){};</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <a class="code" href="class_lens_halo.html">LensHalo</a>&amp; halo;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    PosType r_max;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">//PosType operator ()(PosType theta) {halo.alpha_asym(r_max, theta, alpha_arr); return alpha_arr[0]*cos(theta)*cos(theta)+alpha_arr[1]*sin(theta)*sin(theta);}</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    PosType operator ()(PosType theta) {<span class="keywordflow">return</span> halo.alpha_ell(r_max, theta);}</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  };</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keyword">struct </span>Ialpha_func{</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    Ialpha_func(<a class="code" href="class_lens_halo.html">LensHalo</a>&amp; halo): halo(halo){};</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <a class="code" href="class_lens_halo.html">LensHalo</a>&amp; halo;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    PosType operator ()(PosType x) {<span class="keywordflow">return</span> halo.<a class="code" href="class_lens_halo.html#a9295b7b1d0a66b3742a81ead5bf2a863">alpha_h</a>(x)/x ;}</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  };</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keyword">struct </span>Ig_func{</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    Ig_func(<span class="keyword">const</span> <a class="code" href="class_lens_halo.html">LensHalo</a>&amp; halo): halo(halo){};</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keyword">const</span> <a class="code" href="class_lens_halo.html">LensHalo</a>&amp; halo;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    PosType operator ()(PosType x) {<span class="keywordflow">return</span> halo.gfunction(x)/x ;}</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  };</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">//  std::vector&lt;IndexType&gt; stars_index;</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">//  std::vector&lt;StarType&gt; stars_xp;</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">//  TreeQuadParticles&lt;StarType&gt; *star_tree;</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">//  int stars_N;</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">//  PosType star_massscale;</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">//  /// star masses relative to star_massscles</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">//  //float *star_masses;</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">//  PosType star_fstars;</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">//  PosType star_theta_force;</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">//  int star_Nregions;</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">//  std::vector&lt;PosType&gt; star_region;</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  PosType beta;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">//  void substract_stars_disks(PosType const *ray,PosType *alpha</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">//                             ,KappaType *kappa,KappaType *gamma);</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">//  std::vector&lt;float&gt; stellar_mass_function(IMFtype type, unsigned long Nstars, long *seed, PosType minmass=0.0, PosType maxmass=0.0</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">//                               ,PosType bendmass=0.0, PosType powerlo=0.0, PosType powerhi=0.0);</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a187b1e7e055d69419bf214ebf588af6d">assignParams</a>(<a class="code" href="class_input_params.html">InputParams</a>&amp; params,<span class="keywordtype">bool</span> needRsize);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="comment">//void assignParams_stars(InputParams&amp; params);</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a6a8cf22c76bab7821b1b0ee3b50ea75f">error_message1</a>(std::string name,std::string filename);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  </div>
<div class="line"><a name="l00353"></a><span class="lineno"><a class="line" href="class_lens_halo.html#abe2665d12192e49e464127dd3b78a96d">  353</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="class_lens_halo.html#abe2665d12192e49e464127dd3b78a96d">Rmax_to_Rsize_ratio</a> = 1.2;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  </div>
<div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="class_lens_halo.html#ad0138e93c3a165ae25cd42bea42c4c4b">  356</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="class_lens_halo.html#ad0138e93c3a165ae25cd42bea42c4c4b">rscale</a>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">// redshift</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="comment">//PosType zlens;</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  <a class="code" href="_input_params_8h.html#abeeb8c8413457c56ac46767a52fc2618">EllipMethod</a> main_ellip_method;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">//  bool stars_implanted;</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">//  /// Number of regions to be subtracted to compensate for the mass in stars</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">//  IMFtype main_stars_imf_type;</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">//  PosType main_stars_min_mass;</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">//  PosType main_stars_max_mass;</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">//  PosType bend_mstar;</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">//  PosType lo_mass_slope;</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">//  PosType hi_mass_slope;</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">//  /// parameters for stellar mass function: minimal and maximal stellar mass, bending point for a broken power law IMF</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">//  std::vector&lt;PosType&gt; star_Sigma;</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">//  std::vector&lt;Point_2d&gt; star_xdisk;</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  </div>
<div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a9295b7b1d0a66b3742a81ead5bf2a863">  377</a></span>&#160;  <span class="keyword">virtual</span> PosType <span class="keyword">inline</span> <a class="code" href="class_lens_halo.html#a9295b7b1d0a66b3742a81ead5bf2a863">alpha_h</a>(PosType x)<span class="keyword"> const </span>{<span class="keywordflow">return</span> -1;};</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keyword">virtual</span> KappaType <span class="keyword">inline</span> kappa_h(PosType x)<span class="keyword"> const </span>{<span class="keywordflow">return</span> 0;};</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keyword">virtual</span> KappaType <span class="keyword">inline</span> gamma_h(PosType x)<span class="keyword"> const </span>{<span class="keywordflow">return</span> -2;};</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keyword">virtual</span> KappaType <span class="keyword">inline</span> phi_h(PosType x)<span class="keyword"> const </span>{<span class="keywordflow">return</span> 1;};</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keyword">virtual</span> KappaType <span class="keyword">inline</span> phi_int(PosType x)<span class="keyword"> const </span>{<span class="keywordflow">return</span> 1;};</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  <span class="keyword">virtual</span> PosType <span class="keyword">inline</span> ffunction(PosType x)<span class="keyword">const </span>{<span class="keywordflow">return</span> 0;};</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <span class="keyword">virtual</span> PosType <span class="keyword">inline</span> gfunction(PosType x)<span class="keyword"> const </span>{<span class="keywordflow">return</span> -1;};</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keyword">virtual</span> PosType <span class="keyword">inline</span> dgfunctiondx(PosType x){<span class="keywordflow">return</span> 0;};</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="keyword">virtual</span> PosType <span class="keyword">inline</span> bfunction(PosType x){<span class="keywordflow">return</span> -1;};</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="keyword">virtual</span> PosType <span class="keyword">inline</span> dhfunction(PosType x)<span class="keyword"> const </span>{<span class="keywordflow">return</span> 1;};</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keyword">virtual</span> PosType <span class="keyword">inline</span> ddhfunction(PosType x, <span class="keywordtype">bool</span> numerical){<span class="keywordflow">return</span> 0;};</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keyword">virtual</span> PosType <span class="keyword">inline</span> dddhfunction(PosType x, <span class="keywordtype">bool</span> numerical){<span class="keywordflow">return</span> 0;};</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keyword">virtual</span> PosType <span class="keyword">inline</span> bnumfunction(PosType x){<span class="keywordflow">return</span> -1;};</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keyword">virtual</span> PosType <span class="keyword">inline</span> dbfunction(PosType x){<span class="keywordflow">return</span> 0;};</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keyword">virtual</span> PosType <span class="keyword">inline</span> ddbfunction(PosType x){<span class="keywordflow">return</span> 0;};</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keyword">virtual</span> PosType <span class="keyword">inline</span> dmoddb(<span class="keywordtype">int</span> whichmod, PosType q, PosType b){<span class="keywordflow">return</span> 0;};</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <span class="keyword">virtual</span> PosType <span class="keyword">inline</span> ddmoddb(<span class="keywordtype">int</span> whichmod, PosType q, PosType b){<span class="keywordflow">return</span> 0;};</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <span class="keyword">virtual</span> PosType <span class="keyword">inline</span> dmoddq(<span class="keywordtype">int</span> whichmod, PosType q, PosType b){<span class="keywordflow">return</span> 0;};</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keyword">virtual</span> PosType <span class="keyword">inline</span> ddmoddq(<span class="keywordtype">int</span> whichmod, PosType q, PosType b){<span class="keywordflow">return</span> 0;};</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  PosType xmax;  </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  </div>
<div class="line"><a name="l00399"></a><span class="lineno"><a class="line" href="class_lens_halo.html#a43de5eba625d4c78e85e2fdb8bbeaa0e">  399</a></span>&#160;  PosType <a class="code" href="class_lens_halo.html#a43de5eba625d4c78e85e2fdb8bbeaa0e">mass_norm_factor</a>=1;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="comment">// Functions for calculating axial dependence</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordtype">float</span> pa;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordtype">float</span> fratio=1.0;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordtype">bool</span> elliptical_flag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordtype">bool</span> switch_flag = <span class="keyword">false</span>; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a825833ac8df009db76b5e4b4b4e140f9">faxial</a>(PosType x,PosType theta,PosType f[]);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <span class="keywordtype">void</span> faxial0(PosType theta,PosType f0[]);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <span class="keywordtype">void</span> faxial1(PosType theta,PosType f1[]);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordtype">void</span> faxial2(PosType theta,PosType f2[]);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#aea13e7ff3d95622bbb38fffd672045fa">gradial</a>(PosType r,PosType g[]);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <span class="keywordtype">void</span> gradial2(PosType r,PosType mu, PosType sigma,PosType g[]);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a70d44bd2ef4edee5fb918a61cf5d3fcf">felliptical</a>(PosType x, PosType q, PosType theta, PosType f[], PosType g[]);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> gamma_asym(PosType x,PosType theta, PosType gamma[]);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="keyword">virtual</span> PosType <a class="code" href="class_lens_halo.html#ac3f16aeffae590925d115799698ebaf4">kappa_asym</a>(PosType x,PosType theta);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a7e68cb08c90a52d21f6af474acfc20e2">alphakappagamma_asym</a>(PosType x,PosType theta, PosType alpha[]</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                                    ,PosType *kappa,PosType gamma[],PosType *phi);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#ab90367cd516c00c93e8608894732e965">alphakappagamma1asym</a>(PosType x,PosType theta, PosType alpha[2]</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                    ,PosType *kappa,PosType gamma[],PosType *phi);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> alphakappagamma2asym(PosType x,PosType theta, PosType alpha[2]</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                    ,PosType *kappa,PosType gamma[],PosType *phi);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">void</span> alphakappagamma3asym(PosType x,PosType theta, PosType alpha[2]</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                                    ,PosType *kappa,PosType gamma[],PosType *phi);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keyword">virtual</span> PosType alpha_ell(PosType x,PosType theta);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="class_lens_halo.html#aea2b2ded8c4b6a3b65df46c1fc265b97">fourier_coeff</a>(<span class="keywordtype">double</span> n, <span class="keywordtype">double</span> q, <span class="keywordtype">double</span> beta);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keywordtype">double</span> IDAXDM(<span class="keywordtype">double</span> lambda, <span class="keywordtype">double</span> a2, <span class="keywordtype">double</span> b2, <span class="keywordtype">double</span> x[], <span class="keywordtype">double</span> rmax, <span class="keywordtype">double</span> mo);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;  <span class="keywordtype">double</span> IDAYDM(<span class="keywordtype">double</span> lambda, <span class="keywordtype">double</span> a2, <span class="keywordtype">double</span> b2, <span class="keywordtype">double</span> x[], <span class="keywordtype">double</span> rmax, <span class="keywordtype">double</span> mo);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <span class="keywordtype">double</span> SCHRAMMKN(<span class="keywordtype">double</span> n, <span class="keywordtype">double</span> x[], <span class="keywordtype">double</span> rmax);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <span class="keywordtype">double</span> SCHRAMMJN(<span class="keywordtype">double</span> n, <span class="keywordtype">double</span> x[], <span class="keywordtype">double</span> rmax);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <span class="keywordtype">double</span> SCHRAMMI(<span class="keywordtype">double</span> x[], <span class="keywordtype">double</span> rmax);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a429dcab3579fa5291bf82f0484c0a480">calcModes</a>(<span class="keywordtype">double</span> q, <span class="keywordtype">double</span> beta, <span class="keywordtype">double</span> rottheta, PosType newmod[]);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  <span class="keywordtype">void</span> calcModesB(PosType x, <span class="keywordtype">double</span> q, <span class="keywordtype">double</span> beta, <span class="keywordtype">double</span> rottheta, PosType newmod[]);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  <span class="keywordtype">void</span> calcModesC(PosType beta_r, <span class="keywordtype">double</span> q, <span class="keywordtype">double</span> rottheta, PosType newmod[]);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <span class="keyword">virtual</span> PosType <span class="keyword">inline</span> InterpolateModes(<span class="keywordtype">int</span> whichmod, PosType q, PosType b){<span class="keywordflow">return</span> 0;};</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#affb1ead96e81d87f61d45e09a6f6fb3f">analModes</a>(<span class="keywordtype">int</span> modnumber, PosType my_beta, PosType q, PosType amod[3]);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keyword">struct </span>fourier_func{</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    fourier_func(<span class="keywordtype">double</span> my_n, <span class="keywordtype">double</span> my_q, <span class="keywordtype">double</span> my_beta): n(my_n),q(my_q),beta(my_beta){};</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordtype">double</span> n;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordtype">double</span> q;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordtype">double</span> beta;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordtype">double</span> operator ()(<span class="keywordtype">double</span> theta) {<span class="keywordflow">return</span> cos(n*theta)/pow(cos(theta)*cos(theta) + 1/q/q*sin(theta)*sin(theta),beta/2) ;}</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  };</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="keyword">struct </span>SCHRAMMJ_func{</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    SCHRAMMJ_func(<span class="keywordtype">double</span> my_n, <span class="keywordtype">double</span> my_x[], <span class="keywordtype">double</span> my_rmax, <a class="code" href="class_lens_halo.html">LensHalo</a> *my_halo): n(my_n), x(my_x), rmx(my_rmax), halo(my_halo){};</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordtype">double</span> n, *x, rmx;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordtype">double</span> operator ()(<span class="keywordtype">double</span> u) {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="comment">// PosType xisq=sqrt(u*(x[0]*x[0]+x[1]*x[1]/(1-(1-halo-&gt;fratio*halo-&gt;fratio)*u)));</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      PosType xisq=sqrt((x[0]*x[0]+x[1]*x[1]/(1-u*(1-halo-&gt;fratio*halo-&gt;fratio))));</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordflow">if</span>(xisq*xisq &lt; 1e-20) xisq = 1.0e-10;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      KappaType kappa=halo-&gt;kappa_h(xisq)/PI/xisq/xisq;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="comment">//std::cout &lt;&lt; &quot;Schramm: n=&quot; &lt;&lt; n &lt;&lt; &quot; &quot; &lt;&lt; u &lt;&lt; &quot; &quot; &lt;&lt; xisq &lt;&lt; &quot; &quot; &lt;&lt; halo-&gt;fratio &lt;&lt; &quot; &quot; &lt;&lt; rmx &lt;&lt; &quot; &quot; &lt;&lt; halo-&gt;Rmax &lt;&lt; &quot; &quot; &lt;&lt; halo-&gt;rscale &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="keywordflow">return</span> kappa*halo-&gt;mass/pow((1.-(1.-halo-&gt;fratio*halo-&gt;fratio)*u),n+0.5);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <a class="code" href="class_lens_halo.html">LensHalo</a> *halo;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  };</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keyword">struct </span>SCHRAMMK_func{</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    SCHRAMMK_func(<span class="keywordtype">double</span> my_n, <span class="keywordtype">double</span> my_x[], <span class="keywordtype">double</span> my_rmax, <a class="code" href="class_lens_halo.html">LensHalo</a> *my_halo): n(my_n), x(my_x), rmx(my_rmax), halo(my_halo){};</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordtype">double</span> n, *x, rmx;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordtype">double</span> operator ()(<span class="keywordtype">double</span> u) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;     <span class="comment">// PosType xisq=sqrt(u*(x[0]*x[0]+x[1]*x[1]/(1-(1-halo-&gt;fratio*halo-&gt;fratio)*u)));</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      PosType xisq=sqrt((x[0]*x[0]+x[1]*x[1]/(1-u*(1-halo-&gt;fratio*halo-&gt;fratio))));</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="keywordflow">if</span>(xisq*xisq &lt; 1e-20) xisq = 1.0e-10;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      PosType h=0.0001;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      PosType kp1=halo-&gt;kappa_h(xisq+h)/((xisq+h)*(xisq+h));</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      PosType km1=halo-&gt;kappa_h(xisq-h)/((xisq-h)*(xisq-h));</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      PosType kp2=halo-&gt;kappa_h(xisq+2*h)/((xisq+2*h)*(xisq+2*h));</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      PosType km2=halo-&gt;kappa_h(xisq-2*h)/((xisq-2*h)*(xisq-2*h));</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      PosType dkdxi=(8*kp1-8*km1-kp2+km2)/12/h/PI;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160; </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="comment">//std::cout &lt;&lt; &quot;Schramm: n=&quot; &lt;&lt; n &lt;&lt; &quot; &quot; &lt;&lt; u &lt;&lt; &quot; &quot; &lt;&lt; xisq &lt;&lt; &quot; &quot; &lt;&lt; halo-&gt;fratio &lt;&lt; &quot; &quot; &lt;&lt; rmx &lt;&lt; &quot; &quot; &lt;&lt; halo-&gt;Rmax &lt;&lt; &quot; &quot; &lt;&lt; halo-&gt;rscale &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="keywordflow">return</span> u*dkdxi/pow((1.-(1.-halo-&gt;fratio*halo-&gt;fratio)*u),n+0.5);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <a class="code" href="class_lens_halo.html">LensHalo</a> *halo;</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    };</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  </div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="keyword">struct </span>SCHRAMMI_func{</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    SCHRAMMI_func(<span class="keywordtype">double</span> my_x[], <span class="keywordtype">double</span> my_rmax, <a class="code" href="class_lens_halo.html">LensHalo</a> *my_halo): x(my_x), rmx(my_rmax), halo(my_halo){};</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordtype">double</span> *x, rmx;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordtype">double</span> operator ()(<span class="keywordtype">double</span> u) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <span class="comment">// PosType xisq=sqrt(u*(x[0]*x[0]+x[1]*x[1]/(1-(1-halo-&gt;fratio*halo-&gt;fratio)*u)));</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      PosType xisq=sqrt((x[0]*x[0]+x[1]*x[1]/(1-u*(1-halo-&gt;fratio*halo-&gt;fratio))));</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keywordflow">if</span>(xisq*xisq &lt; 1e-20) xisq = 1.0e-10;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      PosType alpha=halo-&gt;<a class="code" href="class_lens_halo.html#a9295b7b1d0a66b3742a81ead5bf2a863">alpha_h</a>(xisq)/PI/xisq;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="comment">//std::cout &lt;&lt; &quot;Schramm: n=&quot; &lt;&lt; n &lt;&lt; &quot; &quot; &lt;&lt; u &lt;&lt; &quot; &quot; &lt;&lt; xisq &lt;&lt; &quot; &quot; &lt;&lt; halo-&gt;fratio &lt;&lt; &quot; &quot; &lt;&lt; rmx &lt;&lt; &quot; &quot; &lt;&lt; halo-&gt;Rmax &lt;&lt; &quot; &quot; &lt;&lt; halo-&gt;rscale &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="keywordflow">return</span> xisq*alpha*halo-&gt;mass/pow((1.-(1.-halo-&gt;fratio*halo-&gt;fratio)*u),0.5);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <a class="code" href="class_lens_halo.html">LensHalo</a> *halo;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  };</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="keyword">struct </span>IDAXDM_func{</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    IDAXDM_func(<span class="keywordtype">double</span> my_lambda,<span class="keywordtype">double</span> my_a2, <span class="keywordtype">double</span> my_b2, <span class="keywordtype">double</span> my_x[], <span class="keywordtype">double</span> my_rmax, <a class="code" href="class_lens_halo.html">LensHalo</a> *my_halo): lambda(my_lambda), a2(my_a2), b2(my_b2), x(my_x), rmx(my_rmax), halo(my_halo){};</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordtype">double</span> lambda, a2,b2, *x, rmx;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordtype">double</span> operator ()(<span class="keywordtype">double</span> m) {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      <span class="keywordtype">double</span> ap = m*m*a2 + lambda,bp = m*m*b2 + lambda;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      <span class="keywordtype">double</span> p2 = x[0]*x[0]/ap/ap/ap/ap + x[1]*x[1]/bp/bp/bp/bp;  <span class="comment">// actually the inverse of equation (5) in Schramm 1990</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      PosType tmp = m*rmx;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;      <span class="keywordflow">if</span>(tmp*tmp &lt; 1e-20) tmp = 1.0e-10;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      PosType xiso=tmp/halo-&gt;<a class="code" href="class_lens_halo.html#ad0138e93c3a165ae25cd42bea42c4c4b">rscale</a>;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      KappaType kappa=halo-&gt;kappa_h(xiso)/PI/xiso/xiso;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      PosType alpha[2]={0,0},tm[2] = {m*rmx,0};</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      KappaType kappam=0,gamma[2]={0,0},phi=0;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      halo-&gt;<a class="code" href="class_lens_halo.html#a374d199861689b8186c04d29bf92d6a2">force_halo_sym</a>(alpha,&amp;kappam,gamma,&amp;phi,tm);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <span class="comment">//std::cout &lt;&lt; &quot;output x: &quot; &lt;&lt; m &lt;&lt; &quot; &quot; &lt;&lt; xiso &lt;&lt; &quot; &quot; &lt;&lt; m*kappa/(ap*ap*ap*bp*p2)*halo-&gt;mass &lt;&lt; &quot; &quot; &lt;&lt; m*kappam/(ap*ap*ap*bp*p2)&lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="keywordtype">double</span> integrandA=m*kappa/(ap*ap*ap*bp*p2)*halo-&gt;mass;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="keywordtype">double</span> integrandB=m*kappam/(ap*ap*ap*bp*p2);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="comment">//std::cout &lt;&lt; integrandA-integrandB &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      assert( std::abs((integrandA - integrandB)/integrandA)&lt;1E-5);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      assert(kappa &gt;= 0.0);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="comment">//return m*kappa/(ap*ap*ap*bp*p2)*halo-&gt;mass; // integrand of equation (28) in Schramm 1990</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="keywordflow">return</span> integrandB;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <a class="code" href="class_lens_halo.html">LensHalo</a> *halo;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  };</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <span class="keyword">struct </span>IDAYDM_func{</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    IDAYDM_func(<span class="keywordtype">double</span> my_lambda,<span class="keywordtype">double</span> my_a2, <span class="keywordtype">double</span> my_b2, <span class="keywordtype">double</span> my_x[], <span class="keywordtype">double</span> my_rmax, <a class="code" href="class_lens_halo.html">LensHalo</a> *my_halo): lambda(my_lambda), a2(my_a2), b2(my_b2), x(my_x), rmx(my_rmax), halo(my_halo){};</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordtype">double</span> lambda, a2,b2, *x, rmx;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordtype">double</span> operator ()(<span class="keywordtype">double</span> m) {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="keywordtype">double</span> ap = m*m*a2 + lambda,bp = m*m*b2 + lambda;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <span class="keywordtype">double</span> p2 = x[0]*x[0]/ap/ap/ap/ap + x[1]*x[1]/bp/bp/bp/bp;  <span class="comment">// actually the inverse of equation (5) in Schramm 1990</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      PosType tmp = m*rmx;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="keywordflow">if</span>(tmp*tmp &lt; 1e-20) tmp = 1.0e-10;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      PosType xiso=tmp/halo-&gt;<a class="code" href="class_lens_halo.html#ad0138e93c3a165ae25cd42bea42c4c4b">rscale</a>;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      KappaType kappa=halo-&gt;kappa_h(xiso)/PI/xiso/xiso;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      PosType alpha[2]={0,0},tm[2] = {m*rmx,0};</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      KappaType kappam=0,gamma[2]={0,0},phi=0;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      halo-&gt;<a class="code" href="class_lens_halo.html#a374d199861689b8186c04d29bf92d6a2">force_halo_sym</a>(alpha,&amp;kappam,gamma,&amp;phi,tm);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="keywordtype">double</span> integrandA=m*kappa/(ap*ap*ap*bp*p2)*halo-&gt;mass;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="keywordtype">double</span> integrandB=m*kappam/(ap*bp*bp*bp*p2);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      assert( std::abs((integrandA - integrandB)/integrandA)&lt;1E-5);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      assert(kappa &gt;= 0.0);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <span class="comment">//return m*kappa/(ap*bp*bp*bp*p2)*halo-&gt;mass; // integrand of equation (28) in Schramm 1990</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="keywordflow">return</span> integrandB;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <a class="code" href="class_lens_halo.html">LensHalo</a> *halo;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  };</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="keyword">const</span> <span class="keyword">static</span> <span class="keywordtype">int</span> Nmod = 32;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="comment">// Analytic description of Fourier modes</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  PosType mod[Nmod];</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  PosType mod1[Nmod];</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  PosType mod2[Nmod];</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  PosType r_eps;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <span class="comment">// These are stucts used in doing tests</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="comment">/*struct test_gt_func{</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">    test_gt_func(LensHalo&amp; halo,PosType my_r): halo(halo),r(my_r){};</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">    LensHalo&amp; halo;</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">    PosType r;</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">    PosType a[2] = {0,0},x[2] = {0,0};</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">    KappaType k = 0,g[3] = {0,0,0} ,p=0;</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">    //double operator ()(PosType t) {x[0]=r*cos(t); x[1]=r*sin(t);  halo.force_halo(a,&amp;k,g,&amp;p,x); if(r&gt;1){std::cout &lt;&lt; r &lt;&lt; &quot; &quot; &lt;&lt; g[0]*cos(2*t)+g[1]*sin(2*t) &lt;&lt; std::endl;} return (g[0]*cos(2*t)+g[1]*sin(2*t));}</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">    double operator ()(PosType t) {x[0]=r*cos(t); x[1]=r*sin(t);  halo.force_halo(a,&amp;k,g,&amp;p,x); return (g[0]*cos(2*t)+g[1]*sin(2*t));}</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">    </span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">  };*/</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keyword">struct </span>test_gt_func{</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    test_gt_func(PosType my_r,<a class="code" href="class_lens_halo.html">LensHalo</a> *halo): r(my_r),halo(halo){};</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <span class="keywordtype">double</span> operator ()(PosType t) {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      PosType alpha[2] = {0,0},x[2] = {0,0};</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      KappaType kappa = 0,gamma[3] = {0,0,0},phi =0 ;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      x[0]=r*cos(t);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      x[1]=r*sin(t);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      halo-&gt;<a class="code" href="class_lens_halo.html#a460de105e52520a328d5912455c02fdd">force_halo</a>(alpha,&amp;kappa,gamma,&amp;phi,x);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      assert(gamma[0]==gamma[0]);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      assert(gamma[1]==gamma[1]);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;       <span class="keywordflow">return</span> (gamma[0]*cos(2*t)+gamma[1]*sin(2*t));}</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="comment">//double operator ()(PosType t) {x[0]=r*cos(t); x[1]=r*sin(t);  halo.force_halo(a,&amp;k,g,&amp;p,x); if(r&gt;1){std::cout &lt;&lt; r &lt;&lt; &quot; &quot; &lt;&lt; g[0]*cos(2*t)+g[1]*sin(2*t) &lt;&lt; std::endl;} return (g[0]*cos(2*t)+g[1]*sin(2*t));}</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    PosType r;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <a class="code" href="class_lens_halo.html">LensHalo</a> *halo;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  };</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; <span class="comment">/* struct test_kappa_func{</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">    test_kappa_func(LensHalo&amp; halo,PosType my_r): halo(halo),r(my_r){};</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">    LensHalo&amp; halo;</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">    PosType r;</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">    PosType a[2] = {0,0},x[2] = {0,0};</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">    KappaType k = 0,g[3] = {0,0,0} ,p=0;</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">    double operator ()(PosType t) {x[0]=r*cos(t); x[1]=r*sin(t);  halo.force_halo(a,&amp;k,g,&amp;p,x);return 2*PI*k*r*r; }</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">  };</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keyword">struct </span>test_kappa_func{</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    test_kappa_func(PosType my_r,<a class="code" href="class_lens_halo.html">LensHalo</a> *halo): r(my_r),halo(halo){};</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordtype">double</span> operator ()(PosType t) {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      PosType alpha[2] = {0,0},x[2] = {0,0};</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      KappaType kappa = 0,gamma[3] = {0,0,0},phi =0 ;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      x[0]=r*cos(t);</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      x[1]=r*sin(t);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;      halo-&gt;<a class="code" href="class_lens_halo.html#a460de105e52520a328d5912455c02fdd">force_halo</a>(alpha,&amp;kappa,gamma,&amp;phi,x);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      assert(kappa==kappa);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <span class="keywordflow">return</span> kappa; }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    PosType r;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <a class="code" href="class_lens_halo.html">LensHalo</a> *halo;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  };</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="keyword">struct </span>DMDTHETA{</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    DMDTHETA(PosType R,<a class="code" href="class_lens_halo.html">LensHalo</a> *halo): R(R),halo(halo){};</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    PosType operator()(PosType theta){</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      PosType alpha[2] = {0,0},x[2] = {0,0};</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      KappaType kappa = 0,gamma[3] = {0,0,0},phi =0 ;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      x[0] = R*cos(theta);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      x[1] = R*sin(theta);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      halo-&gt;<a class="code" href="class_lens_halo.html#a460de105e52520a328d5912455c02fdd">force_halo</a>(alpha,&amp;kappa,gamma,&amp;phi,x);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      PosType alpha_r = -alpha[0]*cos(theta) - alpha[1]*sin(theta);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <span class="comment">//std::cout &lt;&lt; alpha[0] &lt;&lt; &quot;  &quot; &lt;&lt; alpha[1] &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      assert( alpha_r == alpha_r );</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="comment">//std::cout &lt;&lt; theta &lt;&lt; &quot;  &quot; &lt;&lt; alpha_r &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      <span class="keywordflow">return</span> alpha_r;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    PosType R;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <a class="code" href="class_lens_halo.html">LensHalo</a> *halo;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  };</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  <span class="keyword">struct </span>DMDRDTHETA{</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    DMDRDTHETA(PosType R,<a class="code" href="class_lens_halo.html">LensHalo</a> *halo): R(R),halo(halo){};</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    PosType operator()(PosType theta){</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      PosType alpha[2] = {0,0},x[2] = {0,0};</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;      KappaType kappa = 0,gamma[3] = {0,0,0} ,phi=0;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      x[0] = R*cos(theta);</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      x[1] = R*sin(theta);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      halo-&gt;<a class="code" href="class_lens_halo.html#a460de105e52520a328d5912455c02fdd">force_halo</a>(alpha,&amp;kappa,gamma,&amp;phi,x);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      assert(kappa == kappa);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      assert(kappa != INFINITY);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      <span class="keywordflow">return</span> kappa;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    PosType R;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <a class="code" href="class_lens_halo.html">LensHalo</a> *halo;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  };</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keyword">struct </span>DMDR{</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    DMDR(<a class="code" href="class_lens_halo.html">LensHalo</a> *halo): halo(halo){};</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    PosType operator()(PosType logR){</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;       <span class="comment">//if(halo-&gt;get_flag_elliptical()){</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        LensHalo::DMDRDTHETA dmdrdtheta(exp(logR),halo);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="comment">//std::cout &lt;&lt; &quot; R = &quot; &lt;&lt; exp(logR) &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="keywordflow">if</span>(exp(2*logR) == 0.0) <span class="keywordflow">return</span> 0.0;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;         <span class="keywordflow">return</span> Utilities::nintegrate&lt;LensHalo::DMDRDTHETA,PosType&gt;(dmdrdtheta,0,2*PI,1.0e-7)</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;         *exp(2*logR);</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">//      }else{</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">//        PosType alpha[2] = {0,0},x[2] = {0,0};</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">//        KappaType kappa = 0,gamma[3] = {0,0,0} ,phi=0;</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">//        x[0] = exp(logR);</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">//        x[1] = 0;</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment">//        halo-&gt;force_halo(alpha,&amp;kappa,gamma,&amp;phi,x);</span></div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment">//        return 2*PI*kappa*exp(2*logR);</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">//      }</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <a class="code" href="class_lens_halo.html">LensHalo</a> *halo;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;  };</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  <span class="keyword">struct </span>DALPHAXDM{</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    DALPHAXDM(PosType lambda,PosType a2,PosType b2,PosType X[],<a class="code" href="class_lens_halo.html">LensHalo</a>* myisohalo)</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    :lambda(lambda),a2(a2),b2(b2),x(X),isohalo(myisohalo){};</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    PosType operator()(PosType m);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    PosType lambda;</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    PosType a2;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    PosType b2;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    PosType *x;</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <a class="code" href="class_lens_halo.html">LensHalo</a>* isohalo;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  };</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <span class="keyword">struct </span>DALPHAYDM{</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    DALPHAYDM(PosType lambda,PosType a2,PosType b2,PosType X[],<a class="code" href="class_lens_halo.html">LensHalo</a>* isohalo)</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    :lambda(lambda),a2(a2),b2(b2),x(X),isohalo(isohalo){};</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    PosType operator()(PosType m);</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    PosType lambda;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    PosType a2;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    PosType b2;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    PosType *x;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <a class="code" href="class_lens_halo.html">LensHalo</a>* isohalo;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  };</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;};</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00745"></a><span class="lineno"><a class="line" href="class_lens_halo_n_f_w.html">  745</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_lens_halo_n_f_w.html">LensHaloNFW</a>: <span class="keyword">public</span> <a class="code" href="class_lens_halo.html">LensHalo</a>{</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; <a class="code" href="class_lens_halo_n_f_w.html#a9c8f2ee5db692fb17dc4a2bda2c06b04">LensHaloNFW</a>();</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <a class="code" href="class_lens_halo_n_f_w.html#a9c8f2ee5db692fb17dc4a2bda2c06b04">LensHaloNFW</a>(<span class="keywordtype">float</span> my_mass   </div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;              ,<span class="keywordtype">float</span> my_Rsize  </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;              ,PosType my_zlens   </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;              ,<span class="keywordtype">float</span> my_concentration</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;              ,<span class="keywordtype">float</span> my_fratio    </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;              ,<span class="keywordtype">float</span> my_pa        </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;              ,<span class="keyword">const</span> COSMOLOGY &amp;cosmo</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;              ,<a class="code" href="_input_params_8h.html#abeeb8c8413457c56ac46767a52fc2618">EllipMethod</a> my_ellip_method=EllipMethod::Pseudo</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;              );</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <a class="code" href="class_lens_halo_n_f_w.html#a9c8f2ee5db692fb17dc4a2bda2c06b04">LensHaloNFW</a>(<span class="keyword">const</span> <a class="code" href="class_lens_halo_n_f_w.html">LensHaloNFW</a> &amp;h):<a class="code" href="class_lens_halo.html#a813618bcd6d1f26dafa49a2e509a37db">LensHalo</a>(h){</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    ++<a class="code" href="class_lens_halo_n_f_w.html#af8e6d1a537c488ed2cabfb9bb6feaa80">LensHaloNFW::count</a>;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    gmax = h.gmax;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  }</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;  <a class="code" href="class_lens_halo_n_f_w.html#a9c8f2ee5db692fb17dc4a2bda2c06b04">LensHaloNFW</a>(<span class="keyword">const</span> <a class="code" href="class_lens_halo_n_f_w.html">LensHaloNFW</a> &amp;&amp;h):<a class="code" href="class_lens_halo.html#a813618bcd6d1f26dafa49a2e509a37db">LensHalo</a>(std::move(h)){</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    ++<a class="code" href="class_lens_halo_n_f_w.html#af8e6d1a537c488ed2cabfb9bb6feaa80">LensHaloNFW::count</a>;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    gmax = h.gmax;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  }</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160; </div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  <a class="code" href="class_lens_halo_n_f_w.html">LensHaloNFW</a> &amp; operator=(<span class="keyword">const</span> <a class="code" href="class_lens_halo_n_f_w.html">LensHaloNFW</a> &amp;h){</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">this</span> != &amp;h){</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      <a class="code" href="class_lens_halo.html#aaa135c7e56a24de4a1dee76604a44141">LensHalo::operator=</a>(h);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      gmax = h.gmax;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  <a class="code" href="class_lens_halo_n_f_w.html">LensHaloNFW</a> &amp; operator=(<span class="keyword">const</span> <a class="code" href="class_lens_halo_n_f_w.html">LensHaloNFW</a> &amp;&amp;h){</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keywordflow">if</span>(<span class="keyword">this</span> != &amp;h){</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      <a class="code" href="class_lens_halo.html#aaa135c7e56a24de4a1dee76604a44141">LensHalo::operator=</a>(std::move(h));</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      gmax = h.gmax;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;  }</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; <span class="keyword">virtual</span> ~<a class="code" href="class_lens_halo_n_f_w.html">LensHaloNFW</a>();</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; PosType ffunction(PosType x) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; PosType gfunction(PosType x) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  PosType dgfunctiondx(PosType x);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; PosType g2function(PosType x) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160; PosType hfunction(PosType x) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  PosType dhfunction(PosType x) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  PosType ddhfunction(PosType x, <span class="keywordtype">bool</span> numerical);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  PosType dddhfunction(PosType x, <span class="keywordtype">bool</span> numerical);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  PosType bfunction(PosType x);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  PosType dbfunction(PosType x);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  PosType ddbfunction(PosType x);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  PosType <a class="code" href="class_lens_halo_n_f_w.html#ad38e1cd1d96550571ec6c5ff104c4ba0">dmoddb</a>(<span class="keywordtype">int</span> whichmod, PosType q, PosType b);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  PosType ddmoddb(<span class="keywordtype">int</span> whichmod, PosType q, PosType b);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  PosType dmoddq(<span class="keywordtype">int</span> whichmod, PosType q, PosType b);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  PosType ddmoddq(<span class="keywordtype">int</span> whichmod, PosType q, PosType b);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="comment">//PosType dmod(PosType x, int modnumber, PosType my_slope, PosType my_fratio);    // was used for Ansatz III w derivatives of the Fourier modes</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="comment">//PosType ddmod(PosType x, int modnumber, PosType my_slope, PosType my_fratio);   // was used for Ansatz III w derivatives of the Fourier modes</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; <span class="comment">// TODO: BEN: the below functions alphaNFW, kappaNFW and gammaNFW are obsolete and better to be deleted to avoid confusion</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_n_f_w.html#afa273b32b7c0159776310f9a6b412df6">alphaNFW</a>(PosType *alpha,PosType *x,PosType Rtrunc,PosType mass,PosType r_scale</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                ,PosType *center,PosType Sigma_crit);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; KappaType <a class="code" href="class_lens_halo_n_f_w.html#a9319e4578436ec403e936df7dfded030">kappaNFW</a>(PosType *x,PosType Rtrunc,PosType mass,PosType r_scale</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                     ,PosType *center,PosType Sigma_crit);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_n_f_w.html#a222a1a0ced3498ba1b8cb4ee53e294f5">gammaNFW</a>(KappaType *gamma,PosType *x,PosType Rtrunc,PosType mass,PosType r_scale</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                ,PosType *center,PosType Sigma_crit);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_n_f_w.html#a1e862a84007d11cb5d66fccc2b7c9daa">initFromFile</a>(<span class="keywordtype">float</span> my_mass, <span class="keywordtype">long</span> *seed, <span class="keywordtype">float</span> vmax, <span class="keywordtype">float</span> r_halfmass);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_n_f_w.html#a228966c2dd97f08cb94b7541880d6d3d">initFromMassFunc</a>(<span class="keywordtype">float</span> my_mass, <span class="keywordtype">float</span> my_Rsize, <span class="keywordtype">float</span> my_rscale, PosType my_slope, <span class="keywordtype">long</span> *seed);</div>
<div class="line"><a name="l00816"></a><span class="lineno"><a class="line" href="class_lens_halo_n_f_w.html#a22c52ff3881b5054f5a52bd00ada6c18">  816</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_n_f_w.html#a22c52ff3881b5054f5a52bd00ada6c18">set_RsizeXmax</a>(<span class="keywordtype">float</span> my_Rsize){LensHalo::setRsize(my_Rsize); xmax = <a class="code" href="class_lens_halo.html#a2616defcc052fd9ab1e568cfd8a5c9a9">LensHalo::getRsize</a>()/<a class="code" href="class_lens_halo.html#ad0138e93c3a165ae25cd42bea42c4c4b">rscale</a>; gmax = <a class="code" href="class_lens_halo_n_f_w.html#a9f48edfd8a1cbc024b8e51ca879aab36">InterpolateFromTable</a>(gtable,xmax);};</div>
<div class="line"><a name="l00819"></a><span class="lineno"><a class="line" href="class_lens_halo_n_f_w.html#a9510ff2b41fecc0555a48b360304e04c">  819</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_n_f_w.html#a9510ff2b41fecc0555a48b360304e04c">set_rscaleXmax</a>(<span class="keywordtype">float</span> my_rscale){<a class="code" href="class_lens_halo.html#ad0138e93c3a165ae25cd42bea42c4c4b">rscale</a>=my_rscale; xmax = <a class="code" href="class_lens_halo.html#a2616defcc052fd9ab1e568cfd8a5c9a9">LensHalo::getRsize</a>()/<a class="code" href="class_lens_halo.html#ad0138e93c3a165ae25cd42bea42c4c4b">rscale</a>; gmax = <a class="code" href="class_lens_halo_n_f_w.html#a9f48edfd8a1cbc024b8e51ca879aab36">InterpolateFromTable</a>(gtable,xmax);};</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;  </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l00823"></a><span class="lineno"><a class="line" href="class_lens_halo_n_f_w.html#aaf3791f1b4431e07500151c68a613ac1">  823</a></span>&#160; <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">long</span> <a class="code" href="class_lens_halo_n_f_w.html#aaf3791f1b4431e07500151c68a613ac1">NTABLE</a>;</div>
<div class="line"><a name="l00825"></a><span class="lineno"><a class="line" href="class_lens_halo_n_f_w.html#a87747a7b1ca624f4fb8630e59f69dea7">  825</a></span>&#160; <span class="keyword">static</span> <span class="keyword">const</span> PosType <a class="code" href="class_lens_halo_n_f_w.html#a87747a7b1ca624f4fb8630e59f69dea7">maxrm</a>;</div>
<div class="line"><a name="l00827"></a><span class="lineno"><a class="line" href="class_lens_halo_n_f_w.html#af8e6d1a537c488ed2cabfb9bb6feaa80">  827</a></span>&#160; <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="class_lens_halo_n_f_w.html#af8e6d1a537c488ed2cabfb9bb6feaa80">count</a>;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  </div>
<div class="line"><a name="l00830"></a><span class="lineno"><a class="line" href="class_lens_halo_n_f_w.html#ad69ef65ce813a404b34a0fe20a6cf9cd">  830</a></span>&#160; <span class="keyword">static</span> PosType *<a class="code" href="class_lens_halo_n_f_w.html#ad69ef65ce813a404b34a0fe20a6cf9cd">ftable</a>,*gtable,*g2table,*htable,*xtable,*xgtable,***modtable; <span class="comment">// modtable was used for Ansatz IV and worked well</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_n_f_w.html#aec09e889c8b03d29b5d0be6c0711f274">make_tables</a>();</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; PosType <a class="code" href="class_lens_halo_n_f_w.html#a9f48edfd8a1cbc024b8e51ca879aab36">InterpolateFromTable</a>(PosType *table, PosType y) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  PosType InterpolateModes(<span class="keywordtype">int</span> whichmod, PosType q, PosType b);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_n_f_w.html#ad87d0e7560bc11e218a04b46afafbe7d">assignParams</a>(<a class="code" href="class_input_params.html">InputParams</a>&amp; params);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; <span class="comment">// Override internal structure of halos</span></div>
<div class="line"><a name="l00842"></a><span class="lineno"><a class="line" href="class_lens_halo_n_f_w.html#adb9b25642affcf63ab35b4b05c9f99ac">  842</a></span>&#160;<span class="comment"></span> <span class="keyword">inline</span> PosType <a class="code" href="class_lens_halo_n_f_w.html#adb9b25642affcf63ab35b4b05c9f99ac">alpha_h</a>(PosType x)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="comment">//return -1.0*InterpolateFromTable(gtable,x)/InterpolateFromTable(gtable,xmax);</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  <span class="keywordflow">return</span> -1.0*<a class="code" href="class_lens_halo_n_f_w.html#a9f48edfd8a1cbc024b8e51ca879aab36">InterpolateFromTable</a>(gtable,x)/gmax;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="comment">// return -0.5/x*InterpolateFromTable(gtable,x)/gmax;</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; }</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; <span class="keyword">inline</span> KappaType kappa_h(PosType x)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="keywordflow">return</span> 0.5*x*x*<a class="code" href="class_lens_halo_n_f_w.html#a9f48edfd8a1cbc024b8e51ca879aab36">InterpolateFromTable</a>(<a class="code" href="class_lens_halo_n_f_w.html#ad69ef65ce813a404b34a0fe20a6cf9cd">ftable</a>,x)/gmax;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; <span class="keyword">inline</span> KappaType gamma_h(PosType x)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="comment">//return -0.25*x*x*InterpolateFromTable(g2table,x)/gmax;</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="keywordflow">return</span> -0.5*x*x*<a class="code" href="class_lens_halo_n_f_w.html#a9f48edfd8a1cbc024b8e51ca879aab36">InterpolateFromTable</a>(g2table,x)/gmax;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; }</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; <span class="keyword">inline</span> KappaType phi_h(PosType x)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordflow">return</span> 0.25*(<a class="code" href="class_lens_halo_n_f_w.html#a9f48edfd8a1cbc024b8e51ca879aab36">InterpolateFromTable</a>(htable,x) - <a class="code" href="class_lens_halo_n_f_w.html#a9f48edfd8a1cbc024b8e51ca879aab36">InterpolateFromTable</a>(htable,<a class="code" href="class_lens_halo.html#a2616defcc052fd9ab1e568cfd8a5c9a9">LensHalo::getRsize</a>()/<a class="code" href="class_lens_halo.html#ad0138e93c3a165ae25cd42bea42c4c4b">rscale</a>))/gmax + log(<a class="code" href="class_lens_halo.html#a2616defcc052fd9ab1e568cfd8a5c9a9">LensHalo::getRsize</a>()) ;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="comment">// The constant contribution is made to match with the point mass at x = Rsize/rscale.</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160; }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  <span class="keyword">inline</span> KappaType phi_int(PosType x)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordflow">return</span> -1.0*<a class="code" href="class_lens_halo_n_f_w.html#a9f48edfd8a1cbc024b8e51ca879aab36">InterpolateFromTable</a>(xgtable,x)/gmax; <span class="comment">//alpha_int(x);</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  }</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;  PosType gmax;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;};</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="comment">// ********************</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00880"></a><span class="lineno"><a class="line" href="class_lens_halo_pseudo_n_f_w.html">  880</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_lens_halo_pseudo_n_f_w.html">LensHaloPseudoNFW</a>: <span class="keyword">public</span> <a class="code" href="class_lens_halo.html">LensHalo</a>{</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160; <a class="code" href="class_lens_halo_pseudo_n_f_w.html#aa575a8223d58064bb6a4ff182728bf74">LensHaloPseudoNFW</a>();</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;  <a class="code" href="class_lens_halo_pseudo_n_f_w.html#aa575a8223d58064bb6a4ff182728bf74">LensHaloPseudoNFW</a>(<span class="keywordtype">float</span> my_mass,<span class="keywordtype">float</span> my_Rsize,PosType my_zlens,<span class="keywordtype">float</span> my_rscale,PosType my_beta,<span class="keywordtype">float</span> my_fratio,<span class="keywordtype">float</span> my_pa,<span class="keyword">const</span> COSMOLOGY &amp;cosmo, <a class="code" href="_input_params_8h.html#abeeb8c8413457c56ac46767a52fc2618">EllipMethod</a> my_ellip_method=EllipMethod::Pseudo);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160; <span class="comment">//LensHaloPseudoNFW(InputParams&amp; params);</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; ~<a class="code" href="class_lens_halo_pseudo_n_f_w.html">LensHaloPseudoNFW</a>();</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160; PosType <a class="code" href="class_lens_halo_pseudo_n_f_w.html#a40844cb3d12a0028b0c95c04bb10d834">mhat</a>(PosType y, PosType beta) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  PosType gfunction(PosType x) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  </div>
<div class="line"><a name="l00892"></a><span class="lineno"><a class="line" href="class_lens_halo_pseudo_n_f_w.html#a2315731cb8f04955e511ea49cc51428c">  892</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_pseudo_n_f_w.html#a2315731cb8f04955e511ea49cc51428c">set_slope</a>(PosType my_slope){beta=my_slope; make_tables();};</div>
<div class="line"><a name="l00894"></a><span class="lineno"><a class="line" href="class_lens_halo_pseudo_n_f_w.html#ad7e3fe8f3cd6be7b4851bc09091d47be">  894</a></span>&#160;  PosType <a class="code" href="class_lens_halo_pseudo_n_f_w.html#ad7e3fe8f3cd6be7b4851bc09091d47be">get_slope</a>(){<span class="keywordflow">return</span> beta;};</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <span class="comment">//void set_Rsize(float my_Rsize){Rsize = my_Rsize; xmax = Rsize/rscale;};</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_pseudo_n_f_w.html#a943a817b3f07b719a7becccd302d833e">initFromMassFunc</a>(<span class="keywordtype">float</span> my_mass, <span class="keywordtype">float</span> my_Rsize, <span class="keywordtype">float</span> my_rscale, PosType my_slope, <span class="keywordtype">long</span> *seed);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  </div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160; <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">long</span> NTABLE;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; <span class="keyword">static</span> <span class="keyword">const</span> PosType maxrm;</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; <span class="keyword">static</span> <span class="keywordtype">int</span> count;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; <span class="keyword">static</span> PosType *mhattable,*xtable;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; <span class="keywordtype">void</span> make_tables();</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; PosType InterpolateFromTable(PosType y) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; <span class="keywordtype">void</span> assignParams(<a class="code" href="class_input_params.html">InputParams</a>&amp; params);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; PosType beta;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; <span class="comment">// Override internal structure of halos</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment"></span> <span class="keyword">inline</span> PosType alpha_h(PosType x)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="keywordflow">return</span> -1.0*InterpolateFromTable(x)/InterpolateFromTable(xmax);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; <span class="keyword">inline</span> KappaType kappa_h(PosType x)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="keywordflow">return</span> 0.5*x*x/InterpolateFromTable(xmax)/pow(1+x,beta);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; }</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160; <span class="keyword">inline</span> KappaType gamma_h(PosType x)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="comment">//return (0.5*x*x/pow(1+x,beta) - InterpolateFromTable(x))/InterpolateFromTable(xmax);</span></div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="keywordflow">return</span> (x*x/pow(1+x,beta) - 2*InterpolateFromTable(x))/InterpolateFromTable(xmax);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; }</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; <span class="keyword">inline</span> KappaType phi_h(PosType x)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="keywordflow">return</span> -1.0*<a class="code" href="class_lens_halo.html#a3e73f06df4d909f1bff909016cc839b2">alpha_int</a>(x)/InterpolateFromTable(xmax) ;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="comment">//ERROR_MESSAGE();</span></div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="comment">//std::cout &lt;&lt; &quot;time delay has not been fixed for PseudoNFW profile yet.&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <span class="comment">//exit(1);</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="comment">//return 0.0;</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; }</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keyword">inline</span> KappaType phi_int(PosType x)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        <span class="keywordflow">return</span> -1.0*<a class="code" href="class_lens_halo.html#a3e73f06df4d909f1bff909016cc839b2">alpha_int</a>(x)/InterpolateFromTable(xmax) ;</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    }</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;};</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; </div>
<div class="line"><a name="l00952"></a><span class="lineno"><a class="line" href="class_lens_halo_power_law.html">  952</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_lens_halo_power_law.html">LensHaloPowerLaw</a>: <span class="keyword">public</span> <a class="code" href="class_lens_halo.html">LensHalo</a>{</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160; <a class="code" href="class_lens_halo_power_law.html">LensHaloPowerLaw</a>();</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <a class="code" href="class_lens_halo_power_law.html">LensHaloPowerLaw</a>(<span class="keywordtype">float</span> my_mass,<span class="keywordtype">float</span> my_Rsize,PosType my_zlens,PosType my_beta</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                   ,<span class="keywordtype">float</span> my_fratio,<span class="keywordtype">float</span> my_pa,<span class="keyword">const</span> COSMOLOGY &amp;cosmo</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                   ,<a class="code" href="_input_params_8h.html#abeeb8c8413457c56ac46767a52fc2618">EllipMethod</a> my_ellip_method=EllipMethod::Pseudo);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; <span class="comment">//LensHaloPowerLaw(InputParams&amp; params);</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; ~<a class="code" href="class_lens_halo_power_law.html">LensHaloPowerLaw</a>();</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; <span class="comment">//void set_slope(PosType my_slope){beta=my_slope;};</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="comment">//PosType get_slope(){return beta;};</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_power_law.html#a2265529c633a4ac00ab06eaebe3c9c18">initFromMassFunc</a>(<span class="keywordtype">float</span> my_mass, <span class="keywordtype">float</span> my_Rsize, <span class="keywordtype">float</span> my_rscale, PosType my_slope, <span class="keywordtype">long</span> *seed);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; <span class="keywordtype">void</span> assignParams(<a class="code" href="class_input_params.html">InputParams</a>&amp; params);</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; <span class="comment">// PosType beta;</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; <span class="comment">// Override internal structure of halos</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment"></span> <span class="keyword">inline</span> PosType alpha_h(</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                         PosType x  </div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                         )<span class="keyword"> const</span>{</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="keywordflow">if</span>(x&lt;xmax*1.0e-6) x=1e-6*xmax;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="keywordflow">return</span> -1.0*pow(x/xmax,-beta+2);</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; }</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; <span class="keyword">inline</span> KappaType kappa_h(</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                           PosType x   </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                           )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  <span class="keywordflow">if</span>(x==0) x=1e-6*xmax;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordtype">double</span> tmp = x/xmax;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  <span class="keywordflow">return</span> 0.5*(-beta+2)*pow(tmp,2-beta);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; }</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160; <span class="keyword">inline</span> KappaType gamma_h(PosType x)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  <span class="keywordflow">if</span>(x==0) x=1e-6*xmax;</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordflow">return</span> -beta*pow(x/xmax,-beta+2);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;  <span class="keyword">inline</span> KappaType phi_h(PosType x)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <span class="keywordflow">if</span>(x==0) x=1e-6*xmax;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordflow">return</span> ( pow(x/xmax,2-beta) - 1 )/(2-beta) + log(<a class="code" href="class_lens_halo.html#a2616defcc052fd9ab1e568cfd8a5c9a9">LensHalo::getRsize</a>()) ;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; }</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="keyword">inline</span> KappaType phi_int(PosType x)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <span class="comment">//return alpha_int(x);</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="keywordflow">return</span> -1.0*pow(x/xmax,-beta+2)/(2-beta);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;};</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"><a class="line" href="class_lens_halo_real_n_s_i_e.html"> 1023</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_lens_halo_real_n_s_i_e.html">LensHaloRealNSIE</a> : <span class="keyword">public</span> <a class="code" href="class_lens_halo.html">LensHalo</a>{</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <a class="code" href="class_lens_halo_real_n_s_i_e.html#a6740f067c19676e37d7cf85ae695eefb">LensHaloRealNSIE</a>(<span class="keywordtype">float</span> my_mass,PosType my_zlens,<span class="keywordtype">float</span> my_sigma</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                   ,<span class="keywordtype">float</span> my_rcore,<span class="keywordtype">float</span> my_fratio,<span class="keywordtype">float</span> my_pa,<span class="keyword">const</span> COSMOLOGY &amp;cosmo);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="comment">// Warning: If my_rcore &gt; 0.0 and my_fratio &lt; 1 then the mass will be somewhat less than my_mass.</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160; <span class="comment">//LensHaloRealNSIE(InputParams&amp; params);</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <a class="code" href="class_lens_halo_real_n_s_i_e.html#a6740f067c19676e37d7cf85ae695eefb">LensHaloRealNSIE</a>(<span class="keyword">const</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html">LensHaloRealNSIE</a> &amp;h):</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <a class="code" href="class_lens_halo.html#a813618bcd6d1f26dafa49a2e509a37db">LensHalo</a>(h)</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    ++objectCount;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <a class="code" href="class_lens_halo_real_n_s_i_e.html#a3e5b1c58a0e49787473551bf3ee2d893">sigma</a> = h.<a class="code" href="class_lens_halo_real_n_s_i_e.html#a3e5b1c58a0e49787473551bf3ee2d893">sigma</a>;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <a class="code" href="class_lens_halo_real_n_s_i_e.html#ad5b2d23ccf59add995299c843082014c">fratio</a> = h.<a class="code" href="class_lens_halo_real_n_s_i_e.html#ad5b2d23ccf59add995299c843082014c">fratio</a>;</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <a class="code" href="class_lens_halo_real_n_s_i_e.html#a8cf88e172212e1ea469eb9348fbca782">pa</a> = h.<a class="code" href="class_lens_halo_real_n_s_i_e.html#a8cf88e172212e1ea469eb9348fbca782">pa</a>;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <a class="code" href="class_lens_halo_real_n_s_i_e.html#a3459fe0ce3588c7a52a4d1c37a9e7f55">rcore</a> = h.<a class="code" href="class_lens_halo_real_n_s_i_e.html#a3459fe0ce3588c7a52a4d1c37a9e7f55">rcore</a>;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    units = h.units;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  }</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <a class="code" href="class_lens_halo_real_n_s_i_e.html">LensHaloRealNSIE</a> &amp;operator=(<span class="keyword">const</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html">LensHaloRealNSIE</a> &amp;h){</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordflow">if</span>(&amp;h == <span class="keyword">this</span>) <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <a class="code" href="class_lens_halo.html#aaa135c7e56a24de4a1dee76604a44141">LensHalo::operator=</a>(h);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <a class="code" href="class_lens_halo_real_n_s_i_e.html#a3e5b1c58a0e49787473551bf3ee2d893">sigma</a> = h.<a class="code" href="class_lens_halo_real_n_s_i_e.html#a3e5b1c58a0e49787473551bf3ee2d893">sigma</a>;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <a class="code" href="class_lens_halo_real_n_s_i_e.html#ad5b2d23ccf59add995299c843082014c">fratio</a> = h.<a class="code" href="class_lens_halo_real_n_s_i_e.html#ad5b2d23ccf59add995299c843082014c">fratio</a>;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <a class="code" href="class_lens_halo_real_n_s_i_e.html#a8cf88e172212e1ea469eb9348fbca782">pa</a> = h.<a class="code" href="class_lens_halo_real_n_s_i_e.html#a8cf88e172212e1ea469eb9348fbca782">pa</a>;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <a class="code" href="class_lens_halo_real_n_s_i_e.html#a3459fe0ce3588c7a52a4d1c37a9e7f55">rcore</a> = h.<a class="code" href="class_lens_halo_real_n_s_i_e.html#a3459fe0ce3588c7a52a4d1c37a9e7f55">rcore</a>;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    units = h.units;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  }</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160; ~<a class="code" href="class_lens_halo_real_n_s_i_e.html">LensHaloRealNSIE</a>();</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html#a819bd516935f96820fe43e5b27d6fec5">force_halo</a>(PosType *alpha,KappaType *kappa,KappaType *gamma,KappaType *phi,PosType <span class="keyword">const</span> *xcm,<span class="keywordtype">bool</span> subtract_point=<span class="keyword">false</span>,PosType screening = 1.0);</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"><a class="line" href="class_lens_halo_real_n_s_i_e.html#a67d91d891fd292da7edc05408a280f16"> 1061</a></span>&#160; <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html#a67d91d891fd292da7edc05408a280f16">get_sigma</a>(){<span class="keywordflow">return</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html#a3e5b1c58a0e49787473551bf3ee2d893">sigma</a>;};</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160; <span class="comment">// get the NSIE radius</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; <span class="comment">//float get_Rsize(){return Rsize;};</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"><a class="line" href="class_lens_halo_real_n_s_i_e.html#aeb41845d0867785f69d47dd61c044c0f"> 1065</a></span>&#160;<span class="comment"></span> <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html#aeb41845d0867785f69d47dd61c044c0f">get_fratio</a>(){<span class="keywordflow">return</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html#ad5b2d23ccf59add995299c843082014c">fratio</a>;};</div>
<div class="line"><a name="l01067"></a><span class="lineno"><a class="line" href="class_lens_halo_real_n_s_i_e.html#a1c671a7e6cf51beec3eee19566364198"> 1067</a></span>&#160; <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html#a1c671a7e6cf51beec3eee19566364198">get_pa</a>(){<span class="keywordflow">return</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html#a8cf88e172212e1ea469eb9348fbca782">pa</a>;};</div>
<div class="line"><a name="l01069"></a><span class="lineno"><a class="line" href="class_lens_halo_real_n_s_i_e.html#a87eddad4a45f97513a24e7767217048c"> 1069</a></span>&#160; <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html#a87eddad4a45f97513a24e7767217048c">get_rcore</a>(){<span class="keywordflow">return</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html#a3459fe0ce3588c7a52a4d1c37a9e7f55">rcore</a>;};</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  </div>
<div class="line"><a name="l01072"></a><span class="lineno"><a class="line" href="class_lens_halo_real_n_s_i_e.html#ad1508629420d5c79d3601cb4665114fe"> 1072</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html#ad1508629420d5c79d3601cb4665114fe">set_sigma</a>(<span class="keywordtype">float</span> my_sigma){<a class="code" href="class_lens_halo_real_n_s_i_e.html#a3e5b1c58a0e49787473551bf3ee2d893">sigma</a>=my_sigma;};</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; <span class="comment">// set the NSIE radius</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160; <span class="comment">//void set_Rsize(float my_Rsize){Rsize=my_Rsize;};</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"><a class="line" href="class_lens_halo_real_n_s_i_e.html#a12e878c04721c762ae9bebc5a25c01c2"> 1076</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html#a12e878c04721c762ae9bebc5a25c01c2">set_fratio</a>(<span class="keywordtype">float</span> my_fratio){<a class="code" href="class_lens_halo_real_n_s_i_e.html#ad5b2d23ccf59add995299c843082014c">fratio</a>=my_fratio;};</div>
<div class="line"><a name="l01078"></a><span class="lineno"><a class="line" href="class_lens_halo_real_n_s_i_e.html#a5f74372b820be290639413cd26456028"> 1078</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html#a5f74372b820be290639413cd26456028">set_pa</a>(<span class="keywordtype">float</span> my_pa){<a class="code" href="class_lens_halo_real_n_s_i_e.html#a8cf88e172212e1ea469eb9348fbca782">pa</a>=my_pa;};</div>
<div class="line"><a name="l01080"></a><span class="lineno"><a class="line" href="class_lens_halo_real_n_s_i_e.html#a2ed71c36a12d26cc7188d2db9625a8d7"> 1080</a></span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html#a2ed71c36a12d26cc7188d2db9625a8d7">set_rcore</a>(<span class="keywordtype">float</span> my_rcore){<a class="code" href="class_lens_halo_real_n_s_i_e.html#a3459fe0ce3588c7a52a4d1c37a9e7f55">rcore</a>=my_rcore;};</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  </div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  <span class="keywordtype">void</span> setZlens(PosType my_zlens,<span class="keyword">const</span> COSMOLOGY &amp;cosmo){</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <a class="code" href="class_lens_halo.html#a3c28739f7088e24bda7d67b14f50d4ba">LensHalo::setZlens</a>(my_zlens,cosmo);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;  }</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="keywordtype">float</span> units;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  </div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">size_t</span> objectCount;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="keyword">static</span> std::vector&lt;double&gt; q_table;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="keyword">static</span> std::vector&lt;double&gt; Fofq_table;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160; <span class="comment">//void initFromFile(float my_mass, long *seed, float vmax, float r_halfmass);</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment"></span> <span class="comment">//void initFromMassFunc(float my_mass, float my_Rsize, float my_rscale, PosType my_slope, long *seed);</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment"></span> <span class="comment">//void initFromMass(float my_mass, long *seed);</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html#ad424eaab3e55a1b101f0b7a84fdc474b">assignParams</a>(<a class="code" href="class_input_params.html">InputParams</a>&amp; params);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  </div>
<div class="line"><a name="l01106"></a><span class="lineno"><a class="line" href="class_lens_halo_real_n_s_i_e.html#a3e5b1c58a0e49787473551bf3ee2d893"> 1106</a></span>&#160; <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html#a3e5b1c58a0e49787473551bf3ee2d893">sigma</a>;</div>
<div class="line"><a name="l01108"></a><span class="lineno"><a class="line" href="class_lens_halo_real_n_s_i_e.html#ad5b2d23ccf59add995299c843082014c"> 1108</a></span>&#160; <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html#ad5b2d23ccf59add995299c843082014c">fratio</a>;</div>
<div class="line"><a name="l01110"></a><span class="lineno"><a class="line" href="class_lens_halo_real_n_s_i_e.html#a8cf88e172212e1ea469eb9348fbca782"> 1110</a></span>&#160; <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html#a8cf88e172212e1ea469eb9348fbca782">pa</a>;</div>
<div class="line"><a name="l01112"></a><span class="lineno"><a class="line" href="class_lens_halo_real_n_s_i_e.html#a3459fe0ce3588c7a52a4d1c37a9e7f55"> 1112</a></span>&#160; <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_real_n_s_i_e.html#a3459fe0ce3588c7a52a4d1c37a9e7f55">rcore</a>;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  PosType <a class="code" href="class_lens_halo_real_n_s_i_e.html#a277e6c93788c290fcf7c9bbbd32b0ce6">rmax_calc</a>();</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  <span class="keywordtype">void</span> construct_ellip_tables();</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  </div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <span class="keyword">struct </span>NormFuncer{</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    NormFuncer(<span class="keywordtype">double</span> my_q):q(my_q){};</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keywordtype">double</span> operator()(<span class="keywordtype">double</span> t){</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      <span class="keywordflow">return</span> 1.0/sqrt( 1 + (q*q-1)*sin(t)*sin(t));</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    };</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    </div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <span class="keyword">private</span>:</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <span class="keywordtype">double</span> q;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  };</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;};</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; </div>
<div class="line"><a name="l01135"></a><span class="lineno"><a class="line" href="class_lens_halo_t_n_s_i_e.html"> 1135</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_lens_halo_t_n_s_i_e.html">LensHaloTNSIE</a> : <span class="keyword">public</span> <a class="code" href="class_lens_halo.html">LensHalo</a>{</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; </div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <a class="code" href="class_lens_halo_t_n_s_i_e.html#ae1647b315335acfded0e4559af0e41e5">LensHaloTNSIE</a>(<span class="keywordtype">float</span> my_mass  </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                ,PosType my_zlens </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                ,<span class="keywordtype">float</span> my_sigma  </div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                ,<span class="keywordtype">float</span> my_rcore  </div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                ,<span class="keywordtype">float</span> my_fratio </div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                ,<span class="keywordtype">float</span> my_pa     </div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                ,<span class="keyword">const</span> COSMOLOGY &amp;cosmo  </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                ,<span class="keywordtype">float</span> f=20 </div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                );</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <a class="code" href="class_lens_halo_t_n_s_i_e.html#ae1647b315335acfded0e4559af0e41e5">LensHaloTNSIE</a>(<span class="keyword">const</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html">LensHaloTNSIE</a> &amp;h):</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <a class="code" href="class_lens_halo.html#a813618bcd6d1f26dafa49a2e509a37db">LensHalo</a>(h)</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  {</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <a class="code" href="class_lens_halo_t_n_s_i_e.html#aba3b57e5f20418bfbc92ffcf0053baf1">sigma</a> = h.<a class="code" href="class_lens_halo_t_n_s_i_e.html#aba3b57e5f20418bfbc92ffcf0053baf1">sigma</a>;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <a class="code" href="class_lens_halo_t_n_s_i_e.html#a75725b3e22d3f36a7284d45780e4125e">fratio</a> = h.<a class="code" href="class_lens_halo_t_n_s_i_e.html#a75725b3e22d3f36a7284d45780e4125e">fratio</a>;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <a class="code" href="class_lens_halo_t_n_s_i_e.html#a79d2dccc1b626db90b6c9772f0d65a86">pa</a> = h.<a class="code" href="class_lens_halo_t_n_s_i_e.html#a79d2dccc1b626db90b6c9772f0d65a86">pa</a>;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <a class="code" href="class_lens_halo_t_n_s_i_e.html#a1a281b8ccbeec2d19d2eb16b2a8c6a5c">rcore</a> = h.<a class="code" href="class_lens_halo_t_n_s_i_e.html#a1a281b8ccbeec2d19d2eb16b2a8c6a5c">rcore</a>;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <a class="code" href="class_lens_halo_t_n_s_i_e.html#a5d376b662906ce37c7e460c93c0bfd91">rtrunc</a> = h.<a class="code" href="class_lens_halo_t_n_s_i_e.html#a5d376b662906ce37c7e460c93c0bfd91">rtrunc</a>;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    units = h.units;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  }</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  </div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <a class="code" href="class_lens_halo_t_n_s_i_e.html">LensHaloTNSIE</a> &amp;operator=(<span class="keyword">const</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html">LensHaloTNSIE</a> &amp;h){</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="keywordflow">if</span>(&amp;h == <span class="keyword">this</span>) <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <a class="code" href="class_lens_halo.html#aaa135c7e56a24de4a1dee76604a44141">LensHalo::operator=</a>(h);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <a class="code" href="class_lens_halo_t_n_s_i_e.html#aba3b57e5f20418bfbc92ffcf0053baf1">sigma</a> = h.<a class="code" href="class_lens_halo_t_n_s_i_e.html#aba3b57e5f20418bfbc92ffcf0053baf1">sigma</a>;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <a class="code" href="class_lens_halo_t_n_s_i_e.html#a75725b3e22d3f36a7284d45780e4125e">fratio</a> = h.<a class="code" href="class_lens_halo_t_n_s_i_e.html#a75725b3e22d3f36a7284d45780e4125e">fratio</a>;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <a class="code" href="class_lens_halo_t_n_s_i_e.html#a79d2dccc1b626db90b6c9772f0d65a86">pa</a> = h.<a class="code" href="class_lens_halo_t_n_s_i_e.html#a79d2dccc1b626db90b6c9772f0d65a86">pa</a>;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <a class="code" href="class_lens_halo_t_n_s_i_e.html#a1a281b8ccbeec2d19d2eb16b2a8c6a5c">rcore</a> = h.<a class="code" href="class_lens_halo_t_n_s_i_e.html#a1a281b8ccbeec2d19d2eb16b2a8c6a5c">rcore</a>;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <a class="code" href="class_lens_halo_t_n_s_i_e.html#a5d376b662906ce37c7e460c93c0bfd91">rtrunc</a> = h.<a class="code" href="class_lens_halo_t_n_s_i_e.html#a5d376b662906ce37c7e460c93c0bfd91">rtrunc</a>;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    units = h.units;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  }</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  </div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  ~<a class="code" href="class_lens_halo_t_n_s_i_e.html">LensHaloTNSIE</a>(){};</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  </div>
<div class="line"><a name="l01174"></a><span class="lineno"><a class="line" href="class_lens_halo_t_n_s_i_e.html#a0971c25099944f15e3e15047b41fef4e"> 1174</a></span>&#160;  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#a0971c25099944f15e3e15047b41fef4e">calc_sigma</a>(<span class="keywordtype">float</span> mass,<span class="keywordtype">float</span> Rtrunc,<span class="keywordtype">float</span> Rcore,<span class="keywordtype">float</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#a75725b3e22d3f36a7284d45780e4125e">fratio</a>){</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    <span class="keywordflow">return</span> lightspeed*sqrt( Grav*mass*sqrt(<a class="code" href="class_lens_halo_t_n_s_i_e.html#a75725b3e22d3f36a7284d45780e4125e">fratio</a>) / (Rtrunc-Rcore) / PI);</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  }</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#a21702bde8394612b37e7f8b4d87086d7">force_halo</a>(PosType *alpha,KappaType *kappa,KappaType *gamma,KappaType *phi,PosType <span class="keyword">const</span> *xcm,<span class="keywordtype">bool</span> subtract_point=<span class="keyword">false</span>,PosType screening = 1.0);</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  </div>
<div class="line"><a name="l01182"></a><span class="lineno"><a class="line" href="class_lens_halo_t_n_s_i_e.html#aeb50b46767ac92a5d475e30350519858"> 1182</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#aeb50b46767ac92a5d475e30350519858">get_sigma</a>(){<span class="keywordflow">return</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#aba3b57e5f20418bfbc92ffcf0053baf1">sigma</a>;};</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <span class="comment">// get the NSIE radius</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="comment">//float get_Rsize(){return Rsize;};</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"><a class="line" href="class_lens_halo_t_n_s_i_e.html#aa92bb3655a5680cf83616f3a6a0eac68"> 1186</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#aa92bb3655a5680cf83616f3a6a0eac68">get_fratio</a>(){<span class="keywordflow">return</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#a75725b3e22d3f36a7284d45780e4125e">fratio</a>;};</div>
<div class="line"><a name="l01188"></a><span class="lineno"><a class="line" href="class_lens_halo_t_n_s_i_e.html#a02d54f8e189ddbf50320f05d39860bf9"> 1188</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#a02d54f8e189ddbf50320f05d39860bf9">get_pa</a>(){<span class="keywordflow">return</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#a79d2dccc1b626db90b6c9772f0d65a86">pa</a>;};</div>
<div class="line"><a name="l01190"></a><span class="lineno"><a class="line" href="class_lens_halo_t_n_s_i_e.html#a0de4f393396586902f42613cff6dd9da"> 1190</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#a0de4f393396586902f42613cff6dd9da">get_rcore</a>(){<span class="keywordflow">return</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#a1a281b8ccbeec2d19d2eb16b2a8c6a5c">rcore</a>;};</div>
<div class="line"><a name="l01192"></a><span class="lineno"><a class="line" href="class_lens_halo_t_n_s_i_e.html#afa724ff75a37e7a1d0972efd7e02d646"> 1192</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#afa724ff75a37e7a1d0972efd7e02d646">get_rtrunc</a>(){<span class="keywordflow">return</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#a5d376b662906ce37c7e460c93c0bfd91">rtrunc</a>;};</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  </div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <span class="keywordtype">void</span> setZlens(PosType my_zlens,<span class="keyword">const</span> COSMOLOGY &amp;cosmo){</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <a class="code" href="class_lens_halo.html#a3c28739f7088e24bda7d67b14f50d4ba">LensHalo::setZlens</a>(my_zlens,cosmo);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  }</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"><a class="line" href="class_lens_halo_t_n_s_i_e.html#a66e3c61b00069ddefc20440bdda88bbc"> 1199</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#a66e3c61b00069ddefc20440bdda88bbc">set_pa</a>(<span class="keywordtype">float</span> my_pa){<a class="code" href="class_lens_halo_t_n_s_i_e.html#a79d2dccc1b626db90b6c9772f0d65a86">pa</a>=my_pa;};</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  </div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="keywordtype">float</span> units;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  </div>
<div class="line"><a name="l01206"></a><span class="lineno"><a class="line" href="class_lens_halo_t_n_s_i_e.html#adb0eb481a621deed3d074c8cd452377e"> 1206</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#adb0eb481a621deed3d074c8cd452377e">assignParams</a>(<a class="code" href="class_input_params.html">InputParams</a>&amp; params);</div>
<div class="line"><a name="l01208"></a><span class="lineno"><a class="line" href="class_lens_halo_t_n_s_i_e.html#aba3b57e5f20418bfbc92ffcf0053baf1"> 1208</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#aba3b57e5f20418bfbc92ffcf0053baf1">sigma</a>;</div>
<div class="line"><a name="l01210"></a><span class="lineno"><a class="line" href="class_lens_halo_t_n_s_i_e.html#a75725b3e22d3f36a7284d45780e4125e"> 1210</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#a75725b3e22d3f36a7284d45780e4125e">fratio</a>;</div>
<div class="line"><a name="l01212"></a><span class="lineno"><a class="line" href="class_lens_halo_t_n_s_i_e.html#a79d2dccc1b626db90b6c9772f0d65a86"> 1212</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#a79d2dccc1b626db90b6c9772f0d65a86">pa</a>;</div>
<div class="line"><a name="l01214"></a><span class="lineno"><a class="line" href="class_lens_halo_t_n_s_i_e.html#a1a281b8ccbeec2d19d2eb16b2a8c6a5c"> 1214</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#a1a281b8ccbeec2d19d2eb16b2a8c6a5c">rcore</a>;</div>
<div class="line"><a name="l01216"></a><span class="lineno"><a class="line" href="class_lens_halo_t_n_s_i_e.html#a5d376b662906ce37c7e460c93c0bfd91"> 1216</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_t_n_s_i_e.html#a5d376b662906ce37c7e460c93c0bfd91">rtrunc</a>;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;};</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160; </div>
<div class="line"><a name="l01224"></a><span class="lineno"><a class="line" href="class_lens_halo_t_e_p_l.html"> 1224</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_lens_halo_t_e_p_l.html">LensHaloTEPL</a> : <span class="keyword">public</span> <a class="code" href="class_lens_halo.html">LensHalo</a>{</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160; </div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  <a class="code" href="class_lens_halo_t_e_p_l.html#a0a1009d8336d27acb46523aab2c6248a">LensHaloTEPL</a>(<span class="keywordtype">float</span> my_mass  </div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                ,PosType my_zlens </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                ,PosType r_trunc  </div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                ,PosType gamma    </div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                ,<span class="keywordtype">float</span> my_fratio </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                ,<span class="keywordtype">float</span> my_pa     </div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                ,<span class="keyword">const</span> COSMOLOGY &amp;cosmo  </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                ,<span class="keywordtype">float</span> f=10 </div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;  );</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  </div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;  <a class="code" href="class_lens_halo_t_e_p_l.html#a0a1009d8336d27acb46523aab2c6248a">LensHaloTEPL</a>(<span class="keyword">const</span> <a class="code" href="class_lens_halo_t_e_p_l.html">LensHaloTEPL</a> &amp;h):</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  <a class="code" href="class_lens_halo.html#a813618bcd6d1f26dafa49a2e509a37db">LensHalo</a>(h)</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  {</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    tt = h.tt;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    x_T = h.x_T;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    q = h.q;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    q_prime = h.q_prime;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    SigmaT = h.SigmaT;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    pa = h.pa;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    mass_pi = h.mass_pi;</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    R = h.R;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  }</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  </div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  <a class="code" href="class_lens_halo_t_e_p_l.html">LensHaloTEPL</a> &amp;operator=(<span class="keyword">const</span> <a class="code" href="class_lens_halo_t_e_p_l.html">LensHaloTEPL</a> &amp;h){</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="keywordflow">if</span>(&amp;h == <span class="keyword">this</span>) <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <a class="code" href="class_lens_halo.html#aaa135c7e56a24de4a1dee76604a44141">LensHalo::operator=</a>(h);</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160; </div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    tt = h.tt;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    x_T = h.x_T;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    q = h.q;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    q_prime = h.q_prime;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    SigmaT = h.SigmaT;</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    pa = h.pa;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    mass_pi = h.mass_pi;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    R = h.R;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160; </div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  }</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  </div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  ~<a class="code" href="class_lens_halo_t_e_p_l.html">LensHaloTEPL</a>(){};</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160; </div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_t_e_p_l.html#ae8d450a37357553b9ddfcdfd06a8432e">force_halo</a>(PosType *alpha,KappaType *kappa,KappaType *gamma,KappaType *phi,PosType <span class="keyword">const</span> *xcm,<span class="keywordtype">bool</span> subtract_point=<span class="keyword">false</span>,PosType screening = 1.0);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  </div>
<div class="line"><a name="l01273"></a><span class="lineno"><a class="line" href="class_lens_halo_t_e_p_l.html#aa488c95058148f51577392a753802dda"> 1273</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_t_e_p_l.html#aa488c95058148f51577392a753802dda">get_fratio</a>(){<span class="keywordflow">return</span> q;};</div>
<div class="line"><a name="l01275"></a><span class="lineno"><a class="line" href="class_lens_halo_t_e_p_l.html#a673e1ea86f674734350a7830dcefea95"> 1275</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_t_e_p_l.html#a673e1ea86f674734350a7830dcefea95">get_pa</a>(){<span class="keywordflow">return</span> pa;};</div>
<div class="line"><a name="l01277"></a><span class="lineno"><a class="line" href="class_lens_halo_t_e_p_l.html#a3f38a1045bb28545ed29d04d9e517914"> 1277</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_t_e_p_l.html#a3f38a1045bb28545ed29d04d9e517914">get_rtrunc</a>(){<span class="keywordflow">return</span> x_T;};</div>
<div class="line"><a name="l01279"></a><span class="lineno"><a class="line" href="class_lens_halo_t_e_p_l.html#abb5f991dc2bec41d9e532b92f5f87038"> 1279</a></span>&#160;  <span class="keywordtype">float</span> <a class="code" href="class_lens_halo_t_e_p_l.html#abb5f991dc2bec41d9e532b92f5f87038">get_t</a>(){<span class="keywordflow">return</span> tt;}</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;  </div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <span class="keywordtype">void</span> set_pa(<span class="keywordtype">double</span> p){pa = p;}</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  </div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <span class="keywordtype">void</span> deflection(std::complex&lt;double&gt; &amp;z</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                  ,std::complex&lt;double&gt; &amp;a</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                  ,std::complex&lt;double&gt; &amp;g</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                  ,KappaType &amp;sigma) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;  </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  </div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <span class="comment">//float units;</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <span class="keywordtype">double</span> tt;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="keywordtype">double</span> x_T;       <span class="comment">// truncation radius</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="keywordtype">double</span> q;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  <span class="keywordtype">double</span> q_prime;</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <span class="keywordtype">double</span> SigmaT;   <span class="comment">// SigmaT - surface density at truncation radius</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  <span class="keywordtype">double</span> pa;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="keywordtype">double</span> mass_pi;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  std::complex&lt;double&gt; R; <span class="comment">// rotation</span></div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  </div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  std::complex&lt;double&gt; F(<span class="keywordtype">double</span> r_e,<span class="keywordtype">double</span> t,std::complex&lt;double&gt; z) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;};</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160; </div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment">/*** \brief Truncated eliptical double power-law</span></div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="keyword">class </span>LensHaloTEBPL : <span class="keyword">public</span> <a class="code" href="class_lens_halo.html">LensHalo</a>{</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  </div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;  LensHaloTEBPL(<span class="keywordtype">float</span> my_mass  </div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;                ,PosType my_zlens </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;                ,PosType r_break  </div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                ,PosType r_trunc  </div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                ,PosType t1    </div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                ,PosType t2    </div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                ,<span class="keywordtype">float</span> my_fratio </div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                ,<span class="keywordtype">float</span> my_pa     </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                ,<span class="keyword">const</span> COSMOLOGY &amp;cosmo  </div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                ,<span class="keywordtype">float</span> f=10 </div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  );</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160; </div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  ~LensHaloTEBPL(){}</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  </div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;  LensHaloTEBPL(<span class="keyword">const</span> LensHaloTEBPL &amp;h):</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;  <a class="code" href="class_lens_halo.html">LensHalo</a>(h),h1(h.h1),h2(h.h2),h3(h.h3)</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;  {</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160; </div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    m2 = h.m2;</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    m3 = h.m3;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    m1 = h.m1;</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    </div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    rb = h.rb;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    rt = h.rt;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    q = h.q;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160; </div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    R = h.R;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  }</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  </div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;  LensHaloTEBPL &amp;<a class="code" href="class_lens_halo.html#aaa135c7e56a24de4a1dee76604a44141">operator=</a>(<span class="keyword">const</span> LensHaloTEBPL &amp;h){</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    <span class="keywordflow">if</span>(&amp;h == <span class="keyword">this</span>) <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <a class="code" href="class_lens_halo.html#aaa135c7e56a24de4a1dee76604a44141">LensHalo::operator=</a>(h);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    h1 = h.h1;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    h2 = h.h2;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    h3 = h.h3;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    </div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    m2 = h.m2;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    m3 = h.m3;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    m1 = h.m1;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    </div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    rb = h.rb;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    rt = h.rt;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    q = h.q;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160; </div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    R = h.R;</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160; </div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;  }</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  </div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  <span class="keywordtype">float</span> get_fratio(){<span class="keywordflow">return</span> q;};</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;  <span class="keywordtype">float</span> get_pa(){<span class="keywordflow">return</span> pa;};</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <span class="keywordtype">float</span> get_rtrunc(){<span class="keywordflow">return</span> rt;};</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="keywordtype">float</span> get_rbreak(){<span class="keywordflow">return</span> rb;};</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <span class="keywordtype">float</span> get_t1(){<span class="keywordflow">return</span> h1.get_t();}</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="keywordtype">float</span> get_t2(){<span class="keywordflow">return</span> h2.get_t();}</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160; </div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;  <span class="keywordtype">void</span> set_pa(<span class="keywordtype">double</span> p){pa = p;}</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160; </div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a460de105e52520a328d5912455c02fdd">force_halo</a>(PosType *alpha,KappaType *kappa,KappaType *gamma,KappaType *phi,PosType <span class="keyword">const</span> *xcm,<span class="keywordtype">bool</span> subtract_point=<span class="keyword">false</span>,PosType screening = 1.0);</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;  </div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160; </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  <span class="keywordtype">double</span> q;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <span class="keywordtype">double</span> rb;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  <span class="keywordtype">double</span> rt;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160; </div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <span class="keywordtype">double</span> m2 ;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  <span class="keywordtype">double</span> m3 ;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;  <span class="keywordtype">double</span> m1 ;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  <a class="code" href="class_lens_halo_t_e_p_l.html">LensHaloTEPL</a> h1;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  <a class="code" href="class_lens_halo_t_e_p_l.html">LensHaloTEPL</a> h2;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;  <a class="code" href="class_lens_halo_t_e_p_l.html">LensHaloTEPL</a> h3;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  </div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;  std::complex&lt;PosType&gt; R;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;  </div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;};</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160; </div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="preprocessor">#ifdef ENABLE_CERF</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment">/***</span></div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="comment">\brief  A class for making elliptical Gaussian lenses.</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="comment"> This class uses the libcerf library (https://jugit.fz-juelich.de/mlz/libcerf).</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="comment"> It can be installed with homebrew and it must be linked by setting the cmake variable ENABLE_CERF = ON</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="keyword">class </span>LensHaloGaussian : <span class="keyword">public</span> <a class="code" href="class_lens_halo.html">LensHalo</a>{</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160; </div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  LensHaloGaussian(<span class="keywordtype">float</span> my_mass  </div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                ,PosType my_zlens </div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                ,PosType r_scale  </div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                ,<span class="keywordtype">float</span> my_fratio </div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                ,<span class="keywordtype">float</span> my_pa     </div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                ,<span class="keyword">const</span> COSMOLOGY &amp;cosmo  </div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                ,<span class="keywordtype">float</span> f=100 </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;  );</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;  </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;  LensHaloGaussian(<span class="keyword">const</span> LensHaloGaussian &amp;h):</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;  <a class="code" href="class_lens_halo.html">LensHalo</a>(h)</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  {</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    Rhight = h.Rhight;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    q = h.q;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    q_prime = h.q_prime;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    SigmaO = h.SigmaO;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    pa = h.pa;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    R = h.R;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    norm = h.norm;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    norm_g = h.norm_g;</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    ss = h.ss;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    I = h.I;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    I_sqpi = h.I_sqpi;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    one_sqpi = h.one_sqpi;</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;  }</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  </div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  LensHaloGaussian &amp;<a class="code" href="class_lens_halo.html#aaa135c7e56a24de4a1dee76604a44141">operator=</a>(<span class="keyword">const</span> LensHaloGaussian &amp;h){</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="keywordflow">if</span>(&amp;h == <span class="keyword">this</span>) <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <a class="code" href="class_lens_halo.html#aaa135c7e56a24de4a1dee76604a44141">LensHalo::operator=</a>(h);</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    </div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    Rhight = h.Rhight;</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    q = h.q;</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    q_prime = h.q_prime;</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    SigmaO = h.SigmaO;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    pa = h.pa;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    R = h.R;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    </div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    norm = h.norm;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    norm_g = h.norm_g;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    ss = h.ss;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    I = h.I;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    I_sqpi = h.I_sqpi;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    one_sqpi = h.one_sqpi;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    </div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  }</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;  </div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  ~LensHaloGaussian(){};</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160; </div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; </div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a460de105e52520a328d5912455c02fdd">force_halo</a>(PosType *alpha,KappaType *kappa,KappaType *gamma,KappaType *phi,PosType <span class="keyword">const</span> *xcm,<span class="keywordtype">bool</span> subtract_point=<span class="keyword">false</span>,PosType screening = 1.0);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  </div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <span class="keywordtype">float</span> get_fratio(){<span class="keywordflow">return</span> q;};</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  <span class="keywordtype">float</span> get_pa(){<span class="keywordflow">return</span> pa;};</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;  <span class="keywordtype">float</span> get_scalehight(){<span class="keywordflow">return</span> Rhight;};</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  <span class="keywordtype">float</span> get_SigmaCentral(){<span class="keywordflow">return</span> SigmaO;};</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  <span class="keywordtype">void</span> set_pa(<span class="keywordtype">double</span> p){pa = p;}</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  </div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  <span class="keywordtype">void</span> deflection(std::complex&lt;double&gt; &amp;z</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                  ,std::complex&lt;double&gt; &amp;a</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                  ,std::complex&lt;double&gt; &amp;g</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                  ,KappaType &amp;sigma) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  </div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  </div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  </div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  std::complex&lt;double&gt; dwdz(std::complex&lt;double&gt; z)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="keywordflow">return</span> 2.0*(I_sqpi - z*wF(z));</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  };</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;  </div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;  std::complex&lt;double&gt; wF(std::complex&lt;double&gt; z) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  std::complex&lt;double&gt; my_erfc(std::complex&lt;double&gt; z) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160; </div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <span class="comment">// https://arxiv.org/pdf/1407.0748.pdf</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="comment">//  std::complex&lt;double&gt; erfc(std::complex&lt;double&gt; z) const{</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="comment">//    if(z.real() &gt;= 0){</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="comment">//    std::complex&lt;double&gt; ans = wf(I*z);</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="comment">//    ans *= exp(-z*z);</span></div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="comment">//return ans;</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment">//      return exp(-z*z)*wf(I*z);</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment">//    }else{</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="comment">//      return 2. - exp(-z*z)*wf(-I*z);</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment">//  }</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  </div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;  <span class="keywordtype">double</span> Rhight;  <span class="comment">// scale hight in larges dimension</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <span class="keywordtype">double</span> q;</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;  <span class="keywordtype">double</span> q_prime;</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <span class="keywordtype">double</span> SigmaO;   <span class="comment">// SigmaO - central surface density</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <span class="keywordtype">double</span> pa;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  std::complex&lt;double&gt; R; <span class="comment">// rotation</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  </div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;  <span class="keywordtype">double</span> norm;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <span class="keywordtype">double</span> norm_g;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  <span class="keywordtype">double</span> ss;</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;  </div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;  <span class="comment">//std::complex&lt;double&gt; F(double r_e,double t,std::complex&lt;double&gt; z) const;</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  std::complex&lt;double&gt; erfi(std::complex&lt;double&gt; z)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <span class="keywordflow">return</span> I*(1. - exp(z*z)*wF(z));</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  }</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  </div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment">//  std::complex&lt;double&gt; rho(std::complex&lt;double&gt; z) const{</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment">//    //std::complex&lt;double&gt; y=(q*q*z.real() + I*z.imag())/ss/sqrt(1-q*q) ;</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment">//    //return -I * ( wF( z/ss/sqrt(q_prime) )</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment">//    //                        -  exp( y*y -z*z/ss/ss/q_prime ) * wF(y));</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">//    return wbar(z/ss/ss/sqrt(q_prime),1) - wbar(z/ss/ss/sqrt(q_prime),q);</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">//  }</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment">//  std::complex&lt;double&gt; wbar(std::complex&lt;double&gt; z, double p) const{</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment">//    double x = z.real();</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="comment">//    double y = z.imag();</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="comment">//    std::cout &lt;&lt; exp(-z*z) &lt;&lt; &quot;,&quot; &lt;&lt;</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="comment">//    exp(-x*x*(1-p*p) - y*y*(1./p/p -1)) &lt;&lt; &quot;,&quot; &lt;&lt; -I* wF(p*x + I*y/p) &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="comment">//    double tmp = exp(-x*x*(1-p*p) - y*y*(1./p/p -1));</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="comment">//    if(tmp==0) return 0;</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="comment">//    return  -(exp(-z*z)*I*tmp)*wF(p*x + I*y/p);</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="comment">//  }</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160; </div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  <span class="comment">// Faddeeva function according to Zaghloul (2017)</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <span class="comment">// It oesn&#39;t seem right near the real axis for small |z|!</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  <span class="comment">// not used</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="comment">//  std::complex&lt;double&gt; wf(std::complex&lt;double&gt; z) const{</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="comment">//    //std::cout &lt;&lt; z &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="comment">//    double y2 = z.imag()*z.imag();</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="comment">//    double z2 = std::norm(z);</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="comment">//    if( z2 &gt;= 3.8e4 ){</span></div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="comment">//      return I_sqpi / z;</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="comment">//    if(z2 &gt;= 256){</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="comment">//      //std::cout &lt;&lt; z &lt;&lt; &quot;,&quot; &lt;&lt; (z*z -0.5) &lt;&lt; &quot;,&quot; &lt;&lt; I * PI &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment">//      return z/(z*z -0.5) * I_sqpi;</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment">//    else if(z2 &gt;= 62 &amp;&amp; z2 &lt; 256){</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment">//      return (z*z - 1.) / (z * (z*z-1.5)) * I_sqpi;</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="comment">//    else if(z2 &lt; 62 &amp;&amp; z2 &gt;= 30 &amp;&amp; y2 &gt;= 1.0e-13){</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="comment">//      return z*(z*z -2.5) / (z*z*(z*z-3.) + 0.75) * I_sqpi;</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment">//    else if ( (z2 &lt; 62 &amp;&amp; z2 &gt;= 30 &amp;&amp; y2 &lt; 1.0e-13) ||  (z2 &lt; 30 &amp;&amp; z2 &gt;= 2.5 &amp;&amp; y2 &lt; 0.072) ){</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="comment">//      return exp(-z*z) + I * z * (U1[5] + z*z*(U1[4] + z*z*(U1[3] + z*z*(U1[2]+                     z*z*(U1[1] + z*z*(U1[0] + z*z*sqrt(PI) ))))))</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="comment">//      /(V1[6] + z*z*(V1[5]+ z*z*(V1[4] + z*z*(V1[3] + z*z*(V1[2] + z*z*(V1[1] + z*z*(V1[0]+z*z)))))));</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="comment">//    }</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="comment">//    return (U2[5]-I*z*(U2[4]-I*z*(U2[3]-I*z*(U2[2]-I*z*(U2[1]-I*z*(U2[0]-I*z*sqrt(PI) ))))))</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">//      /(V2[6] - I*z*(V2[5] - I*z*(V2[4] - I*z*(V2[3] - I*z*(V2[2]-I*z*(V2[1] - I*z*(V2[0] - I*z)))))));</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment">//  }</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  std::complex&lt;double&gt; I;</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  std::complex&lt;double&gt; I_sqpi;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <span class="keywordtype">double</span> one_sqpi;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="comment">//  double U1[6] = {1.320522,35.7668,219.031,1540.787,3321.990,36183.31};</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment">//  double V1[7] = {1.841439,61.57037,364.2191,2186.181,9022.228,24322.84,32066.6};</span></div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment">//  double U2[6] = {5.9126262,30.180142,93.15558,181.92853,214.38239,122.60793};</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="comment">//  double V2[7] = {10.479857,53.992907,170.35400,348.70392,457.33448,352.73063,122.60793};</span></div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;};</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160; </div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="preprocessor">#ifdef ENABLE_EIGEN</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; </div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="keyword">namespace </span>MultiGauss{</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160; </div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<span class="keyword">struct </span>PROFILE{</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> operator()(<span class="keywordtype">double</span> r) = 0;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;  <span class="keyword">virtual</span> <span class="keywordtype">double</span> cum(<span class="keywordtype">double</span> r) = 0;</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;};</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160; </div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="keyword">struct </span>POWERLAW : <span class="keyword">public</span> PROFILE</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;{</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  POWERLAW(</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;           <span class="keywordtype">float</span> g  <span class="comment">// power-law index of surfcae density</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  ){</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <span class="keywordflow">if</span>(g &lt;= -2){</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      std::cerr &lt;&lt; <span class="stringliteral">&quot;power-law index &lt;= 2 give unbounded mass!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;bad mass&quot;</span>);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    }</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    gamma = g;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;  }</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;  <span class="keywordtype">double</span> operator()(<span class="keywordtype">double</span> r){<span class="keywordflow">return</span> pow(r,gamma);}</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;  <span class="keywordtype">double</span> cum(<span class="keywordtype">double</span> r){<span class="keywordflow">return</span> 2*PI*pow(r,gamma + 2)/(gamma+2);}</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  </div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;  <span class="keywordtype">void</span> reset(<span class="keywordtype">float</span> g){gamma = g;}</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <span class="keywordtype">float</span> gamma;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;};</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160; </div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="keyword">struct </span>SERSIC : <span class="keyword">public</span> PROFILE</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;{</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  SERSIC(){reset(0,0);}</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;  SERSIC(<span class="keywordtype">float</span> nn,<span class="keywordtype">float</span> Re){</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    reset(nn,Re);</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  }</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  <span class="keywordtype">double</span> cum(<span class="keywordtype">double</span> r){</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="keywordflow">return</span> cum_norm * boost::math::tgamma_lower(2*n, bn*pow(r/re,t) );</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  }</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  <span class="keywordtype">double</span> operator()(<span class="keywordtype">double</span> r){ <span class="comment">//check that these are consistant</span></div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keywordflow">return</span> exp(-bn*pow(r/re,t) );</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;  }</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  </div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;  <span class="keywordtype">void</span> reset(<span class="keywordtype">float</span> nn,<span class="keywordtype">float</span> Re){</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;    re = Re;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    n = nn;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    bn = 1.9992*n - 0.3271;  <span class="comment">// approximation valid for 0.5 &lt; n &lt; 8</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    t = 1.0/n;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    cum_norm = 2*PI*n/pow(bn,2*n)*re*re;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;  }</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;  </div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <span class="keywordtype">float</span> t;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  <span class="keywordtype">float</span> re;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  <span class="keywordtype">float</span> n;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  <span class="keywordtype">float</span> bn;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <span class="keywordtype">float</span> cum_norm;</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;};</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160; </div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;<span class="keyword">struct </span>NFW: <span class="keyword">public</span> PROFILE</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;{</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  NFW(<span class="keywordtype">float</span> rs):rs(rs){</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  }</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;  <span class="keywordtype">double</span> cum(<span class="keywordtype">double</span> r){</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="keywordtype">double</span> x =r/rs;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    </div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="keywordtype">double</span> ans=log(x/2);</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="keywordflow">if</span>(x==1.0) ans += 1.0;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    <span class="keywordflow">if</span>(x&gt;1.0) ans += 2*atan(sqrt((x-1)/(x+1)))/sqrt(x*x-1);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    <span class="keywordflow">if</span>(x&lt;1.0) ans += 2*atanh(sqrt((1-x)/(x+1)))/sqrt(1-x*x);</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    </div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <span class="keywordflow">return</span> 2*PI*rs*rs*ans;</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  }</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <span class="keywordtype">double</span> operator()(<span class="keywordtype">double</span> r){ <span class="comment">//check that these are consistant</span></div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="keywordtype">double</span> x =r/rs;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    </div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    <span class="keywordflow">if</span>(x==1.0){<span class="keywordflow">return</span> 1.0/3.0;}</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <span class="keywordflow">if</span>(x&gt;1.0) <span class="keywordflow">return</span> (1-2*atan(sqrt((x-1)/(x+1)))/sqrt(x*x-1))/(x*x-1);</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <span class="keywordflow">return</span> (1-2*atanh(sqrt((1-x)/(x+1)))/sqrt(1-x*x))/(x*x-1);</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;  }</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;  </div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;  <span class="keywordtype">void</span> reset(<span class="keywordtype">double</span> Rs){rs = Rs;}</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;  </div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  <span class="keywordtype">float</span> rs;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;};</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;}</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160; </div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="comment">/***</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="comment">\brief  A class for constructing and approximation to any elliptical profile out of a series of elliptical gaussians.</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;<span class="comment"> The profile class must have two functions.  The  profile(r) must returns the surface density and profile.cum(r) must return the mass within the radius.  Thier units are unimportant, but they must be consistant with eachother.  Some implemented cases are MultiGauss::sersic, MultiGauss::powerlaw and MultiGauss::nfw</span></div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="comment"> The profile is fit Nradii points logarithmicly distributed between r_min and r_max using Ngaussians Gaussians in that range.</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;<span class="comment"> Typically Nradii ~ 2 * Ngaussians.</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="comment"> The mass is normalized so that mass_norm is within the elliptical distance Rnorm.  The total mass with be calculated and can be recovered after construction.</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="comment"> This class uses both the libcerf library (https://jugit.fz-juelich.de/mlz/libcerf).</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="comment"> and the eigen library.  They must be installed and linked using the cmake variable ENABLE_CERF = ON and ENABLE_EIGEN=ON</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160; </div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="keyword">class </span>LensHaloMultiGauss: <span class="keyword">public</span> <a class="code" href="class_lens_halo.html">LensHalo</a>{</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  </div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  </div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  <span class="keywordtype">int</span> nn; <span class="comment">// number of gaussians</span></div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;  <span class="keywordtype">int</span> mm; <span class="comment">// number of fit radii</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;  <span class="keywordtype">double</span> q; <span class="comment">// axis ratio</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  <span class="keywordtype">double</span> pa; <span class="comment">// position angle</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  <span class="keywordtype">double</span> mass_norm;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;  <span class="keywordtype">double</span> r_norm;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;  std::vector&lt;double&gt; sigmas;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  std::vector&lt;double&gt; radii;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;  std::complex&lt;double&gt; Rotation;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  std::vector&lt;LensHaloGaussian&gt; gaussians;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  std::vector&lt;double&gt; A;</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;  <span class="keywordtype">float</span> rms_error;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  <span class="comment">//static int count;</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160; </div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;  </div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  LensHaloMultiGauss(</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                     <span class="keywordtype">double</span> mass_norm  </div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;                     ,<span class="keywordtype">double</span> Rnorm       </div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                     ,MultiGauss::PROFILE &amp;profile  </div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                     ,<span class="keywordtype">int</span> Ngaussians    </div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                     ,<span class="keywordtype">int</span> Nradii    </div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                     ,PosType r_min</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                     ,PosType r_max</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                     ,PosType my_zlens </div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                     ,<span class="keywordtype">float</span> my_fratio </div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                     ,<span class="keywordtype">float</span> my_pa     </div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                     ,<span class="keyword">const</span> COSMOLOGY &amp;cosmo  </div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                     ,<span class="keywordtype">float</span> f=10 </div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                     ,<span class="keywordtype">bool</span> verbose = <span class="keyword">false</span></div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                     );</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  </div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  LensHaloMultiGauss(</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                     <span class="keywordtype">double</span> my_mass_norm</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                     ,<span class="keywordtype">double</span> Rnorm</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                     ,<span class="keywordtype">double</span> my_scale   <span class="comment">// radial scale in units of the scale that was used to produce relative_scales</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;                     ,<span class="keyword">const</span> std::vector&lt;double&gt; &amp;relative_scales</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;                     ,<span class="keyword">const</span> std::vector&lt;double&gt; &amp;relative_masses</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;                     ,PosType my_zlens </div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                     ,<span class="keywordtype">float</span> my_fratio </div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;                     ,<span class="keywordtype">float</span> my_pa     </div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;                     ,<span class="keyword">const</span> COSMOLOGY &amp;cosmo  </div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                     ,<span class="keywordtype">float</span> f=100 </div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                     ,<span class="keywordtype">bool</span> verbose = <span class="keyword">false</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                     );</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;  </div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;  </div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160; </div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;  LensHaloMultiGauss(LensHaloMultiGauss &amp;&amp;halo);</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  LensHaloMultiGauss(<span class="keyword">const</span> LensHaloMultiGauss &amp;halo);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160; </div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  LensHaloMultiGauss &amp; <a class="code" href="class_lens_halo.html#aaa135c7e56a24de4a1dee76604a44141">operator=</a>(<span class="keyword">const</span> LensHaloMultiGauss &amp;&amp;halo);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  LensHaloMultiGauss &amp; <a class="code" href="class_lens_halo.html#aaa135c7e56a24de4a1dee76604a44141">operator=</a>(<span class="keyword">const</span> LensHaloMultiGauss &amp;halo);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  </div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  ~LensHaloMultiGauss(){};<span class="comment">//--LensHaloMultiGauss::count;}</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;  </div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  <span class="keywordtype">void</span> set_pa(<span class="keywordtype">double</span> my_pa);</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;  </div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="comment">  /***</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="comment">    This is a static function that can be used to find the masses and scales for the gaussians which can</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="comment">   then be fed into the scond constructor with a rescaling.  This avoids having to recalculate them when the same profile is used multiple times.</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;<span class="comment">   </span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="comment">   For example, an NFW can be calculated here with a scale size 1 and an arbitrary mass.  Then it can be used in the constructor with different scale sizes and masses.</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="comment">   </span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="comment">   &lt;p&gt;</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="comment">   MultiGauss::sersic profile(1,1);</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="comment">   double mass_out;</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="comment">   float rms_error;</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="comment">   std::vector&lt;double&gt; scales,masses;</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="comment">   LensHaloMultiGauss::calc_masses_scales(profile, 13, 25, 0.01,3,0.5,1,mass_out,scales,masses,rms_error);</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="comment">   LensHaloMultiGauss halo1(mass,rscale,scales,masses,zl,q,-pa,cosmo);</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="comment">   LensHaloMultiGauss halo2(mass/2,0.1*rscale,scales,masses,zl2,q2,-pa2,cosmo);</span></div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<span class="comment">   &lt;\p&gt;</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  </div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> calc_masses_scales(MultiGauss::PROFILE &amp;profile  </div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;                                 ,<span class="keywordtype">int</span> Ngaussians    </div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;                                 ,<span class="keywordtype">int</span> Nradii    </div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;                                 ,PosType r_min</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;                                 ,PosType r_max</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;                                 ,<span class="keywordtype">double</span> mass_norm</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;                                 ,<span class="keywordtype">double</span> r_norm</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;                                 ,<span class="keywordtype">double</span> &amp;totalmass_out</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;                                 ,std::vector&lt;double&gt; &amp;scales</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;                                 ,std::vector&lt;double&gt; &amp;masses</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;                                 ,<span class="keywordtype">float</span> &amp;rms_error</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                                 ,<span class="keywordtype">bool</span> verbose=<span class="keyword">false</span></div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;                                 ){</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <span class="comment">// make logorithmic</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    scales.resize(Ngaussians);</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    {</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;      <span class="keywordtype">double</span> tmp = pow(r_max/r_min,1.0/(Ngaussians-2));</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;      scales[0] = r_min/5;</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;      scales[1] = r_min;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=2 ; i &lt; Ngaussians ; ++i){</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        scales[i] = tmp*scales[i-1];</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      }</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    }</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    </div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    std::vector&lt;double&gt; radii(Nradii);</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;    {</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;      <span class="keywordtype">double</span> tmp = pow(r_max/r_min,1.0/(Nradii-1));</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;      radii[0] = r_min;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=1 ; i &lt; Nradii ; ++i){</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;        radii[i] = tmp*radii[i-1];</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      }</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    }</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    </div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    Eigen::MatrixXd M(Nradii,Ngaussians);</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    </div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="comment">// first radius is fit to mass within radius</span></div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    {</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;      <span class="keywordtype">double</span> cp = profile.cum(radii[0]);</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0 ; n &lt; Ngaussians ; ++n){</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;        M(0,n) = 2*PI*scales[n] * scales[n]</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;        * ( 1 -exp(-radii[0]*radii[0] / 2 / scales[n] /scales[n]) )</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;        / cp ;</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;      }</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    }</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    </div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="comment">// all others are fit to relative density</span></div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m=1 ; m &lt; Nradii ; ++m){</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;      <span class="keywordtype">double</span> p = profile(radii[m]);</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0 ; n &lt; Ngaussians ; ++n){</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        M(m,n) = exp( - radii[m]*radii[m] / 2 / scales[n] /scales[n])</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        / p ;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;      }</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    }</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    </div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    <span class="comment">// invert M</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    </div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    masses.resize(Ngaussians);</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    {</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      std::vector&lt;double&gt; b(Nradii,1);</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;      Eigen::Map&lt;Eigen::VectorXd&gt; v(b.data(),Nradii);</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;      Eigen::Map&lt;Eigen::VectorXd&gt; a(masses.data(),Ngaussians);</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;      </div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;      <span class="comment">//M = M.inverse();</span></div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;      a = M.bdcSvd(Eigen::ComputeThinU | Eigen::ComputeThinV).solve(v);</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;      </div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;      <span class="keywordflow">if</span>(verbose) std::cout &lt;&lt; <span class="stringliteral">&quot;test in LensHaloMultiGauss::calc_masses_scales()&quot;</span> &lt;&lt; std::endl &lt;&lt; M*a &lt;&lt; std::endl;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    }</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    </div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    <span class="comment">// tests</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    {</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;      rms_error=0;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m=0 ; m &lt; 1 ; ++m){</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        <span class="keywordtype">double</span> surf=0;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0 ; n &lt; Ngaussians ; ++n){</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;          surf += masses[n] * scales[n] * scales[n]</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;          * 2*PI*( 1 - exp(-radii[m]*radii[m] / 2 / scales[n] /scales[n]) );</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;        }</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;        <span class="keywordtype">double</span> tmp = profile.cum(radii[m]);</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        <span class="keywordflow">if</span>(verbose) std::cout &lt;&lt; tmp &lt;&lt; <span class="stringliteral">&quot; &quot;</span>  &lt;&lt; surf &lt;&lt; std::endl;</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;        </div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        rms_error += (surf - tmp )*(surf - tmp) / tmp / tmp;</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;      }</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;      </div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> m=1 ; m &lt; Nradii ; ++m){</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        <span class="keywordtype">double</span> surf=0;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0 ; n &lt; Ngaussians ; ++n){</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;          surf += masses[n] * exp(-radii[m]*radii[m] / 2 / scales[n] /scales[n]) ;</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;        }</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        <span class="keywordtype">double</span> tmp = profile(radii[m]);</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;        <span class="keywordflow">if</span>(verbose) std::cout &lt;&lt; tmp &lt;&lt; <span class="stringliteral">&quot; &quot;</span>  &lt;&lt; surf &lt;&lt; std::endl;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;        </div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;        rms_error += (surf - tmp )*(surf - tmp ) / tmp /tmp;</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;      }</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;      rms_error = sqrt(rms_error)/Ngaussians;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;      <span class="keywordflow">if</span>(verbose) std::cout &lt;&lt; <span class="stringliteral">&quot; MSE error &quot;</span> &lt;&lt; rms_error &lt;&lt; std::endl;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    }</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    </div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="comment">// find masses of Gaussian components</span></div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;   {</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;      <span class="keywordtype">double</span> mass_tmp = 0;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0 ; n&lt;Ngaussians ; ++n){</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        mass_tmp += scales[n]*scales[n]*masses[n]</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        *( 1 - exp(-r_norm*r_norm / 2 / scales[n] /scales[n]) );</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      }</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      </div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      {  <span class="comment">// convert to mass units of each component</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;        <span class="keywordtype">double</span> tmp = (mass_norm/mass_tmp);</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;        <span class="comment">// rescale so total mass is correct</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0 ; n&lt;Ngaussians ; ++n) masses[n] *= tmp*scales[n]*scales[n];</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      }</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;     </div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;   }</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    totalmass_out = 0;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> n=0 ; n&lt;Ngaussians ; ++n) totalmass_out += masses[n];</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;  }</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;  </div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;  <span class="keywordtype">double</span> profile(<span class="keywordtype">double</span> r);</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  </div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;  <span class="keywordtype">double</span> mass_cum(<span class="keywordtype">double</span> r);</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  </div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;  <span class="keywordtype">float</span> error();</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;  </div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a460de105e52520a328d5912455c02fdd">force_halo</a>(PosType *alpha,KappaType *kappa,KappaType *gamma,KappaType *phi,PosType <span class="keyword">const</span> *xcm,<span class="keywordtype">bool</span> subtract_point=<span class="keyword">false</span>,PosType screening = 1);</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;  </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160; </div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;};</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160; </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="preprocessor">#endif // eigen</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="preprocessor">#endif // libcerf</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160; </div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;<span class="comment"> * \brief A class for calculating the deflection, kappa and gamma caused by a halos</span></div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="comment"> * with truncated Hernquist mass profiles.</span></div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="comment"> * The profile is \f$ \rho \propto \left( \frac{r}{r_s} \right)^{-1} \left( 1 + \frac{r}{r_s} \right)^{-3} \f$.</span></div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160; </div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;<span class="keyword">class </span>LensHaloHernquist: <span class="keyword">public</span> <a class="code" href="class_lens_halo.html">LensHalo</a>{</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160; <span class="comment">//LensHaloHernquist();</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;  LensHaloHernquist(<span class="keywordtype">float</span> my_mass,<span class="keywordtype">float</span> my_Rsize,PosType my_zlens,<span class="keywordtype">float</span> my_rscale,<span class="keywordtype">float</span> my_fratio,<span class="keywordtype">float</span> my_pa,<span class="keyword">const</span> COSMOLOGY &amp;cosmo, <a class="code" href="_input_params_8h.html#abeeb8c8413457c56ac46767a52fc2618">EllipMethod</a> my_ellip_method=EllipMethod::Pseudo);</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160; <span class="comment">//LensHaloHernquist(InputParams&amp; params);</span></div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160; <span class="keyword">virtual</span> ~LensHaloHernquist();</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;  </div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;  PosType ffunction(PosType x) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160; PosType gfunction(PosType x) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160; PosType hfunction(PosType x) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160; PosType g2function(PosType x) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  </div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160; <span class="comment">/* the below functions alphaHern, kappaHern and gammaHern are obsolete and better to be deleted to avoid confusion</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="comment">   void alphaHern(PosType *alpha,PosType *x,PosType Rtrunc,PosType mass,PosType r_scale</span></div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;<span class="comment">   ,PosType *center,PosType Sigma_crit);</span></div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;<span class="comment">   KappaType kappaHern(PosType *x,PosType Rtrunc,PosType mass,PosType r_scale</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="comment">   ,PosType *center,PosType Sigma_crit);</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="comment">   void gammaHern(KappaType *gamma,PosType *x,PosType Rtrunc,PosType mass,PosType r_scale</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="comment">   ,PosType *center,PosType Sigma_crit);</span></div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160; <span class="comment">//void initFromFile(float my_mass, long *seed, float vmax, float r_halfmass);</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  </div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a68e3f2ba68f2d93202985fb317cf0a14">set_rscale</a>(<span class="keywordtype">float</span> my_rscale){rscale=my_rscale; xmax = <a class="code" href="class_lens_halo.html#a2616defcc052fd9ab1e568cfd8a5c9a9">LensHalo::getRsize</a>()/<a class="code" href="class_lens_halo.html#ad0138e93c3a165ae25cd42bea42c4c4b">rscale</a>; gmax = InterpolateFromTable(gtable,xmax);};</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;  <span class="comment">// friend struct Ialpha_func;</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;  </div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160; <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">long</span> NTABLE;</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160; <span class="keyword">static</span> <span class="keyword">const</span> PosType maxrm;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160; <span class="keyword">static</span> <span class="keywordtype">int</span> count;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;  </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160; <span class="keyword">static</span> PosType *ftable,*gtable,*g2table,*htable,*xtable,*xgtable;</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160; <span class="keywordtype">void</span> make_tables();</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160; PosType InterpolateFromTable(PosType *table, PosType y) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;  </div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a187b1e7e055d69419bf214ebf588af6d">assignParams</a>(<a class="code" href="class_input_params.html">InputParams</a>&amp; params);</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;  </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160; <span class="comment">// Override internal structure of halos</span></div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="comment"></span> <span class="keyword">inline</span> PosType <a class="code" href="class_lens_halo.html#a9295b7b1d0a66b3742a81ead5bf2a863">alpha_h</a>(PosType x)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;  <span class="keywordflow">return</span> -0.25*InterpolateFromTable(gtable,x)/gmax;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160; }</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160; <span class="keyword">inline</span> KappaType kappa_h(PosType x)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;  <span class="keywordflow">return</span> 0.25*x*x*InterpolateFromTable(ftable,x)/gmax; <span class="comment">// 0.5*</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160; }</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160; <span class="keyword">inline</span> KappaType gamma_h(PosType x)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;  <span class="keywordflow">return</span> -0.5*x*x*InterpolateFromTable(g2table,x)/gmax;</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160; }</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160; <span class="keyword">inline</span> KappaType phi_h(PosType x)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  <span class="keywordflow">return</span> -0.25*InterpolateFromTable(htable,x)/gmax;</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;  <span class="comment">//return -1.0*InterpolateFromTable(htable,x)/gmax;</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160; }</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="keyword">inline</span> KappaType phi_int(PosType x)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;  <span class="keywordflow">return</span> -0.25*InterpolateFromTable(xgtable,x)/gmax;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;  }</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  </div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;  </div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;  PosType gmax;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;};</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160; </div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="comment"> * \brief A class for calculating the deflection, kappa and gamma caused by a collection of halos</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="comment"> * with truncated Jaffe mass profiles.</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;<span class="comment"> * The profile is \f$ \rho \propto \left( \frac{r}{r_s} \right)^{-2} \left( 1 + \frac{r}{r_s} \right)^{-2} \f$ so beta would usually be negative.</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160; </div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;<span class="keyword">class </span>LensHaloJaffe: <span class="keyword">public</span> <a class="code" href="class_lens_halo.html">LensHalo</a>{</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160; <span class="comment">//LensHaloJaffe();</span></div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  LensHaloJaffe(<span class="keywordtype">float</span> my_mass,<span class="keywordtype">float</span> my_Rsize,PosType my_zlens,<span class="keywordtype">float</span> my_rscale,<span class="keywordtype">float</span> my_fratio</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                ,<span class="keywordtype">float</span> my_pa,<span class="keyword">const</span> COSMOLOGY &amp;cosmo</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                , <a class="code" href="_input_params_8h.html#abeeb8c8413457c56ac46767a52fc2618">EllipMethod</a> my_ellip_method=EllipMethod::Pseudo);</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160; <span class="comment">//LensHaloJaffe(InputParams&amp; params);</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160; <span class="keyword">virtual</span> ~LensHaloJaffe();</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  </div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a68e3f2ba68f2d93202985fb317cf0a14">set_rscale</a>(<span class="keywordtype">float</span> my_rscale){rscale=my_rscale; xmax = <a class="code" href="class_lens_halo.html#a2616defcc052fd9ab1e568cfd8a5c9a9">LensHalo::getRsize</a>()/<a class="code" href="class_lens_halo.html#ad0138e93c3a165ae25cd42bea42c4c4b">rscale</a>; gmax = InterpolateFromTable(gtable,xmax);};</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;  </div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  PosType ffunction(PosType x) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160; PosType gfunction(PosType x) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160; PosType hfunction(PosType x) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160; PosType g2function(PosType x) <span class="keyword">const</span>;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;  PosType bfunction(PosType x);</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;  PosType dbfunction(PosType x);</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;  PosType ddbfunction(PosType x);</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;  </div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="keyword">protected</span>:</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;  </div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160; <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">long</span> NTABLE;</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160; <span class="keyword">static</span> <span class="keyword">const</span> PosType maxrm;</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160; <span class="keyword">static</span> <span class="keywordtype">int</span> count;</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;  </div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160; <span class="keyword">static</span> PosType *ftable,*gtable,*g2table,*htable,*xtable,*xgtable;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160; <span class="keywordtype">void</span> make_tables();</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160; PosType InterpolateFromTable(PosType *table, PosType y) <span class="keyword">const</span>;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;  </div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo.html#a187b1e7e055d69419bf214ebf588af6d">assignParams</a>(<a class="code" href="class_input_params.html">InputParams</a>&amp; params);</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  </div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160; <span class="comment">// Override internal structure of halos</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;<span class="comment"></span> <span class="keyword">inline</span> PosType <a class="code" href="class_lens_halo.html#a9295b7b1d0a66b3742a81ead5bf2a863">alpha_h</a>(PosType x)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  <span class="keywordflow">return</span> -0.25*InterpolateFromTable(gtable,x)/gmax;</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160; }</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160; <span class="keyword">inline</span> KappaType kappa_h(PosType x)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  <span class="keywordflow">return</span> 0.125*x*x*InterpolateFromTable(ftable,x)/gmax;</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160; }</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160; <span class="keyword">inline</span> KappaType gamma_h(PosType x)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;  <span class="comment">//return -0.125*x*x*InterpolateFromTable(g2table,x)/gmax;</span></div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  <span class="keywordflow">return</span> -0.25*x*x*InterpolateFromTable(g2table,x)/gmax;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160; }</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160; <span class="keyword">inline</span> KappaType phi_h(PosType x)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;        <span class="keywordflow">return</span> -0.25*InterpolateFromTable(xgtable,x)/gmax;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;    }</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="keyword">inline</span> KappaType phi_int(PosType x)<span class="keyword"> const</span>{</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  <span class="keywordflow">return</span> -0.25*InterpolateFromTable(xgtable,x)/gmax;</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  }</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  </div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;  PosType gmax;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  </div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  <span class="comment">// I have temporarily set these functions to 0 to make the code compile, Ben</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;  <span class="comment">//  PosType ffunction(PosType x){throw std::runtime_error(&quot;Set to temporary invalid value&quot;); return 0;}</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;  <span class="comment">// PosType gfunction(PosType x){throw std::runtime_error(&quot;Set to temporary invalid value&quot;); return 0;}</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;  <span class="comment">// PosType hfunction(PosType x){throw std::runtime_error(&quot;Set to temporary invalid value&quot;); return 0;}</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;  <span class="comment">// PosType g2function(PosType x){throw std::runtime_error(&quot;Set to temporary invalid value&quot;); return 0;}</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;  </div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;};</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160; </div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160; </div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160; </div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160; </div>
<div class="line"><a name="l02051"></a><span class="lineno"><a class="line" href="class_lens_halo_dummy.html"> 2051</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_lens_halo_dummy.html">LensHaloDummy</a>: <span class="keyword">public</span> <a class="code" href="class_lens_halo.html">LensHalo</a>{</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160; <a class="code" href="class_lens_halo_dummy.html">LensHaloDummy</a>();</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  <a class="code" href="class_lens_halo_dummy.html">LensHaloDummy</a>(<span class="keywordtype">float</span> my_mass,<span class="keywordtype">float</span> my_Rsize,PosType my_zlens,<span class="keywordtype">float</span> my_rscale,<span class="keyword">const</span> COSMOLOGY &amp;cosmo);</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160; <span class="comment">//LensHaloDummy(InputParams&amp; params);</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160; ~<a class="code" href="class_lens_halo_dummy.html">LensHaloDummy</a>(){};</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160; </div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_dummy.html#a97a4d4969529502dd956a03c7da6d5ee">force_halo</a>(PosType *alpha,KappaType *kappa,KappaType *gamma,KappaType *phi,PosType <span class="keyword">const</span> *xcm,<span class="keywordtype">bool</span> subtract_point=<span class="keyword">false</span>,PosType screening = 1.0);</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;  <span class="comment">// void force_halo(PosType *alpha,KappaType *kappa,KappaType *gamma,PosType *xcm,bool subtract_point=false,PosType screening = 1.0);</span></div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;  </div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160; <span class="keywordtype">void</span> <a class="code" href="class_lens_halo_dummy.html#ae775b683ce68dec913a90116f19cf471">initFromMassFunc</a>(<span class="keywordtype">float</span> my_mass, <span class="keywordtype">float</span> my_Rsize, <span class="keywordtype">float</span> my_rscale, PosType my_slope, <span class="keywordtype">long</span> *seed);</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;  </div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160; </div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160; <span class="keywordtype">void</span> assignParams(<a class="code" href="class_input_params.html">InputParams</a>&amp; params);</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160; <span class="keyword">inline</span> PosType alpha_h(PosType x)<span class="keyword"> const </span>{<span class="keywordflow">return</span>  0.;}</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160; <span class="keyword">inline</span> KappaType kappa_h(PosType x)<span class="keyword"> const </span>{<span class="keywordflow">return</span>  0.;}</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160; <span class="keyword">inline</span> KappaType gamma_h(PosType x)<span class="keyword"> const </span>{<span class="keywordflow">return</span>  0.;}</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;};</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160; </div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160; </div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="keyword">typedef</span> <a class="code" href="class_lens_halo.html">LensHalo</a>* <a class="code" href="class_lens_halo.html">LensHaloHndl</a>;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160; </div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;<span class="comment">//bool LensHaloZcompare(LensHalo *lh1,LensHalo *lh2);//{return (lh1-&gt;getZlens() &lt; lh2-&gt;getZlens());}</span></div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="comment">//bool LensHaloZcompare(LensHalo lh1,LensHalo lh2){return (lh1.getZlens() &lt; lh2.getZlens());}</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; </div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* LENS_HALOS_H_ */</span><span class="preprocessor"></span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclass_lens_halo_t_n_s_i_e_html_a21702bde8394612b37e7f8b4d87086d7"><div class="ttname"><a href="class_lens_halo_t_n_s_i_e.html#a21702bde8394612b37e7f8b4d87086d7">LensHaloTNSIE::force_halo</a></div><div class="ttdeci">void force_halo(PosType *alpha, KappaType *kappa, KappaType *gamma, KappaType *phi, PosType const *xcm, bool subtract_point=false, PosType screening=1.0)</div><div class="ttdoc">overridden function to calculate the lensing properties</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:952</div></div>
<div class="ttc" id="aclass_lens_halo_real_n_s_i_e_html_aeb41845d0867785f69d47dd61c044c0f"><div class="ttname"><a href="class_lens_halo_real_n_s_i_e.html#aeb41845d0867785f69d47dd61c044c0f">LensHaloRealNSIE::get_fratio</a></div><div class="ttdeci">float get_fratio()</div><div class="ttdoc">get the axis ratio</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1065</div></div>
<div class="ttc" id="aclass_lens_halo_html_aaa135c7e56a24de4a1dee76604a44141"><div class="ttname"><a href="class_lens_halo.html#aaa135c7e56a24de4a1dee76604a44141">LensHalo::operator=</a></div><div class="ttdeci">LensHalo &amp; operator=(const LensHalo &amp;h)</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:169</div></div>
<div class="ttc" id="aclass_lens_halo_html_accfed225ceb5c6684ac983ae89adfebd"><div class="ttname"><a href="class_lens_halo.html#accfed225ceb5c6684ac983ae89adfebd">LensHalo::test_average_gt</a></div><div class="ttdeci">PosType test_average_gt(PosType R)</div><div class="ttdoc">calculates the average gamma_t for LensHalo::test()</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:2476</div></div>
<div class="ttc" id="aclass_lens_halo_html_ac3f16aeffae590925d115799698ebaf4"><div class="ttname"><a href="class_lens_halo.html#ac3f16aeffae590925d115799698ebaf4">LensHalo::kappa_asym</a></div><div class="ttdeci">virtual PosType kappa_asym(PosType x, PosType theta)</div><div class="ttdef"><b>Definition:</b> base_analens.cpp:1035</div></div>
<div class="ttc" id="aclass_lens_halo_t_n_s_i_e_html_ae1647b315335acfded0e4559af0e41e5"><div class="ttname"><a href="class_lens_halo_t_n_s_i_e.html#ae1647b315335acfded0e4559af0e41e5">LensHaloTNSIE::LensHaloTNSIE</a></div><div class="ttdeci">LensHaloTNSIE(float my_mass, PosType my_zlens, float my_sigma, float my_rcore, float my_fratio, float my_pa, const COSMOLOGY &amp;cosmo, float f=20)</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:927</div></div>
<div class="ttc" id="aclass_lens_halo_real_n_s_i_e_html_a3459fe0ce3588c7a52a4d1c37a9e7f55"><div class="ttname"><a href="class_lens_halo_real_n_s_i_e.html#a3459fe0ce3588c7a52a4d1c37a9e7f55">LensHaloRealNSIE::rcore</a></div><div class="ttdeci">float rcore</div><div class="ttdoc">core size of NSIE</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1112</div></div>
<div class="ttc" id="aclass_lens_halo_t_n_s_i_e_html_a1a281b8ccbeec2d19d2eb16b2a8c6a5c"><div class="ttname"><a href="class_lens_halo_t_n_s_i_e.html#a1a281b8ccbeec2d19d2eb16b2a8c6a5c">LensHaloTNSIE::rcore</a></div><div class="ttdeci">float rcore</div><div class="ttdoc">core size of NSIE</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1214</div></div>
<div class="ttc" id="aclass_lens_halo_real_n_s_i_e_html_a3e5b1c58a0e49787473551bf3ee2d893"><div class="ttname"><a href="class_lens_halo_real_n_s_i_e.html#a3e5b1c58a0e49787473551bf3ee2d893">LensHaloRealNSIE::sigma</a></div><div class="ttdeci">float sigma</div><div class="ttdoc">velocity dispersion of NSIE</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1106</div></div>
<div class="ttc" id="aclass_lens_halo_html_a81b1a30f1fe716a34799469554693f6e"><div class="ttname"><a href="class_lens_halo.html#a81b1a30f1fe716a34799469554693f6e">LensHalo::map_variables</a></div><div class="ttdeci">PixelMap map_variables(LensingVariable lensvar, size_t Nx, size_t Ny, double res)</div><div class="ttdoc">Map a PixelMap of the surface, density, potential and potential gradient centred on (0,...</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:269</div></div>
<div class="ttc" id="aclass_lens_halo_html_a5f7d67a341a08313a8920a1b8bd3d8bf"><div class="ttname"><a href="class_lens_halo.html#a5f7d67a341a08313a8920a1b8bd3d8bf">LensHalo::get_mass</a></div><div class="ttdeci">float get_mass() const</div><div class="ttdoc">get the mass solar units</div><div class="ttdef"><b>Definition:</b> lens_halos.h:83</div></div>
<div class="ttc" id="aclass_lens_halo_t_n_s_i_e_html_a66e3c61b00069ddefc20440bdda88bbc"><div class="ttname"><a href="class_lens_halo_t_n_s_i_e.html#a66e3c61b00069ddefc20440bdda88bbc">LensHaloTNSIE::set_pa</a></div><div class="ttdeci">void set_pa(float my_pa)</div><div class="ttdoc">set the position angle</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1199</div></div>
<div class="ttc" id="aclass_lens_halo_real_n_s_i_e_html_a277e6c93788c290fcf7c9bbbd32b0ce6"><div class="ttname"><a href="class_lens_halo_real_n_s_i_e.html#a277e6c93788c290fcf7c9bbbd32b0ce6">LensHaloRealNSIE::rmax_calc</a></div><div class="ttdeci">PosType rmax_calc()</div><div class="ttdoc">for the set fratio, sigma and rcore calculate the radius that contains the correct mass</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:1154</div></div>
<div class="ttc" id="aclass_lens_halo_html_a460de105e52520a328d5912455c02fdd"><div class="ttname"><a href="class_lens_halo.html#a460de105e52520a328d5912455c02fdd">LensHalo::force_halo</a></div><div class="ttdeci">virtual void force_halo(PosType *alpha, KappaType *kappa, KappaType *gamma, KappaType *phi, PosType const *xcm, bool subtract_point=false, PosType screening=1.0)</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:1528</div></div>
<div class="ttc" id="aclass_lens_halo_html_a3c28739f7088e24bda7d67b14f50d4ba"><div class="ttname"><a href="class_lens_halo.html#a3c28739f7088e24bda7d67b14f50d4ba">LensHalo::setZlens</a></div><div class="ttdeci">void setZlens(PosType my_zlens, const COSMOLOGY &amp;cosmo)</div><div class="ttdoc">set redshift</div><div class="ttdef"><b>Definition:</b> lens_halos.h:137</div></div>
<div class="ttc" id="aclass_lens_halo_t_n_s_i_e_html_aba3b57e5f20418bfbc92ffcf0053baf1"><div class="ttname"><a href="class_lens_halo_t_n_s_i_e.html#aba3b57e5f20418bfbc92ffcf0053baf1">LensHaloTNSIE::sigma</a></div><div class="ttdeci">float sigma</div><div class="ttdoc">velocity dispersion of TNSIE</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1208</div></div>
<div class="ttc" id="aclass_lens_halo_n_f_w_html_ad38e1cd1d96550571ec6c5ff104c4ba0"><div class="ttname"><a href="class_lens_halo_n_f_w.html#ad38e1cd1d96550571ec6c5ff104c4ba0">LensHaloNFW::dmoddb</a></div><div class="ttdeci">PosType dmoddb(int whichmod, PosType q, PosType b)</div><div class="ttdoc">dbfunction and ddbfunction are approximation formulae for dbeta/dr and d^2beta/dr^2 whereas dbnum and...</div><div class="ttdef"><b>Definition:</b> nfw_lens.cpp:205</div></div>
<div class="ttc" id="aclass_lens_halo_real_n_s_i_e_html_a6740f067c19676e37d7cf85ae695eefb"><div class="ttname"><a href="class_lens_halo_real_n_s_i_e.html#a6740f067c19676e37d7cf85ae695eefb">LensHaloRealNSIE::LensHaloRealNSIE</a></div><div class="ttdeci">LensHaloRealNSIE(float my_mass, PosType my_zlens, float my_sigma, float my_rcore, float my_fratio, float my_pa, const COSMOLOGY &amp;cosmo)</div><div class="ttdoc">explicit constructor, Warning: If my_rcore &gt; 0.0 and my_fratio &lt; 1 then the mass will be somewhat les...</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:1043</div></div>
<div class="ttc" id="aclass_lens_halo_n_f_w_html_a9c8f2ee5db692fb17dc4a2bda2c06b04"><div class="ttname"><a href="class_lens_halo_n_f_w.html#a9c8f2ee5db692fb17dc4a2bda2c06b04">LensHaloNFW::LensHaloNFW</a></div><div class="ttdeci">LensHaloNFW()</div><div class="ttdoc">Shell constructor. Sets the halo to zero mass.</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:365</div></div>
<div class="ttc" id="aclass_lens_halo_html_a6aee0c9abc88ca6d3d8ed9e44a18e6e3"><div class="ttname"><a href="class_lens_halo.html#a6aee0c9abc88ca6d3d8ed9e44a18e6e3">LensHalo::get_Rmax</a></div><div class="ttdeci">float get_Rmax() const</div><div class="ttdoc">this can be used to tag types of LensHalos</div><div class="ttdef"><b>Definition:</b> lens_halos.h:79</div></div>
<div class="ttc" id="a_input_params_8h_html_abeeb8c8413457c56ac46767a52fc2618"><div class="ttname"><a href="_input_params_8h.html#abeeb8c8413457c56ac46767a52fc2618">EllipMethod</a></div><div class="ttdeci">EllipMethod</div><div class="ttdoc">Methods to make a previously isotropic halo elliptical.</div><div class="ttdef"><b>Definition:</b> InputParams.h:86</div></div>
<div class="ttc" id="aclass_lens_halo_html_a37bed2edc60ce4932c7fc854fe972f01"><div class="ttname"><a href="class_lens_halo.html#a37bed2edc60ce4932c7fc854fe972f01">LensHalo::get_Nmod</a></div><div class="ttdeci">static const int get_Nmod()</div><div class="ttdoc">get length of mod array, which is Nmod. Not to be confused with getNmodes in the class LensHaloFit</div><div class="ttdef"><b>Definition:</b> lens_halos.h:215</div></div>
<div class="ttc" id="aclass_lens_halo_n_f_w_html_ad87d0e7560bc11e218a04b46afafbe7d"><div class="ttname"><a href="class_lens_halo_n_f_w.html#ad87d0e7560bc11e218a04b46afafbe7d">LensHaloNFW::assignParams</a></div><div class="ttdeci">void assignParams(InputParams &amp;params)</div><div class="ttdoc">read in parameters from a parameterfile in InputParams params</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:583</div></div>
<div class="ttc" id="aclass_lens_halo_n_f_w_html_a9319e4578436ec403e936df7dfded030"><div class="ttname"><a href="class_lens_halo_n_f_w.html#a9319e4578436ec403e936df7dfded030">LensHaloNFW::kappaNFW</a></div><div class="ttdeci">KappaType kappaNFW(PosType *x, PosType Rtrunc, PosType mass, PosType r_scale, PosType *center, PosType Sigma_crit)</div><div class="ttdoc">Convergence for an NFW halo.</div><div class="ttdef"><b>Definition:</b> nfw_lens.cpp:36</div></div>
<div class="ttc" id="aclass_lens_halo_t_e_p_l_html_a3f38a1045bb28545ed29d04d9e517914"><div class="ttname"><a href="class_lens_halo_t_e_p_l.html#a3f38a1045bb28545ed29d04d9e517914">LensHaloTEPL::get_rtrunc</a></div><div class="ttdeci">float get_rtrunc()</div><div class="ttdoc">get the truncation radius</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1277</div></div>
<div class="ttc" id="aclass_lens_halo_real_n_s_i_e_html_a819bd516935f96820fe43e5b27d6fec5"><div class="ttname"><a href="class_lens_halo_real_n_s_i_e.html#a819bd516935f96820fe43e5b27d6fec5">LensHaloRealNSIE::force_halo</a></div><div class="ttdeci">void force_halo(PosType *alpha, KappaType *kappa, KappaType *gamma, KappaType *phi, PosType const *xcm, bool subtract_point=false, PosType screening=1.0)</div><div class="ttdoc">overridden function to calculate the lensing properties</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:1938</div></div>
<div class="ttc" id="aclass_lens_halo_dummy_html_a97a4d4969529502dd956a03c7da6d5ee"><div class="ttname"><a href="class_lens_halo_dummy.html#a97a4d4969529502dd956a03c7da6d5ee">LensHaloDummy::force_halo</a></div><div class="ttdeci">void force_halo(PosType *alpha, KappaType *kappa, KappaType *gamma, KappaType *phi, PosType const *xcm, bool subtract_point=false, PosType screening=1.0)</div><div class="ttdoc">overridden function to calculate the lensing properties</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:2390</div></div>
<div class="ttc" id="aclass_lens_halo_html_a374d199861689b8186c04d29bf92d6a2"><div class="ttname"><a href="class_lens_halo.html#a374d199861689b8186c04d29bf92d6a2">LensHalo::force_halo_sym</a></div><div class="ttdeci">void force_halo_sym(PosType *alpha, KappaType *kappa, KappaType *gamma, KappaType *phi, PosType const *xcm, bool subtract_point=false, PosType screening=1.0)</div><div class="ttdoc">returns the lensing quantities of a ray in center of mass coordinates for a symmetric halo</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:1608</div></div>
<div class="ttc" id="aclass_lens_halo_html_a43de5eba625d4c78e85e2fdb8bbeaa0e"><div class="ttname"><a href="class_lens_halo.html#a43de5eba625d4c78e85e2fdb8bbeaa0e">LensHalo::mass_norm_factor</a></div><div class="ttdeci">PosType mass_norm_factor</div><div class="ttdoc">This is Rsize/rscale !!</div><div class="ttdef"><b>Definition:</b> lens_halos.h:399</div></div>
<div class="ttc" id="aclass_lens_halo_dummy_html_ae775b683ce68dec913a90116f19cf471"><div class="ttname"><a href="class_lens_halo_dummy.html#ae775b683ce68dec913a90116f19cf471">LensHaloDummy::initFromMassFunc</a></div><div class="ttdeci">void initFromMassFunc(float my_mass, float my_Rsize, float my_rscale, PosType my_slope, long *seed)</div><div class="ttdoc">initialize from a mass function</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:2380</div></div>
<div class="ttc" id="aclass_lens_halo_n_f_w_html_af8e6d1a537c488ed2cabfb9bb6feaa80"><div class="ttname"><a href="class_lens_halo_n_f_w.html#af8e6d1a537c488ed2cabfb9bb6feaa80">LensHaloNFW::count</a></div><div class="ttdeci">static int count</div><div class="ttdoc">keeps track of how many time the tables are created, default is just once</div><div class="ttdef"><b>Definition:</b> lens_halos.h:827</div></div>
<div class="ttc" id="aclass_lens_halo_html_a9abe01ec8275570e899e3675da663981"><div class="ttname"><a href="class_lens_halo.html#a9abe01ec8275570e899e3675da663981">LensHalo::setTheta</a></div><div class="ttdeci">void setTheta(const Point_2d &amp;p)</div><div class="ttdoc">set the position of the Halo in radians</div><div class="ttdef"><b>Definition:</b> lens_halos.h:109</div></div>
<div class="ttc" id="aclass_lens_halo_html_a122a8066d3746da81768627a19aaa69c"><div class="ttname"><a href="class_lens_halo.html#a122a8066d3746da81768627a19aaa69c">LensHalo::get_flag_elliptical</a></div><div class="ttdeci">bool get_flag_elliptical()</div><div class="ttdoc">flag=True if halo elliptical</div><div class="ttdef"><b>Definition:</b> lens_halos.h:156</div></div>
<div class="ttc" id="aclass_lens_halo_t_n_s_i_e_html_a5d376b662906ce37c7e460c93c0bfd91"><div class="ttname"><a href="class_lens_halo_t_n_s_i_e.html#a5d376b662906ce37c7e460c93c0bfd91">LensHaloTNSIE::rtrunc</a></div><div class="ttdeci">float rtrunc</div><div class="ttdoc">core size of NSIE</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1216</div></div>
<div class="ttc" id="aclass_lens_halo_html_a65304f5eeabf9d8e0209691e3ee16820"><div class="ttname"><a href="class_lens_halo.html#a65304f5eeabf9d8e0209691e3ee16820">LensHalo::getTheta</a></div><div class="ttdeci">void getTheta(PosType *MyPosHalo) const</div><div class="ttdoc">get the position of the Halo in radians</div><div class="ttdef"><b>Definition:</b> lens_halos.h:111</div></div>
<div class="ttc" id="aclass_lens_halo_html"><div class="ttname"><a href="class_lens_halo.html">LensHalo</a></div><div class="ttdoc">A base class for all types of lensing &quot;halos&quot; which are any mass distribution that cause lensing.</div><div class="ttdef"><b>Definition:</b> lens_halos.h:56</div></div>
<div class="ttc" id="aclass_lens_halo_html_a907cc0b6b9bc12f90ed7e61a674dff26"><div class="ttname"><a href="class_lens_halo.html#a907cc0b6b9bc12f90ed7e61a674dff26">LensHalo::set_switch_flag</a></div><div class="ttdeci">void set_switch_flag(bool swt)</div><div class="ttdoc">flag permits case distinction in force_halo_asym for elliptical NFWs only (get_switch_flag==true),...</div><div class="ttdef"><b>Definition:</b> lens_halos.h:159</div></div>
<div class="ttc" id="aclass_lens_halo_html_ac43654064fefbfecd0d7c9c1887fadad"><div class="ttname"><a href="class_lens_halo.html#ac43654064fefbfecd0d7c9c1887fadad">LensHalo::set_RsizeRmax</a></div><div class="ttdeci">virtual void set_RsizeRmax(float my_Rsize)</div><div class="ttdoc">set Rsize (in Mpc) and reset Rmax</div><div class="ttdef"><b>Definition:</b> lens_halos.h:130</div></div>
<div class="ttc" id="aclass_lens_halo_n_f_w_html_a9f48edfd8a1cbc024b8e51ca879aab36"><div class="ttname"><a href="class_lens_halo_n_f_w.html#a9f48edfd8a1cbc024b8e51ca879aab36">LensHaloNFW::InterpolateFromTable</a></div><div class="ttdeci">PosType InterpolateFromTable(PosType *table, PosType y) const</div><div class="ttdoc">interpolates from the specific tables</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:566</div></div>
<div class="ttc" id="aclass_lens_halo_html_ad0138e93c3a165ae25cd42bea42c4c4b"><div class="ttname"><a href="class_lens_halo.html#ad0138e93c3a165ae25cd42bea42c4c4b">LensHalo::rscale</a></div><div class="ttdeci">float rscale</div><div class="ttdoc">scale length or core size. Different meaning in different cases. Not used in NSIE case.</div><div class="ttdef"><b>Definition:</b> lens_halos.h:356</div></div>
<div class="ttc" id="aclass_lens_halo_t_e_p_l_html_a0a1009d8336d27acb46523aab2c6248a"><div class="ttname"><a href="class_lens_halo_t_e_p_l.html#a0a1009d8336d27acb46523aab2c6248a">LensHaloTEPL::LensHaloTEPL</a></div><div class="ttdeci">LensHaloTEPL(float my_mass, PosType my_zlens, PosType r_trunc, PosType gamma, float my_fratio, float my_pa, const COSMOLOGY &amp;cosmo, float f=10)</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:1173</div></div>
<div class="ttc" id="aclass_lens_halo_html_a04e4a630ac49ff76831e06fb1ab0d669"><div class="ttname"><a href="class_lens_halo.html#a04e4a630ac49ff76831e06fb1ab0d669">LensHalo::getX</a></div><div class="ttdeci">void getX(PosType *MyPosHalo) const</div><div class="ttdoc">get the position of the Halo in physical Mpc on the lens plane</div><div class="ttdef"><b>Definition:</b> lens_halos.h:95</div></div>
<div class="ttc" id="aclass_lens_halo_power_law_html"><div class="ttname"><a href="class_lens_halo_power_law.html">LensHaloPowerLaw</a></div><div class="ttdoc">A class for calculating the deflection, kappa and gamma caused by a collection of halos with truncate...</div><div class="ttdef"><b>Definition:</b> lens_halos.h:952</div></div>
<div class="ttc" id="aclass_lens_halo_pseudo_n_f_w_html_ad7e3fe8f3cd6be7b4851bc09091d47be"><div class="ttname"><a href="class_lens_halo_pseudo_n_f_w.html#ad7e3fe8f3cd6be7b4851bc09091d47be">LensHaloPseudoNFW::get_slope</a></div><div class="ttdeci">PosType get_slope()</div><div class="ttdoc">initialize from a mass function</div><div class="ttdef"><b>Definition:</b> lens_halos.h:894</div></div>
<div class="ttc" id="aclass_lens_halo_pseudo_n_f_w_html_aa575a8223d58064bb6a4ff182728bf74"><div class="ttname"><a href="class_lens_halo_pseudo_n_f_w.html#aa575a8223d58064bb6a4ff182728bf74">LensHaloPseudoNFW::LensHaloPseudoNFW</a></div><div class="ttdeci">LensHaloPseudoNFW()</div><div class="ttdoc">shell constructor, should be avoided</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:646</div></div>
<div class="ttc" id="aclass_lens_halo_t_e_p_l_html_a673e1ea86f674734350a7830dcefea95"><div class="ttname"><a href="class_lens_halo_t_e_p_l.html#a673e1ea86f674734350a7830dcefea95">LensHaloTEPL::get_pa</a></div><div class="ttdeci">float get_pa()</div><div class="ttdoc">get the position angle</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1275</div></div>
<div class="ttc" id="aclass_lens_halo_html_a9295b7b1d0a66b3742a81ead5bf2a863"><div class="ttname"><a href="class_lens_halo.html#a9295b7b1d0a66b3742a81ead5bf2a863">LensHalo::alpha_h</a></div><div class="ttdeci">virtual PosType alpha_h(PosType x) const</div><div class="ttdef"><b>Definition:</b> lens_halos.h:377</div></div>
<div class="ttc" id="astruct_point__2d_html"><div class="ttname"><a href="struct_point__2d.html">Point_2d</a></div><div class="ttdoc">Class for representing points or vectors in 2 dimensions. Not that the dereferencing operator is over...</div><div class="ttdef"><b>Definition:</b> point.h:48</div></div>
<div class="ttc" id="aclass_lens_halo_html_affb1ead96e81d87f61d45e09a6f6fb3f"><div class="ttname"><a href="class_lens_halo.html#affb1ead96e81d87f61d45e09a6f6fb3f">LensHalo::analModes</a></div><div class="ttdeci">void analModes(int modnumber, PosType my_beta, PosType q, PosType amod[3])</div><div class="ttdef"><b>Definition:</b> modes_ana.cpp:156</div></div>
<div class="ttc" id="aclass_lens_halo_html_a314019a0eac186c6fc7aca2e466ffd46"><div class="ttname"><a href="class_lens_halo.html#a314019a0eac186c6fc7aca2e466ffd46">LensHalo::Nparams</a></div><div class="ttdeci">virtual std::size_t Nparams() const</div><div class="ttdoc">get the number of halo parameters</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:2432</div></div>
<div class="ttc" id="aclass_lens_halo_n_f_w_html_a222a1a0ced3498ba1b8cb4ee53e294f5"><div class="ttname"><a href="class_lens_halo_n_f_w.html#a222a1a0ced3498ba1b8cb4ee53e294f5">LensHaloNFW::gammaNFW</a></div><div class="ttdeci">void gammaNFW(KappaType *gamma, PosType *x, PosType Rtrunc, PosType mass, PosType r_scale, PosType *center, PosType Sigma_crit)</div><div class="ttdoc">Shear for and NFW halo. this might have a flaw in it.</div><div class="ttdef"><b>Definition:</b> nfw_lens.cpp:56</div></div>
<div class="ttc" id="aclass_lens_halo_html_ae4e6a8b770a38df28c9bee8799385923"><div class="ttname"><a href="class_lens_halo.html#ae4e6a8b770a38df28c9bee8799385923">LensHalo::getEllipMethod</a></div><div class="ttdeci">EllipMethod getEllipMethod() const</div><div class="ttdoc">stars</div><div class="ttdef"><b>Definition:</b> lens_halos.h:211</div></div>
<div class="ttc" id="aclass_lens_halo_real_n_s_i_e_html_a8cf88e172212e1ea469eb9348fbca782"><div class="ttname"><a href="class_lens_halo_real_n_s_i_e.html#a8cf88e172212e1ea469eb9348fbca782">LensHaloRealNSIE::pa</a></div><div class="ttdeci">float pa</div><div class="ttdoc">position angle on sky, radians</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1110</div></div>
<div class="ttc" id="aclass_lens_halo_t_n_s_i_e_html"><div class="ttname"><a href="class_lens_halo_t_n_s_i_e.html">LensHaloTNSIE</a></div><div class="ttdoc">Truncated non-singular isothermal ellipsoid.</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1135</div></div>
<div class="ttc" id="aclass_lens_halo_power_law_html_a2265529c633a4ac00ab06eaebe3c9c18"><div class="ttname"><a href="class_lens_halo_power_law.html#a2265529c633a4ac00ab06eaebe3c9c18">LensHaloPowerLaw::initFromMassFunc</a></div><div class="ttdeci">void initFromMassFunc(float my_mass, float my_Rsize, float my_rscale, PosType my_slope, long *seed)</div><div class="ttdoc">set the slope of the surface density profile</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:903</div></div>
<div class="ttc" id="aclass_lens_halo_html_a813618bcd6d1f26dafa49a2e509a37db"><div class="ttname"><a href="class_lens_halo.html#a813618bcd6d1f26dafa49a2e509a37db">LensHalo::LensHalo</a></div><div class="ttdeci">LensHalo()</div><div class="ttdoc">Shell constructor.</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:14</div></div>
<div class="ttc" id="aclass_lens_halo_pseudo_n_f_w_html"><div class="ttname"><a href="class_lens_halo_pseudo_n_f_w.html">LensHaloPseudoNFW</a></div><div class="ttdoc">A class for calculating the deflection, kappa and gamma caused by a collection of halos with a double...</div><div class="ttdef"><b>Definition:</b> lens_halos.h:880</div></div>
<div class="ttc" id="aclass_lens_halo_n_f_w_html_a87747a7b1ca624f4fb8630e59f69dea7"><div class="ttname"><a href="class_lens_halo_n_f_w.html#a87747a7b1ca624f4fb8630e59f69dea7">LensHaloNFW::maxrm</a></div><div class="ttdeci">static const PosType maxrm</div><div class="ttdoc">maximum Rsize/rscale</div><div class="ttdef"><b>Definition:</b> lens_halos.h:825</div></div>
<div class="ttc" id="aclass_lens_halo_real_n_s_i_e_html_ad1508629420d5c79d3601cb4665114fe"><div class="ttname"><a href="class_lens_halo_real_n_s_i_e.html#ad1508629420d5c79d3601cb4665114fe">LensHaloRealNSIE::set_sigma</a></div><div class="ttdeci">void set_sigma(float my_sigma)</div><div class="ttdoc">set the velocity dispersion</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1072</div></div>
<div class="ttc" id="aclass_lens_halo_real_n_s_i_e_html_a67d91d891fd292da7edc05408a280f16"><div class="ttname"><a href="class_lens_halo_real_n_s_i_e.html#a67d91d891fd292da7edc05408a280f16">LensHaloRealNSIE::get_sigma</a></div><div class="ttdeci">float get_sigma()</div><div class="ttdoc">get the velocity dispersion</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1061</div></div>
<div class="ttc" id="aclass_lens_halo_html_a3e73f06df4d909f1bff909016cc839b2"><div class="ttname"><a href="class_lens_halo.html#a3e73f06df4d909f1bff909016cc839b2">LensHalo::alpha_int</a></div><div class="ttdeci">PosType alpha_int(PosType x) const</div><div class="ttdoc">Calculates potential (phi_int) from alpha_h. If flag is_alphah_a_table is True it takes and integrate...</div><div class="ttdef"><b>Definition:</b> base_analens.cpp:591</div></div>
<div class="ttc" id="aclass_lens_halo_html_a7c6257df5c75a20d7f306cc9f4980a52"><div class="ttname"><a href="class_lens_halo.html#a7c6257df5c75a20d7f306cc9f4980a52">LensHalo::getParam</a></div><div class="ttdeci">virtual PosType getParam(std::size_t p) const</div><div class="ttdoc">get the value of a scaled halo parameter by index</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:2437</div></div>
<div class="ttc" id="aclass_lens_halo_t_e_p_l_html"><div class="ttname"><a href="class_lens_halo_t_e_p_l.html">LensHaloTEPL</a></div><div class="ttdoc">A truncated elliptical power-law profile.</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1224</div></div>
<div class="ttc" id="aclass_lens_halo_html_a81938111b0d90611edcff8b2d4dd8432"><div class="ttname"><a href="class_lens_halo.html#a81938111b0d90611edcff8b2d4dd8432">LensHalo::displayPos</a></div><div class="ttdeci">void displayPos()</div><div class="ttdef"><b>Definition:</b> lens_halos.h:122</div></div>
<div class="ttc" id="aclass_lens_halo_t_e_p_l_html_abb5f991dc2bec41d9e532b92f5f87038"><div class="ttname"><a href="class_lens_halo_t_e_p_l.html#abb5f991dc2bec41d9e532b92f5f87038">LensHaloTEPL::get_t</a></div><div class="ttdeci">float get_t()</div><div class="ttdoc">get the power-law index</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1279</div></div>
<div class="ttc" id="aclass_lens_halo_html_a7e68cb08c90a52d21f6af474acfc20e2"><div class="ttname"><a href="class_lens_halo.html#a7e68cb08c90a52d21f6af474acfc20e2">LensHalo::alphakappagamma_asym</a></div><div class="ttdeci">virtual void alphakappagamma_asym(PosType x, PosType theta, PosType alpha[], PosType *kappa, PosType gamma[], PosType *phi)</div><div class="ttdoc">Pseudo-elliptical profiles by Phi(G)-Ansatz.</div><div class="ttdef"><b>Definition:</b> base_analens.cpp:754</div></div>
<div class="ttc" id="aclass_lens_halo_html_ababdb795dfb3955b14078a8fe777d608"><div class="ttname"><a href="class_lens_halo.html#ababdb795dfb3955b14078a8fe777d608">LensHalo::set_slope</a></div><div class="ttdeci">virtual void set_slope(PosType my_slope)</div><div class="ttdoc">set slope</div><div class="ttdef"><b>Definition:</b> lens_halos.h:152</div></div>
<div class="ttc" id="aclass_lens_halo_t_n_s_i_e_html_a0de4f393396586902f42613cff6dd9da"><div class="ttname"><a href="class_lens_halo_t_n_s_i_e.html#a0de4f393396586902f42613cff6dd9da">LensHaloTNSIE::get_rcore</a></div><div class="ttdeci">float get_rcore()</div><div class="ttdoc">get the core radius</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1190</div></div>
<div class="ttc" id="aclass_lens_halo_html_a9125a5a6f4685d157dfbeacd00433ab2"><div class="ttname"><a href="class_lens_halo.html#a9125a5a6f4685d157dfbeacd00433ab2">LensHalo::compareZ</a></div><div class="ttdeci">bool compareZ(PosType z)</div><div class="ttdoc">force tree calculation for stars</div><div class="ttdef"><b>Definition:</b> lens_halos.h:196</div></div>
<div class="ttc" id="aclass_lens_halo_html_a68e3f2ba68f2d93202985fb317cf0a14"><div class="ttname"><a href="class_lens_halo.html#a68e3f2ba68f2d93202985fb317cf0a14">LensHalo::set_rscale</a></div><div class="ttdeci">virtual void set_rscale(float my_rscale)</div><div class="ttdoc">set scale radius (in Mpc)</div><div class="ttdef"><b>Definition:</b> lens_halos.h:134</div></div>
<div class="ttc" id="aclass_lens_halo_html_aeac398d7784e8a879eebeb2174349d61"><div class="ttname"><a href="class_lens_halo.html#aeac398d7784e8a879eebeb2174349d61">LensHalo::MassBy1DIntegation</a></div><div class="ttdeci">PosType MassBy1DIntegation(PosType R)</div><div class="ttdoc">calculates the mass within radius R by integating alpha on a ring and using Gauss' law,...</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:2469</div></div>
<div class="ttc" id="aclass_lens_halo_n_f_w_html_aaf3791f1b4431e07500151c68a613ac1"><div class="ttname"><a href="class_lens_halo_n_f_w.html#aaf3791f1b4431e07500151c68a613ac1">LensHaloNFW::NTABLE</a></div><div class="ttdeci">static const long NTABLE</div><div class="ttdoc">table size</div><div class="ttdef"><b>Definition:</b> lens_halos.h:819</div></div>
<div class="ttc" id="aclass_lens_halo_html_a2616defcc052fd9ab1e568cfd8a5c9a9"><div class="ttname"><a href="class_lens_halo.html#a2616defcc052fd9ab1e568cfd8a5c9a9">LensHalo::getRsize</a></div><div class="ttdeci">float getRsize() const</div><div class="ttdoc">get the Rsize which is the size of the halo in Mpc</div><div class="ttdef"><b>Definition:</b> lens_halos.h:81</div></div>
<div class="ttc" id="aclass_lens_halo_html_aea2b2ded8c4b6a3b65df46c1fc265b97"><div class="ttname"><a href="class_lens_halo.html#aea2b2ded8c4b6a3b65df46c1fc265b97">LensHalo::fourier_coeff</a></div><div class="ttdeci">double fourier_coeff(double n, double q, double beta)</div><div class="ttdoc">Calculates fourier-coefficients for power law halo.</div><div class="ttdef"><b>Definition:</b> base_analens.cpp:585</div></div>
<div class="ttc" id="aclass_lens_halo_html_ab67216d6042f33cd8d8482e6fceb8b39"><div class="ttname"><a href="class_lens_halo.html#ab67216d6042f33cd8d8482e6fceb8b39">LensHalo::set_rsize</a></div><div class="ttdeci">void set_rsize(float my_rsize)</div><div class="ttdoc">set radius rsize beyond which interpolation values between alpha_ellip and alpha_iso are computed</div><div class="ttdef"><b>Definition:</b> lens_halos.h:240</div></div>
<div class="ttc" id="aclass_lens_halo_pseudo_n_f_w_html_a2315731cb8f04955e511ea49cc51428c"><div class="ttname"><a href="class_lens_halo_pseudo_n_f_w.html#a2315731cb8f04955e511ea49cc51428c">LensHaloPseudoNFW::set_slope</a></div><div class="ttdeci">void set_slope(PosType my_slope)</div><div class="ttdoc">set the slope of the surface density profile</div><div class="ttdef"><b>Definition:</b> lens_halos.h:892</div></div>
<div class="ttc" id="aclass_lens_halo_real_n_s_i_e_html_a87eddad4a45f97513a24e7767217048c"><div class="ttname"><a href="class_lens_halo_real_n_s_i_e.html#a87eddad4a45f97513a24e7767217048c">LensHaloRealNSIE::get_rcore</a></div><div class="ttdeci">float get_rcore()</div><div class="ttdoc">get the core radius</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1069</div></div>
<div class="ttc" id="aclass_lens_halo_real_n_s_i_e_html_ad424eaab3e55a1b101f0b7a84fdc474b"><div class="ttname"><a href="class_lens_halo_real_n_s_i_e.html#ad424eaab3e55a1b101f0b7a84fdc474b">LensHaloRealNSIE::assignParams</a></div><div class="ttdeci">void assignParams(InputParams &amp;params)</div><div class="ttdoc">initialize from a simulation file</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:1108</div></div>
<div class="ttc" id="aclass_lens_halo_t_n_s_i_e_html_a02d54f8e189ddbf50320f05d39860bf9"><div class="ttname"><a href="class_lens_halo_t_n_s_i_e.html#a02d54f8e189ddbf50320f05d39860bf9">LensHaloTNSIE::get_pa</a></div><div class="ttdeci">float get_pa()</div><div class="ttdoc">get the position angle</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1188</div></div>
<div class="ttc" id="aclass_lens_halo_html_a5a36eb5a13d944c34ad0cd56b1b8e598"><div class="ttname"><a href="class_lens_halo.html#a5a36eb5a13d944c34ad0cd56b1b8e598">LensHalo::setTheta</a></div><div class="ttdeci">void setTheta(PosType *PosXY)</div><div class="ttdoc">set the position of the Halo in radians</div><div class="ttdef"><b>Definition:</b> lens_halos.h:107</div></div>
<div class="ttc" id="aclass_lens_halo_html_a4ad6ef27f481ed707031b3c5f9f5e435"><div class="ttname"><a href="class_lens_halo.html#a4ad6ef27f481ed707031b3c5f9f5e435">LensHalo::setTheta</a></div><div class="ttdeci">void setTheta(PosType PosX, PosType PosY)</div><div class="ttdoc">set the position of the Halo in radians</div><div class="ttdef"><b>Definition:</b> lens_halos.h:105</div></div>
<div class="ttc" id="aclass_lens_halo_real_n_s_i_e_html_a1c671a7e6cf51beec3eee19566364198"><div class="ttname"><a href="class_lens_halo_real_n_s_i_e.html#a1c671a7e6cf51beec3eee19566364198">LensHaloRealNSIE::get_pa</a></div><div class="ttdeci">float get_pa()</div><div class="ttdoc">get the position angle</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1067</div></div>
<div class="ttc" id="aclass_lens_halo_t_e_p_l_html_ae8d450a37357553b9ddfcdfd06a8432e"><div class="ttname"><a href="class_lens_halo_t_e_p_l.html#ae8d450a37357553b9ddfcdfd06a8432e">LensHaloTEPL::force_halo</a></div><div class="ttdeci">void force_halo(PosType *alpha, KappaType *kappa, KappaType *gamma, KappaType *phi, PosType const *xcm, bool subtract_point=false, PosType screening=1.0)</div><div class="ttdoc">overridden function to calculate the lensing properties</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:1209</div></div>
<div class="ttc" id="aclass_lens_halo_html_ab75f44fbd91c08d9f2bc03b5fe9d649a"><div class="ttname"><a href="class_lens_halo.html#ab75f44fbd91c08d9f2bc03b5fe9d649a">LensHalo::printCSV</a></div><div class="ttdeci">virtual void printCSV(std::ostream &amp;, bool header=false) const</div><div class="ttdoc">print the halo parameters in CSV format</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:2455</div></div>
<div class="ttc" id="aclass_lens_halo_t_n_s_i_e_html_aa92bb3655a5680cf83616f3a6a0eac68"><div class="ttname"><a href="class_lens_halo_t_n_s_i_e.html#aa92bb3655a5680cf83616f3a6a0eac68">LensHaloTNSIE::get_fratio</a></div><div class="ttdeci">float get_fratio()</div><div class="ttdoc">get the axis ratio</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1186</div></div>
<div class="ttc" id="aclass_lens_halo_html_a9b357894d8d644741be0cec08e45bb30"><div class="ttname"><a href="class_lens_halo.html#a9b357894d8d644741be0cec08e45bb30">LensHalo::test</a></div><div class="ttdeci">bool test()</div><div class="ttdoc">perform some basic consistancy checks for halo</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:2488</div></div>
<div class="ttc" id="aclass_lens_halo_t_n_s_i_e_html_afa724ff75a37e7a1d0972efd7e02d646"><div class="ttname"><a href="class_lens_halo_t_n_s_i_e.html#afa724ff75a37e7a1d0972efd7e02d646">LensHaloTNSIE::get_rtrunc</a></div><div class="ttdeci">float get_rtrunc()</div><div class="ttdoc">get the truncation radius</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1192</div></div>
<div class="ttc" id="aclass_lens_halo_t_n_s_i_e_html_a75725b3e22d3f36a7284d45780e4125e"><div class="ttname"><a href="class_lens_halo_t_n_s_i_e.html#a75725b3e22d3f36a7284d45780e4125e">LensHaloTNSIE::fratio</a></div><div class="ttdeci">float fratio</div><div class="ttdoc">axis ratio of surface mass distribution</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1210</div></div>
<div class="ttc" id="aclass_lens_halo_n_f_w_html_a22c52ff3881b5054f5a52bd00ada6c18"><div class="ttname"><a href="class_lens_halo_n_f_w.html#a22c52ff3881b5054f5a52bd00ada6c18">LensHaloNFW::set_RsizeXmax</a></div><div class="ttdeci">void set_RsizeXmax(float my_Rsize)</div><div class="ttdoc">set Rsize, xmax and gmax</div><div class="ttdef"><b>Definition:</b> lens_halos.h:816</div></div>
<div class="ttc" id="aclass_lens_halo_html_ae93d20b6fdeaaab7d1f0a61a13e6d644"><div class="ttname"><a href="class_lens_halo.html#ae93d20b6fdeaaab7d1f0a61a13e6d644">LensHalo::setCosmology</a></div><div class="ttdeci">virtual void setCosmology(const COSMOLOGY &amp;cosmo)</div><div class="ttdoc">used for elliptical NFWs only, in that case get_switch_flag==true</div><div class="ttdef"><b>Definition:</b> lens_halos.h:163</div></div>
<div class="ttc" id="aclass_lens_halo_html_a429dcab3579fa5291bf82f0484c0a480"><div class="ttname"><a href="class_lens_halo.html#a429dcab3579fa5291bf82f0484c0a480">LensHalo::calcModes</a></div><div class="ttdeci">void calcModes(double q, double beta, double rottheta, PosType newmod[])</div><div class="ttdoc">Calculates the modes for fourier expansion of power law halo. All the modes are relative to the zero ...</div><div class="ttdef"><b>Definition:</b> base_analens.cpp:607</div></div>
<div class="ttc" id="aclass_lens_halo_html_a7184a202e39fac7cf8f7d0436abdc982"><div class="ttname"><a href="class_lens_halo.html#a7184a202e39fac7cf8f7d0436abdc982">LensHalo::MassBy2DIntegation</a></div><div class="ttdeci">PosType MassBy2DIntegation(PosType R)</div><div class="ttdoc">Prints star parameters; if show_stars is true, prints data for single stars.</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:2463</div></div>
<div class="ttc" id="aclass_lens_halo_html_ab90367cd516c00c93e8608894732e965"><div class="ttname"><a href="class_lens_halo.html#ab90367cd516c00c93e8608894732e965">LensHalo::alphakappagamma1asym</a></div><div class="ttdeci">virtual void alphakappagamma1asym(PosType x, PosType theta, PosType alpha[2], PosType *kappa, PosType gamma[], PosType *phi)</div><div class="ttdoc">Elliptical profiles by Fourier-Ansatz.</div><div class="ttdef"><b>Definition:</b> base_analens.cpp:800</div></div>
<div class="ttc" id="aclass_lens_halo_real_n_s_i_e_html_ad5b2d23ccf59add995299c843082014c"><div class="ttname"><a href="class_lens_halo_real_n_s_i_e.html#ad5b2d23ccf59add995299c843082014c">LensHaloRealNSIE::fratio</a></div><div class="ttdeci">float fratio</div><div class="ttdoc">axis ratio of surface mass distribution</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1108</div></div>
<div class="ttc" id="aclass_lens_halo_html_a187b1e7e055d69419bf214ebf588af6d"><div class="ttname"><a href="class_lens_halo.html#a187b1e7e055d69419bf214ebf588af6d">LensHalo::assignParams</a></div><div class="ttdeci">void assignParams(InputParams &amp;params, bool needRsize)</div><div class="ttdoc">read in parameters from a parameterfile in InputParams params</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:243</div></div>
<div class="ttc" id="aclass_lens_halo_html_a01ce57465ce8d14670804096aee578c7"><div class="ttname"><a href="class_lens_halo.html#a01ce57465ce8d14670804096aee578c7">LensHalo::getZlens</a></div><div class="ttdeci">PosType getZlens() const</div><div class="ttdoc">get the redshift</div><div class="ttdef"><b>Definition:</b> lens_halos.h:87</div></div>
<div class="ttc" id="aclass_lens_halo_real_n_s_i_e_html_a12e878c04721c762ae9bebc5a25c01c2"><div class="ttname"><a href="class_lens_halo_real_n_s_i_e.html#a12e878c04721c762ae9bebc5a25c01c2">LensHaloRealNSIE::set_fratio</a></div><div class="ttdeci">void set_fratio(float my_fratio)</div><div class="ttdoc">set the axis ratio</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1076</div></div>
<div class="ttc" id="aclass_lens_halo_html_a2deb914a879890de10a76323cf056aae"><div class="ttname"><a href="class_lens_halo.html#a2deb914a879890de10a76323cf056aae">LensHalo::get_slope</a></div><div class="ttdeci">virtual PosType get_slope()</div><div class="ttdoc">get slope</div><div class="ttdef"><b>Definition:</b> lens_halos.h:154</div></div>
<div class="ttc" id="aclass_lens_halo_dummy_html"><div class="ttname"><a href="class_lens_halo_dummy.html">LensHaloDummy</a></div><div class="ttdoc">This is a lens that does no lensing. It is useful for testing and for running refinement code on sour...</div><div class="ttdef"><b>Definition:</b> lens_halos.h:2051</div></div>
<div class="ttc" id="aclass_lens_halo_html_a50bd89dc5d7d11932c757eb4e962b6ba"><div class="ttname"><a href="class_lens_halo.html#a50bd89dc5d7d11932c757eb4e962b6ba">LensHalo::getDist</a></div><div class="ttdeci">PosType getDist() const</div><div class="ttdef"><b>Definition:</b> lens_halos.h:118</div></div>
<div class="ttc" id="aclass_lens_halo_t_n_s_i_e_html_adb0eb481a621deed3d074c8cd452377e"><div class="ttname"><a href="class_lens_halo_t_n_s_i_e.html#adb0eb481a621deed3d074c8cd452377e">LensHaloTNSIE::assignParams</a></div><div class="ttdeci">void assignParams(InputParams &amp;params)</div><div class="ttdoc">read-in parameters from a parameter file</div></div>
<div class="ttc" id="aclass_lens_halo_t_n_s_i_e_html_a0971c25099944f15e3e15047b41fef4e"><div class="ttname"><a href="class_lens_halo_t_n_s_i_e.html#a0971c25099944f15e3e15047b41fef4e">LensHaloTNSIE::calc_sigma</a></div><div class="ttdeci">static double calc_sigma(float mass, float Rtrunc, float Rcore, float fratio)</div><div class="ttdoc">returns the sigma in km / s for the other parameters fixed</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1174</div></div>
<div class="ttc" id="a_input_params_8h_html"><div class="ttname"><a href="_input_params_8h.html">InputParams.h</a></div></div>
<div class="ttc" id="aclass_lens_halo_html_a6a8cf22c76bab7821b1b0ee3b50ea75f"><div class="ttname"><a href="class_lens_halo.html#a6a8cf22c76bab7821b1b0ee3b50ea75f">LensHalo::error_message1</a></div><div class="ttdeci">void error_message1(std::string name, std::string filename)</div><div class="ttdoc">read in star parameters. This is valid for all halos and not overloaded.</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:237</div></div>
<div class="ttc" id="aclass_lens_halo_html_a825833ac8df009db76b5e4b4b4e140f9"><div class="ttname"><a href="class_lens_halo.html#a825833ac8df009db76b5e4b4b4e140f9">LensHalo::faxial</a></div><div class="ttdeci">void faxial(PosType x, PosType theta, PosType f[])</div><div class="ttdoc">If set to true the correct normalization is applied for asymmetric NFW profiles, the mass_norm_factor...</div><div class="ttdef"><b>Definition:</b> base_analens.cpp:472</div></div>
<div class="ttc" id="aclass_lens_halo_n_f_w_html_a1e862a84007d11cb5d66fccc2b7c9daa"><div class="ttname"><a href="class_lens_halo_n_f_w.html#a1e862a84007d11cb5d66fccc2b7c9daa">LensHaloNFW::initFromFile</a></div><div class="ttdeci">void initFromFile(float my_mass, long *seed, float vmax, float r_halfmass)</div><div class="ttdoc">Sets the profile to match the mass, Vmax and R_halfmass.</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:618</div></div>
<div class="ttc" id="aclass_lens_halo_html_a55b64efb4df0a26188ee558afa90d6bf"><div class="ttname"><a href="class_lens_halo.html#a55b64efb4df0a26188ee558afa90d6bf">LensHalo::set_mass</a></div><div class="ttdeci">void set_mass(float my_mass)</div><div class="ttdoc">set mass (in solar masses)</div><div class="ttdef"><b>Definition:</b> lens_halos.h:132</div></div>
<div class="ttc" id="aclass_lens_halo_t_n_s_i_e_html_aeb50b46767ac92a5d475e30350519858"><div class="ttname"><a href="class_lens_halo_t_n_s_i_e.html#aeb50b46767ac92a5d475e30350519858">LensHaloTNSIE::get_sigma</a></div><div class="ttdeci">float get_sigma()</div><div class="ttdoc">get the velocity dispersion</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1182</div></div>
<div class="ttc" id="aclass_lens_halo_html_a78cc531d36104d72bec891424aba9fcb"><div class="ttname"><a href="class_lens_halo.html#a78cc531d36104d72bec891424aba9fcb">LensHalo::force_halo_asym</a></div><div class="ttdeci">void force_halo_asym(PosType *alpha, KappaType *kappa, KappaType *gamma, KappaType *phi, PosType const *xcm, bool subtract_point=false, PosType screening=1.0)</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:1674</div></div>
<div class="ttc" id="aclass_lens_halo_html_abe2665d12192e49e464127dd3b78a96d"><div class="ttname"><a href="class_lens_halo.html#abe2665d12192e49e464127dd3b78a96d">LensHalo::Rmax_to_Rsize_ratio</a></div><div class="ttdeci">float Rmax_to_Rsize_ratio</div><div class="ttdoc">The factor by which Rmax is larger than Rsize.</div><div class="ttdef"><b>Definition:</b> lens_halos.h:353</div></div>
<div class="ttc" id="aclass_lens_halo_html_aea13e7ff3d95622bbb38fffd672045fa"><div class="ttname"><a href="class_lens_halo.html#aea13e7ff3d95622bbb38fffd672045fa">LensHalo::gradial</a></div><div class="ttdeci">void gradial(PosType r, PosType g[])</div><div class="ttdoc">Derivatives of the potential damping factor with respect to r ... TODO: come up with a better damping...</div><div class="ttdef"><b>Definition:</b> base_analens.cpp:556</div></div>
<div class="ttc" id="aclass_lens_halo_html_ad13e77713ccce39fd925e810063cbae3"><div class="ttname"><a href="class_lens_halo.html#ad13e77713ccce39fd925e810063cbae3">LensHalo::get_rscale</a></div><div class="ttdeci">float get_rscale() const</div><div class="ttdoc">get the scale radius in Mpc</div><div class="ttdef"><b>Definition:</b> lens_halos.h:85</div></div>
<div class="ttc" id="aclass_lens_halo_html_a8b31bdf68c61572e7a32dc3da6b139c8"><div class="ttname"><a href="class_lens_halo.html#a8b31bdf68c61572e7a32dc3da6b139c8">LensHalo::initFromMassFunc</a></div><div class="ttdeci">virtual void initFromMassFunc(float my_mass, float my_Rsize, float my_rscale, PosType my_slope, long *seed)</div><div class="ttdoc">initialize from a mass function</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:229</div></div>
<div class="ttc" id="aclass_lens_halo_pseudo_n_f_w_html_a40844cb3d12a0028b0c95c04bb10d834"><div class="ttname"><a href="class_lens_halo_pseudo_n_f_w.html#a40844cb3d12a0028b0c95c04bb10d834">LensHaloPseudoNFW::mhat</a></div><div class="ttdeci">PosType mhat(PosType y, PosType beta) const</div><div class="ttdoc">Auxiliary function for PseudoNFW profile.</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:724</div></div>
<div class="ttc" id="aclass_lens_halo_n_f_w_html_afa273b32b7c0159776310f9a6b412df6"><div class="ttname"><a href="class_lens_halo_n_f_w.html#afa273b32b7c0159776310f9a6b412df6">LensHaloNFW::alphaNFW</a></div><div class="ttdeci">void alphaNFW(PosType *alpha, PosType *x, PosType Rtrunc, PosType mass, PosType r_scale, PosType *center, PosType Sigma_crit)</div><div class="ttdoc">deflection caused by NFW halo</div><div class="ttdef"><b>Definition:</b> nfw_lens.cpp:9</div></div>
<div class="ttc" id="aclass_lens_halo_n_f_w_html_a9510ff2b41fecc0555a48b360304e04c"><div class="ttname"><a href="class_lens_halo_n_f_w.html#a9510ff2b41fecc0555a48b360304e04c">LensHaloNFW::set_rscaleXmax</a></div><div class="ttdeci">void set_rscaleXmax(float my_rscale)</div><div class="ttdef"><b>Definition:</b> lens_halos.h:819</div></div>
<div class="ttc" id="aclass_lens_halo_t_e_p_l_html_aa488c95058148f51577392a753802dda"><div class="ttname"><a href="class_lens_halo_t_e_p_l.html#aa488c95058148f51577392a753802dda">LensHaloTEPL::get_fratio</a></div><div class="ttdeci">float get_fratio()</div><div class="ttdoc">get the axis ratio</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1273</div></div>
<div class="ttc" id="aclass_pixel_map_html"><div class="ttname"><a href="class_pixel_map.html">PixelMap</a></div><div class="ttdoc">Image structure that can be manipulated and exported to/from fits files.</div><div class="ttdef"><b>Definition:</b> image_processing.h:48</div></div>
<div class="ttc" id="aclass_lens_halo_real_n_s_i_e_html"><div class="ttname"><a href="class_lens_halo_real_n_s_i_e.html">LensHaloRealNSIE</a></div><div class="ttdoc">Represents a non-singular isothermal elliptical lens.</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1023</div></div>
<div class="ttc" id="aparticle__types_8h_html"><div class="ttname"><a href="particle__types_8h.html">particle_types.h</a></div></div>
<div class="ttc" id="astandard_8h_html_a73d5f5042d9b38366d0b3781d199f9e7"><div class="ttname"><a href="standard_8h.html#a73d5f5042d9b38366d0b3781d199f9e7">LensingVariable</a></div><div class="ttdeci">LensingVariable</div><div class="ttdoc">output lensing variables</div><div class="ttdef"><b>Definition:</b> standard.h:89</div></div>
<div class="ttc" id="aclass_lens_halo_html_a645d2cbd9e686ce0d061d83d28c88eb0"><div class="ttname"><a href="class_lens_halo.html#a645d2cbd9e686ce0d061d83d28c88eb0">LensHalo::initFromFile</a></div><div class="ttdeci">virtual void initFromFile(float my_mass, long *seed, float vmax, float r_halfmass)</div><div class="ttdoc">initialize from a simulation file</div><div class="ttdef"><b>Definition:</b> lens_halos.h:125</div></div>
<div class="ttc" id="aclass_lens_halo_html_a70d44bd2ef4edee5fb918a61cf5d3fcf"><div class="ttname"><a href="class_lens_halo.html#a70d44bd2ef4edee5fb918a61cf5d3fcf">LensHalo::felliptical</a></div><div class="ttdeci">void felliptical(PosType x, PosType q, PosType theta, PosType f[], PosType g[])</div><div class="ttdoc">Calculate the derivatives of the G function = r*sqrt(cos(theta)^2 + q(r)^2 sin(theta))</div><div class="ttdef"><b>Definition:</b> base_analens.cpp:984</div></div>
<div class="ttc" id="aclass_lens_halo_n_f_w_html_aec09e889c8b03d29b5d0be6c0711f274"><div class="ttname"><a href="class_lens_halo_n_f_w.html#aec09e889c8b03d29b5d0be6c0711f274">LensHaloNFW::make_tables</a></div><div class="ttdeci">void make_tables()</div><div class="ttdoc">make the specific tables</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:482</div></div>
<div class="ttc" id="aclass_lens_halo_n_f_w_html_ad69ef65ce813a404b34a0fe20a6cf9cd"><div class="ttname"><a href="class_lens_halo_n_f_w.html#ad69ef65ce813a404b34a0fe20a6cf9cd">LensHaloNFW::ftable</a></div><div class="ttdeci">static PosType * ftable</div><div class="ttdoc">tables for lensing properties specific functions</div><div class="ttdef"><b>Definition:</b> lens_halos.h:830</div></div>
<div class="ttc" id="aclass_lens_halo_html_afbf395e2ec96c33289e7654732f05cf1"><div class="ttname"><a href="class_lens_halo.html#afbf395e2ec96c33289e7654732f05cf1">LensHalo::get_mod</a></div><div class="ttdeci">std::vector&lt; double &gt; get_mod()</div><div class="ttdoc">get vector of Fourier modes, which are calculated in the constructors of the LensHaloes when main_ell...</div><div class="ttdef"><b>Definition:</b> lens_halos.h:213</div></div>
<div class="ttc" id="aclass_lens_halo_n_f_w_html"><div class="ttname"><a href="class_lens_halo_n_f_w.html">LensHaloNFW</a></div><div class="ttdoc">A class for calculating the deflection, kappa and gamma caused by an NFW halos.</div><div class="ttdef"><b>Definition:</b> lens_halos.h:745</div></div>
<div class="ttc" id="aclass_lens_halo_html_a88159eac5a61762fffca24e508c2dccd"><div class="ttname"><a href="class_lens_halo.html#a88159eac5a61762fffca24e508c2dccd">LensHalo::setDist</a></div><div class="ttdeci">void setDist(COSMOLOGY &amp;co)</div><div class="ttdoc">Set the angular size distance to the halo. This should be the distance to the lens plane.</div><div class="ttdef"><b>Definition:</b> lens_halos.h:114</div></div>
<div class="ttc" id="aclass_lens_halo_real_n_s_i_e_html_a2ed71c36a12d26cc7188d2db9625a8d7"><div class="ttname"><a href="class_lens_halo_real_n_s_i_e.html#a2ed71c36a12d26cc7188d2db9625a8d7">LensHaloRealNSIE::set_rcore</a></div><div class="ttdeci">void set_rcore(float my_rcore)</div><div class="ttdoc">set the core radius Einstein radius</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1080</div></div>
<div class="ttc" id="aclass_input_params_html"><div class="ttname"><a href="class_input_params.html">InputParams</a></div><div class="ttdoc">Structure for reading and writing parameters to and from a parameter file as well as a container for ...</div><div class="ttdef"><b>Definition:</b> InputParams.h:99</div></div>
<div class="ttc" id="aclass_lens_halo_t_n_s_i_e_html_a79d2dccc1b626db90b6c9772f0d65a86"><div class="ttname"><a href="class_lens_halo_t_n_s_i_e.html#a79d2dccc1b626db90b6c9772f0d65a86">LensHaloTNSIE::pa</a></div><div class="ttdeci">float pa</div><div class="ttdoc">position angle on sky, radians</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1212</div></div>
<div class="ttc" id="aclass_lens_halo_html_a1fe8d2ac9d3b276cc5c473107a999b2d"><div class="ttname"><a href="class_lens_halo.html#a1fe8d2ac9d3b276cc5c473107a999b2d">LensHalo::operator[]</a></div><div class="ttdeci">PosType operator[](int i) const</div><div class="ttdoc">returns position of the Halo in physical Mpc on the lens plane</div><div class="ttdef"><b>Definition:</b> lens_halos.h:102</div></div>
<div class="ttc" id="aclass_lens_halo_html_a53aa267154c7a5e2b60647be2d585bb9"><div class="ttname"><a href="class_lens_halo.html#a53aa267154c7a5e2b60647be2d585bb9">LensHalo::setParam</a></div><div class="ttdeci">virtual PosType setParam(std::size_t p, PosType value)</div><div class="ttdoc">set the value of a scaled halo parameter by index</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:2446</div></div>
<div class="ttc" id="aclass_lens_halo_pseudo_n_f_w_html_a943a817b3f07b719a7becccd302d833e"><div class="ttname"><a href="class_lens_halo_pseudo_n_f_w.html#a943a817b3f07b719a7becccd302d833e">LensHaloPseudoNFW::initFromMassFunc</a></div><div class="ttdeci">void initFromMassFunc(float my_mass, float my_Rsize, float my_rscale, PosType my_slope, long *seed)</div><div class="ttdoc">set Rsize</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:770</div></div>
<div class="ttc" id="aclass_lens_halo_n_f_w_html_adb9b25642affcf63ab35b4b05c9f99ac"><div class="ttname"><a href="class_lens_halo_n_f_w.html#adb9b25642affcf63ab35b4b05c9f99ac">LensHaloNFW::alpha_h</a></div><div class="ttdeci">PosType alpha_h(PosType x) const</div><div class="ttdoc">r |alpha(r = x*rscale)| PI Sigma_crit / Mass</div><div class="ttdef"><b>Definition:</b> lens_halos.h:842</div></div>
<div class="ttc" id="aclass_lens_halo_real_n_s_i_e_html_a5f74372b820be290639413cd26456028"><div class="ttname"><a href="class_lens_halo_real_n_s_i_e.html#a5f74372b820be290639413cd26456028">LensHaloRealNSIE::set_pa</a></div><div class="ttdeci">void set_pa(float my_pa)</div><div class="ttdoc">set the position angle</div><div class="ttdef"><b>Definition:</b> lens_halos.h:1078</div></div>
<div class="ttc" id="aclass_lens_halo_n_f_w_html_a228966c2dd97f08cb94b7541880d6d3d"><div class="ttname"><a href="class_lens_halo_n_f_w.html#a228966c2dd97f08cb94b7541880d6d3d">LensHaloNFW::initFromMassFunc</a></div><div class="ttdeci">void initFromMassFunc(float my_mass, float my_Rsize, float my_rscale, PosType my_slope, long *seed)</div><div class="ttdoc">initialize from a mass function</div><div class="ttdef"><b>Definition:</b> lens_halos.cpp:633</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Mar 16 2024 11:03:34 for GLAMERDOC++ by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
