<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>GLAMERDOC++: TreeQuad Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">GLAMERDOC++
   </div>
   <div id="projectbrief">Gravitational Lensing Code Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Modules</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="class_tree_quad-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">TreeQuad Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="class_tree_quad.html" title="TreeQuad is a class for calculating the deflection, kappa and gamma by tree method. ">TreeQuad</a> is a class for calculating the deflection, kappa and gamma by tree method.  
 <a href="class_tree_quad.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="quad_tree_8h_source.html">quadTree.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for TreeQuad:</div>
<div class="dyncontent">
<div class="center"><img src="class_tree_quad__coll__graph.png" border="0" usemap="#_tree_quad_coll__map" alt="Collaboration graph"/></div>
<map name="_tree_quad_coll__map" id="_tree_quad_coll__map">
<area shape="rect" id="node2" href="class_lens_halo.html" title="A base class for all types of lensing halos. " alt="" coords="350,1059,428,1087"/><area shape="rect" id="node23" href="struct_q_tree_n_b.html" title="QTreeNB: Tree structure used for force calculation with particles (i.e. stars, Nbody or halos)..." alt="" coords="697,613,773,641"/><area shape="rect" id="node26" href="struct_q_branch_n_b.html" title="Box representing a branch in a tree. It has four children. Used in QTreeNB which is used in TreeQuad..." alt="" coords="699,293,791,321"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7d4469db6b11bcc0be4aa338e5b3a11a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_quad.html#a7d4469db6b11bcc0be4aa338e5b3a11a">TreeQuad</a> (PosType **xpt, float *my_masses, float *my_sizes, IndexType Npoints, bool Multimass, bool Multisize, PosType my_sigma_background=0, int bucket=5, PosType theta_force=0.1, bool my_periodic_buffer=false, PosType my_inv_screening_scale=0)</td></tr>
<tr class="memdesc:a7d4469db6b11bcc0be4aa338e5b3a11a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor meant for point particles, simulation particles.  <a href="#a7d4469db6b11bcc0be4aa338e5b3a11a">More...</a><br /></td></tr>
<tr class="separator:a7d4469db6b11bcc0be4aa338e5b3a11a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20126155888a4f24f807d6954f002e2e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_quad.html#a20126155888a4f24f807d6954f002e2e">TreeQuad</a> (<a class="el" href="class_lens_halo.html">LensHaloHndl</a> *my_halos, IndexType Npoints, PosType my_sigma_background=0, int bucket=5, PosType theta_force=0.1, bool my_periodic_buffer=false, PosType my_inv_screening_scale=0)</td></tr>
<tr class="memdesc:a20126155888a4f24f807d6954f002e2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor meant for halos with internal structure parameters. This is a protected constructor because it should only be invoked from the derived classes that have specific defined halo models.  <a href="#a20126155888a4f24f807d6954f002e2e">More...</a><br /></td></tr>
<tr class="separator:a20126155888a4f24f807d6954f002e2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a080e354ebac0020230c3e8563c607f2f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a080e354ebac0020230c3e8563c607f2f"></a>
virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_quad.html#a080e354ebac0020230c3e8563c607f2f">~TreeQuad</a> ()</td></tr>
<tr class="memdesc:a080e354ebac0020230c3e8563c607f2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Particle positions and other data are not destroyed. <br /></td></tr>
<tr class="separator:a080e354ebac0020230c3e8563c607f2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1b072d1ff5746c65a9e2f802ea21263"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_quad.html#ad1b072d1ff5746c65a9e2f802ea21263">force2D</a> (PosType const *ray, PosType *alpha, KappaType *kappa, KappaType *gamma, KappaType *phi) const </td></tr>
<tr class="memdesc:ad1b072d1ff5746c65a9e2f802ea21263"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force2D calculates the defection, convergence and shear using the plane-lens approximation. The tree is walked iteratively.  <a href="#ad1b072d1ff5746c65a9e2f802ea21263">More...</a><br /></td></tr>
<tr class="separator:ad1b072d1ff5746c65a9e2f802ea21263"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe96288fca3dcc53a933ede555a4602c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_quad.html#afe96288fca3dcc53a933ede555a4602c">force2D_recur</a> (const PosType *ray, PosType *alpha, KappaType *kappa, KappaType *gamma, KappaType *phi)</td></tr>
<tr class="memdesc:afe96288fca3dcc53a933ede555a4602c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Force2D_recur calculates the defection, convergence and shear using the plane-lens approximation.  <a href="#afe96288fca3dcc53a933ede555a4602c">More...</a><br /></td></tr>
<tr class="separator:afe96288fca3dcc53a933ede555a4602c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d55b3c62b4437c3ad4b1556d81ecc68"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_quad.html#a0d55b3c62b4437c3ad4b1556d81ecc68">neighbors</a> (PosType ray[], PosType rmax, std::list&lt; IndexType &gt; &amp;neighbors) const </td></tr>
<tr class="memdesc:a0d55b3c62b4437c3ad4b1556d81ecc68"><td class="mdescLeft">&#160;</td><td class="mdescRight">find all points within rmax of ray in 2D  <a href="#a0d55b3c62b4437c3ad4b1556d81ecc68">More...</a><br /></td></tr>
<tr class="separator:a0d55b3c62b4437c3ad4b1556d81ecc68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b1705ea52380662e534c9ed2be6e6b0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0b1705ea52380662e534c9ed2be6e6b0"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_quad.html#a0b1705ea52380662e534c9ed2be6e6b0">neighbors</a> (PosType ray[], PosType rmax, std::vector&lt; <a class="el" href="class_lens_halo.html">LensHalo</a> * &gt; &amp;neighbors) const </td></tr>
<tr class="memdesc:a0b1705ea52380662e534c9ed2be6e6b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the halos that are within rmax of ray[]. <br /></td></tr>
<tr class="separator:a0b1705ea52380662e534c9ed2be6e6b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a003e34e8b595c9ea3894fa4fb0a3a3eb"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_quad.html#a003e34e8b595c9ea3894fa4fb0a3a3eb">printParticlesInBranch</a> (unsigned long number)</td></tr>
<tr class="separator:a003e34e8b595c9ea3894fa4fb0a3a3eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba304d815f929be4eb9e1ccd9ee1d901"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_quad.html#aba304d815f929be4eb9e1ccd9ee1d901">printBranchs</a> (int level=-1)</td></tr>
<tr class="separator:aba304d815f929be4eb9e1ccd9ee1d901"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a51bdb9e9957c092e92830cb258a1414d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a51bdb9e9957c092e92830cb258a1414d"></a>
<a class="el" href="struct_q_tree_n_b.html">QTreeNBHndl</a>&#160;</td><td class="memItemRight" valign="bottom"><b>BuildQTreeNB</b> (PosType **xp, IndexType Nparticles, IndexType *particles)</td></tr>
<tr class="separator:a51bdb9e9957c092e92830cb258a1414d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac182b47649a5e11b6b4ea4b2f404f2e9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac182b47649a5e11b6b4ea4b2f404f2e9"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_quad.html#ac182b47649a5e11b6b4ea4b2f404f2e9">_BuildQTreeNB</a> (IndexType nparticles, IndexType *particles)</td></tr>
<tr class="memdesc:ac182b47649a5e11b6b4ea4b2f404f2e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">tree must be created and first branch must be set before start <br /></td></tr>
<tr class="separator:ac182b47649a5e11b6b4ea4b2f404f2e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad80cbecc9ea488f7bcefe86fda53bb21"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad80cbecc9ea488f7bcefe86fda53bb21"></a>
short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_quad.html#ad80cbecc9ea488f7bcefe86fda53bb21">WhichQuad</a> (PosType *x, <a class="el" href="struct_q_branch_n_b.html">QBranchNB</a> &amp;branch)</td></tr>
<tr class="memdesc:ad80cbecc9ea488f7bcefe86fda53bb21"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns an index for which of the four quadrangles of the branch the point x[] is in <br /></td></tr>
<tr class="separator:ad80cbecc9ea488f7bcefe86fda53bb21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acae6952e4391573173f79d071e2c16f9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acae6952e4391573173f79d071e2c16f9"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>inbox</b> (const PosType *ray, const PosType *p1, const PosType *p2)</td></tr>
<tr class="separator:acae6952e4391573173f79d071e2c16f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace60ac745c792ab89b0a34ebc1341f6c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ace60ac745c792ab89b0a34ebc1341f6c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>CalcMoments</b> ()</td></tr>
<tr class="separator:ace60ac745c792ab89b0a34ebc1341f6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af17efeac84204db7c496c5c80c1d572d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af17efeac84204db7c496c5c80c1d572d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_quad.html#af17efeac84204db7c496c5c80c1d572d">rotate_coordinates</a> (PosType **coord)</td></tr>
<tr class="memdesc:af17efeac84204db7c496c5c80c1d572d"><td class="mdescLeft">&#160;</td><td class="mdescRight">simple rotates the coordinates in the xp array <br /></td></tr>
<tr class="separator:af17efeac84204db7c496c5c80c1d572d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5b9e62dead8356ebe1c1b674be24007"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad5b9e62dead8356ebe1c1b674be24007"></a>
virtual PosType&#160;</td><td class="memItemRight" valign="bottom"><b>alpha_h</b> (PosType r2s2, PosType sigma) const </td></tr>
<tr class="separator:ad5b9e62dead8356ebe1c1b674be24007"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab57d70b2987bcd1e3204fda6625e91e8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab57d70b2987bcd1e3204fda6625e91e8"></a>
virtual PosType&#160;</td><td class="memItemRight" valign="bottom"><b>kappa_h</b> (PosType r2s2, PosType sigma) const </td></tr>
<tr class="separator:ab57d70b2987bcd1e3204fda6625e91e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16d0386b8c68a2433795d2b0712d774d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a16d0386b8c68a2433795d2b0712d774d"></a>
virtual PosType&#160;</td><td class="memItemRight" valign="bottom"><b>gamma_h</b> (PosType r2s2, PosType sigma) const </td></tr>
<tr class="separator:a16d0386b8c68a2433795d2b0712d774d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af38acded1828a3848726723e787d4d32"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af38acded1828a3848726723e787d4d32"></a>
virtual PosType&#160;</td><td class="memItemRight" valign="bottom"><b>phi_h</b> (PosType r2s2, PosType sigma) const </td></tr>
<tr class="separator:af38acded1828a3848726723e787d4d32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a9c45f4c8ca6428c1b1b02be4302ea8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1a9c45f4c8ca6428c1b1b02be4302ea8"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>b_spline_profile</b> (PosType *xcm, PosType r, PosType Mass, PosType size, PosType *alpha, KappaType *kappa, KappaType *gamma, KappaType *phi) const </td></tr>
<tr class="separator:a1a9c45f4c8ca6428c1b1b02be4302ea8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecd3c79a0f6591571b13ba12ecb8c6e2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aecd3c79a0f6591571b13ba12ecb8c6e2"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>exponential_profile</b> (PosType *xcm, PosType rcm2, PosType Mass, PosType size, PosType *alpha, KappaType *kappa, KappaType *gamma, KappaType *phi) const </td></tr>
<tr class="separator:aecd3c79a0f6591571b13ba12ecb8c6e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd56034122703166aa8cf377a8054f5b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acd56034122703166aa8cf377a8054f5b"></a>
<a class="el" href="struct_q_tree_n_b.html">QTreeNBHndl</a>&#160;</td><td class="memItemRight" valign="bottom"><b>rotate_simulation</b> (PosType **xp, IndexType Nparticles, IndexType *particles, PosType **coord, PosType theta, float *rsph, float *mass, bool MultiRadius, bool MultiMass)</td></tr>
<tr class="separator:acd56034122703166aa8cf377a8054f5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e68cba8d98cb2b09e0bdbd27f90919c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4e68cba8d98cb2b09e0bdbd27f90919c"></a>
<a class="el" href="struct_q_tree_n_b.html">QTreeNBHndl</a>&#160;</td><td class="memItemRight" valign="bottom"><b>rotate_project</b> (PosType **xp, IndexType Nparticles, IndexType *particles, PosType **coord, PosType theta, float *rsph, float *mass, bool MultiRadius, bool MultiMass)</td></tr>
<tr class="separator:a4e68cba8d98cb2b09e0bdbd27f90919c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1aa0197af585b5b8e5bea7098e79d5c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab1aa0197af585b5b8e5bea7098e79d5c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>cuttoffscale</b> (<a class="el" href="struct_q_tree_n_b.html">QTreeNBHndl</a> tree, PosType *theta)</td></tr>
<tr class="separator:ab1aa0197af585b5b8e5bea7098e79d5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cdead26f7ddade38024544e9bb32723"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1cdead26f7ddade38024544e9bb32723"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>walkTree_recur</b> (<a class="el" href="struct_q_branch_n_b.html">QBranchNB</a> *branch, PosType const *ray, PosType *alpha, KappaType *kappa, KappaType *gamma, KappaType *phi)</td></tr>
<tr class="separator:a1cdead26f7ddade38024544e9bb32723"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77e2f041b0b7f31892bcc079bdacb74f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a77e2f041b0b7f31892bcc079bdacb74f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>walkTree_iter</b> (<a class="el" href="class_q_tree_n_b_1_1iterator.html">QTreeNB::iterator</a> &amp;treeit, PosType const *ray, PosType *alpha, KappaType *kappa, KappaType *gamma, KappaType *phi) const </td></tr>
<tr class="separator:a77e2f041b0b7f31892bcc079bdacb74f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ab197fd80eb2fd9824630a4dd802bc9e9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab197fd80eb2fd9824630a4dd802bc9e9"></a>
PosType **&#160;</td><td class="memItemRight" valign="bottom"><b>xp</b></td></tr>
<tr class="separator:ab197fd80eb2fd9824630a4dd802bc9e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1642fcccfe115968286384ccbe8a6ce2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1642fcccfe115968286384ccbe8a6ce2"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>MultiMass</b></td></tr>
<tr class="separator:a1642fcccfe115968286384ccbe8a6ce2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7041cefcf2343c7d15aec7ca985f6821"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7041cefcf2343c7d15aec7ca985f6821"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>MultiRadius</b></td></tr>
<tr class="separator:a7041cefcf2343c7d15aec7ca985f6821"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bdce5998ecbe385854c29877b863632"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3bdce5998ecbe385854c29877b863632"></a>
float *&#160;</td><td class="memItemRight" valign="bottom"><b>masses</b></td></tr>
<tr class="separator:a3bdce5998ecbe385854c29877b863632"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaab965bc00324fae4365cf41a108729d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aaab965bc00324fae4365cf41a108729d"></a>
float *&#160;</td><td class="memItemRight" valign="bottom"><b>sizes</b></td></tr>
<tr class="separator:aaab965bc00324fae4365cf41a108729d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ea9b82f1344c7bfc66c046b4b5806a8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9ea9b82f1344c7bfc66c046b4b5806a8"></a>
IndexType&#160;</td><td class="memItemRight" valign="bottom"><b>Nparticles</b></td></tr>
<tr class="separator:a9ea9b82f1344c7bfc66c046b4b5806a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2098971b9105114f3304f8977b744445"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2098971b9105114f3304f8977b744445"></a>
PosType&#160;</td><td class="memItemRight" valign="bottom"><b>sigma_background</b></td></tr>
<tr class="separator:a2098971b9105114f3304f8977b744445"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad93fc45850e1c895cdb1de0ae4cc6e64"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad93fc45850e1c895cdb1de0ae4cc6e64"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>Nbucket</b></td></tr>
<tr class="separator:ad93fc45850e1c895cdb1de0ae4cc6e64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad36e701e697550952482ed34716c49af"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad36e701e697550952482ed34716c49af"></a>
PosType&#160;</td><td class="memItemRight" valign="bottom"><b>force_theta</b></td></tr>
<tr class="separator:ad36e701e697550952482ed34716c49af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e4c49404246c73676433d3d4bdcea77"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1e4c49404246c73676433d3d4bdcea77"></a>
<a class="el" href="struct_q_tree_n_b.html">QTreeNBHndl</a>&#160;</td><td class="memItemRight" valign="bottom"><b>tree</b></td></tr>
<tr class="separator:a1e4c49404246c73676433d3d4bdcea77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af205f44a952e478fdfa76e41e66c36d5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af205f44a952e478fdfa76e41e66c36d5"></a>
IndexType *&#160;</td><td class="memItemRight" valign="bottom"><b>index</b></td></tr>
<tr class="separator:af205f44a952e478fdfa76e41e66c36d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52bd1ff80d45ccdf98dc939f75daec5d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a52bd1ff80d45ccdf98dc939f75daec5d"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>haloON</b></td></tr>
<tr class="separator:a52bd1ff80d45ccdf98dc939f75daec5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a179dccde16c62cd24cdbdef2a88228fc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a179dccde16c62cd24cdbdef2a88228fc"></a>
<a class="el" href="class_lens_halo.html">LensHaloHndl</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>halos</b></td></tr>
<tr class="separator:a179dccde16c62cd24cdbdef2a88228fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada35011f31f57a39f504301152a0332d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ada35011f31f57a39f504301152a0332d"></a>
PosType&#160;</td><td class="memItemRight" valign="bottom"><b>realray</b> [2]</td></tr>
<tr class="separator:ada35011f31f57a39f504301152a0332d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0fcf542aa59e3afef705ec8e42a1239"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa0fcf542aa59e3afef705ec8e42a1239"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>incell</b></td></tr>
<tr class="separator:aa0fcf542aa59e3afef705ec8e42a1239"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac50f5cc5d7260057bc7b300dce4f7c9b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac50f5cc5d7260057bc7b300dce4f7c9b"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>incell2</b></td></tr>
<tr class="separator:ac50f5cc5d7260057bc7b300dce4f7c9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cec88e133be76c73850757eec25c1cb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4cec88e133be76c73850757eec25c1cb"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_quad.html#a4cec88e133be76c73850757eec25c1cb">periodic_buffer</a></td></tr>
<tr class="memdesc:a4cec88e133be76c73850757eec25c1cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">if true there is one layer of peridic buffering <br /></td></tr>
<tr class="separator:a4cec88e133be76c73850757eec25c1cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0279aec52a9c9393063bd58c5646f136"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0279aec52a9c9393063bd58c5646f136"></a>
PosType&#160;</td><td class="memItemRight" valign="bottom"><b>inv_screening_scale2</b></td></tr>
<tr class="separator:a0279aec52a9c9393063bd58c5646f136"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4939a03faf3932f23f6259f23ae962ed"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4939a03faf3932f23f6259f23ae962ed"></a>
PosType&#160;</td><td class="memItemRight" valign="bottom"><b>original_xl</b></td></tr>
<tr class="separator:a4939a03faf3932f23f6259f23ae962ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adda4c18969329fdde76544b0ce448906"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adda4c18969329fdde76544b0ce448906"></a>
PosType&#160;</td><td class="memItemRight" valign="bottom"><b>original_yl</b></td></tr>
<tr class="separator:adda4c18969329fdde76544b0ce448906"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a529886b8cd5abbed1d52cb39469056f3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a529886b8cd5abbed1d52cb39469056f3"></a>
PosType&#160;</td><td class="memItemRight" valign="bottom"><b>phiintconst</b></td></tr>
<tr class="separator:a529886b8cd5abbed1d52cb39469056f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="class_tree_quad.html" title="TreeQuad is a class for calculating the deflection, kappa and gamma by tree method. ">TreeQuad</a> is a class for calculating the deflection, kappa and gamma by tree method. </p>
<p><a class="el" href="class_tree_quad.html" title="TreeQuad is a class for calculating the deflection, kappa and gamma by tree method. ">TreeQuad</a> is evolved from <a class="el" href="class_tree_simple.html" title="A C++ class wrapper for the bianary treeNB used in the Nobody force calculation, but also useful for ...">TreeSimple</a> and <a class="el" href="class_tree_force.html" title="Object used to calculate the force or deflection caused by a collection of &quot;particles&quot; by the tree me...">TreeForce</a>. It splits each cell into four equal area subcells instead of being a binary tree like <a class="el" href="class_tree_simple.html" title="A C++ class wrapper for the bianary treeNB used in the Nobody force calculation, but also useful for ...">TreeSimple</a>. When the "particles" are given sizes the tree is built in such a way the large particles are stored in branches that are no smaller than their size. In this way particles are stored on all levels of the tree and not just in the leaves. This improves efficiency when particles of a wide range of sizes overlap in 2D.</p>
<p>The default value of theta = 0.1 generally gives better than 1% accuracy on alpha. The shear and kappa is always more accurate than the deflection. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a7d4469db6b11bcc0be4aa338e5b3a11a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TreeQuad::TreeQuad </td>
          <td>(</td>
          <td class="paramtype">PosType **&#160;</td>
          <td class="paramname"><em>xpt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>my_masses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>my_sizes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IndexType&#160;</td>
          <td class="paramname"><em>Npoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>Multimass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>Multisize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PosType&#160;</td>
          <td class="paramname"><em>my_sigma_background</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bucket</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PosType&#160;</td>
          <td class="paramname"><em>theta_force</em> = <code>0.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>my_periodic_buffer</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PosType&#160;</td>
          <td class="paramname"><em>my_inv_screening_scale</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor meant for point particles, simulation particles. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">my_sigma_background</td><td>background kappa that is subtracted </td></tr>
    <tr><td class="paramname">my_periodic_buffer</td><td>if true a periodic buffer will be imposed in the force calulation. See documentation on <a class="el" href="class_tree_quad.html#ad1b072d1ff5746c65a9e2f802ea21263" title="Force2D calculates the defection, convergence and shear using the plane-lens approximation. The tree is walked iteratively. ">TreeQuad::force2D()</a> for details. See note for <a class="el" href="class_tree_quad.html#afe96288fca3dcc53a933ede555a4602c" title="Force2D_recur calculates the defection, convergence and shear using the plane-lens approximation...">TreeQuad::force2D_recur()</a>. </td></tr>
    <tr><td class="paramname">my_inv_screening_scale</td><td>the inverse of the square of the sreening length. See note for <a class="el" href="class_tree_quad.html#afe96288fca3dcc53a933ede555a4602c" title="Force2D_recur calculates the defection, convergence and shear using the plane-lens approximation...">TreeQuad::force2D_recur()</a>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a20126155888a4f24f807d6954f002e2e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TreeQuad::TreeQuad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_lens_halo.html">LensHaloHndl</a> *&#160;</td>
          <td class="paramname"><em>my_halos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IndexType&#160;</td>
          <td class="paramname"><em>Npoints</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PosType&#160;</td>
          <td class="paramname"><em>my_sigma_background</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bucket</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PosType&#160;</td>
          <td class="paramname"><em>theta_force</em> = <code>0.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>periodic_buffer</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PosType&#160;</td>
          <td class="paramname"><em>my_inv_screening_scale</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor meant for halos with internal structure parameters. This is a protected constructor because it should only be invoked from the derived classes that have specific defined halo models. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">my_halos</td><td>list of halos to be put in tree </td></tr>
    <tr><td class="paramname">Npoints</td><td>number of halos </td></tr>
    <tr><td class="paramname">my_sigma_background</td><td>background kappa that is subtracted </td></tr>
    <tr><td class="paramname">bucket</td><td>maximum number of halos in each leaf of the tree </td></tr>
    <tr><td class="paramname">theta_force</td><td>the openning angle used in the criterion for decending into a subcell </td></tr>
    <tr><td class="paramname">periodic_buffer</td><td>if true a periodic buffer will be imposed in the force calulation. See documentation on <a class="el" href="class_tree_quad.html#ad1b072d1ff5746c65a9e2f802ea21263" title="Force2D calculates the defection, convergence and shear using the plane-lens approximation. The tree is walked iteratively. ">TreeQuad::force2D()</a> for details. See note for <a class="el" href="class_tree_quad.html#afe96288fca3dcc53a933ede555a4602c" title="Force2D_recur calculates the defection, convergence and shear using the plane-lens approximation...">TreeQuad::force2D_recur()</a>. </td></tr>
    <tr><td class="paramname">my_inv_screening_scale</td><td>the inverse of the square of the sreening length. See note for <a class="el" href="class_tree_quad.html#afe96288fca3dcc53a933ede555a4602c" title="Force2D_recur calculates the defection, convergence and shear using the plane-lens approximation...">TreeQuad::force2D_recur()</a>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ad1b072d1ff5746c65a9e2f802ea21263"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void TreeQuad::force2D </td>
          <td>(</td>
          <td class="paramtype">PosType const *&#160;</td>
          <td class="paramname"><em>ray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PosType *&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">KappaType *&#160;</td>
          <td class="paramname"><em>kappa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">KappaType *&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">KappaType *&#160;</td>
          <td class="paramname"><em>phi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Force2D calculates the defection, convergence and shear using the plane-lens approximation. The tree is walked iteratively. </p>
<p>The output alpha[] is in units of mass_scale/Mpc, ie it needs to be divided by Sigma_crit and multiplied by mass_scale to be the deflection in the lens equation expressed on the lens plane or multiplied by 4*pi*G*mass_scale to get the deflection angle caused by the plane lens.</p>
<p>kappa and gamma need to by multiplied by mass_scale/Sigma_crit to get the traditional units for these where Sigma_crit are in the mass/units(ray)^2 NB : the units of sigma_backgound need to be mass/units(ray)^2</p>
<p>If periodic_buffer == true a periodic buffer is included. The ray is calculated as if there where identical copies of it on the borders of the tree's root branch. This is not the same thing as periodic boundary conditions, because there are not an infinite number of copies in all direction as for the DFT force solver.</p>
<p>If inv_screening_scale2 != 0 the mass of cells are reduced by a factor of exp(-|ray - center of mass|^2*inv_screening_scale2) which screens the large scale geometry of the simulation on the sky. This is useful when the region is rectangular instead of circular. </p>

</div>
</div>
<a class="anchor" id="afe96288fca3dcc53a933ede555a4602c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void TreeQuad::force2D_recur </td>
          <td>(</td>
          <td class="paramtype">const PosType *&#160;</td>
          <td class="paramname"><em>ray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PosType *&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">KappaType *&#160;</td>
          <td class="paramname"><em>kappa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">KappaType *&#160;</td>
          <td class="paramname"><em>gamma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">KappaType *&#160;</td>
          <td class="paramname"><em>phi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Force2D_recur calculates the defection, convergence and shear using the plane-lens approximation. </p>
<p>This function should do the same work as <a class="el" href="class_tree_quad.html#ad1b072d1ff5746c65a9e2f802ea21263" title="Force2D calculates the defection, convergence and shear using the plane-lens approximation. The tree is walked iteratively. ">TreeQuad::force2D()</a> except it is done recursively instead of iteratively. This is done to enable multi-threading of the force calculation. </p><pre class="fragment"> The output alpha[] is in units of mass_scale/Mpc, ie it needs to be
 divided by Sigma_crit and multiplied by mass_scale to be the deflection
 in the lens equation expressed on the lens plane or multiplied by
 4*pi*G*mass_scale to get the deflection angle caused by the plane lens.

 kappa and gamma need to by multiplied by mass_scale/Sigma_crit to get
 the traditional units for these where Sigma_crit are in the mass/units(ray)^2
 NB : the units of sigma_backgound need to be mass/units(ray)^2
</pre><p>If periodic_buffer == true a periodic buffer is included. The ray is calculated as if there where identical copies of it on the borders of the tree's root branch. This is not the same thing as periodic boundary conditions, because there are not an infinite number of copies in all direction as for the DFT force solver.</p>
<p>If inv_screening_scale2 != 0 the mass of cells are reduced by a factor of exp(-|ray - center of mass|^2*inv_screening_scale2) which screens the large scale geometry of the simulation on the sky. This is useful when the region is rectangular instead of circular. </p>

</div>
</div>
<a class="anchor" id="a0d55b3c62b4437c3ad4b1556d81ecc68"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TreeQuad::neighbors </td>
          <td>(</td>
          <td class="paramtype">PosType&#160;</td>
          <td class="paramname"><em>ray</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PosType&#160;</td>
          <td class="paramname"><em>rmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::list&lt; IndexType &gt; &amp;&#160;</td>
          <td class="paramname"><em>neighbors</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find all points within rmax of ray in 2D </p>
<p>Returns the halos that are within rmax of ray[]. </p>

</div>
</div>
<a class="anchor" id="aba304d815f929be4eb9e1ccd9ee1d901"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void TreeQuad::printBranchs </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>level</em> = <code>-1</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Prints to stdout the borders of each branch in the tree below level. If level &lt; 0 or not specified the whole tree will be printed. </p>

</div>
</div>
<a class="anchor" id="a003e34e8b595c9ea3894fa4fb0a3a3eb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void TreeQuad::printParticlesInBranch </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>number</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is a diagnostic routine that prints the position of every point in a given branch of the tree. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>SLsimLib/include/<a class="el" href="quad_tree_8h_source.html">quadTree.h</a></li>
<li>SLsimLib/TreeCode/quadTree.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jun 5 2017 16:22:17 for GLAMERDOC++ by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
