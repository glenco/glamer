<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GLAMERDOC++: TreeForce Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">GLAMERDOC++
   </div>
   <div id="projectbrief">Gravitational Lensing Code Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="class_tree_force-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">TreeForce Class Reference<div class="ingroups"><a class="el" href="group___deflection_l2.html">Deflection Solver</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Object used to calculate the force or deflection caused by a collection of "particles" by the tree method.  
 <a href="#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="force_tree_8h_source.html">forceTree.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for TreeForce:</div>
<div class="dyncontent">
<div class="center"><img src="class_tree_force__inherit__graph.png" border="0" usemap="#a_tree_force_inherit__map" alt="Inheritance graph"/></div>
<map name="a_tree_force_inherit__map" id="a_tree_force_inherit__map">
<area shape="rect" title="Object used to calculate the force or deflection caused by a collection of &quot;particles&quot; by the tree me..." alt="" coords="39,80,121,107"/>
<area shape="rect" href="class_tree_simple.html" title="A C++ class wrapper for the bianary treeNB used in the Nbody force calculation, but also useful for g..." alt="" coords="5,5,155,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for TreeForce:</div>
<div class="dyncontent">
<div class="center"><img src="class_tree_force__coll__graph.png" border="0" usemap="#a_tree_force_coll__map" alt="Collaboration graph"/></div>
<map name="a_tree_force_coll__map" id="a_tree_force_coll__map">
<area shape="rect" title="Object used to calculate the force or deflection caused by a collection of &quot;particles&quot; by the tree me..." alt="" coords="107,95,189,121"/>
<area shape="rect" href="class_tree_simple.html" title="A C++ class wrapper for the bianary treeNB used in the Nbody force calculation, but also useful for g..." alt="" coords="5,5,155,32"/>
<area shape="rect" href="class_lens_halo.html" title="A base class for all types of lensing &quot;halos&quot; which are any mass distribution that cause lensing." alt="" coords="179,5,256,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:adeabe49704610a41cadfa7f04db796a1" id="r_adeabe49704610a41cadfa7f04db796a1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#adeabe49704610a41cadfa7f04db796a1">TreeForce</a> (PosType **xp, IndexType Npoints, float *<a class="el" href="#aaf5bfc6384c6717f967d888fbd7fcb24">masses</a>, float *<a class="el" href="#a77be3597cacacfb4c108a32cf3eeed1f">rsph</a>, bool Multimass, bool Multisize, PosType my_kappa_background=0, int bucket=5, int dimensions=2, bool median=false, PosType theta=0.1)</td></tr>
<tr class="separator:adeabe49704610a41cadfa7f04db796a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1fceae859e1c8badda8437c88cb175f6" id="r_a1fceae859e1c8badda8437c88cb175f6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a1fceae859e1c8badda8437c88cb175f6">TreeForce</a> (PosType **xp, IndexType Npoints, <a class="el" href="class_lens_halo.html">LensHalo</a> *my_halos, bool Multisize=true, PosType my_kappa_bk=0.0, int bucket=5, int dimensions=2, bool median=false, PosType theta=0.1)</td></tr>
<tr class="separator:a1fceae859e1c8badda8437c88cb175f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9939e82b46c3b59952adb71a6f4406f" id="r_af9939e82b46c3b59952adb71a6f4406f"><td class="memItemLeft" align="right" valign="top"><a id="af9939e82b46c3b59952adb71a6f4406f" name="af9939e82b46c3b59952adb71a6f4406f"></a>
float *&#160;</td><td class="memItemRight" valign="bottom"><b>CalculateSPHsmoothing</b> (int N)</td></tr>
<tr class="memdesc:af9939e82b46c3b59952adb71a6f4406f"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculated sph smoothing and store them in the tree, also provide pointer to them <br /></td></tr>
<tr class="separator:af9939e82b46c3b59952adb71a6f4406f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3259836d3275204c9a3a68e10c9da7b2" id="r_a3259836d3275204c9a3a68e10c9da7b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3259836d3275204c9a3a68e10c9da7b2">force2D</a> (PosType const *ray, PosType *alpha, KappaType *kappa, KappaType *gamma, KappaType *phi)</td></tr>
<tr class="memdesc:a3259836d3275204c9a3a68e10c9da7b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculate the deflection and lensing propertie  <br /></td></tr>
<tr class="separator:a3259836d3275204c9a3a68e10c9da7b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_class_tree_simple"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pub_methods_class_tree_simple')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="class_tree_simple.html">TreeSimple&lt; PType &gt;</a></td></tr>
<tr class="memitem:ac421113f963e72ed395fb4a334c94c6e inherit pub_methods_class_tree_simple" id="r_ac421113f963e72ed395fb4a334c94c6e"><td class="memItemLeft" align="right" valign="top">
&#160;</td><td class="memItemRight" valign="bottom"><b>TreeSimple</b> (PType *xp, IndexType Npoints, int bucket=5, int dimensions=2, bool median=true)</td></tr>
<tr class="separator:ac421113f963e72ed395fb4a334c94c6e inherit pub_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6cbac2c13bdb37f107eb411877bdfea inherit pub_methods_class_tree_simple" id="r_af6cbac2c13bdb37f107eb411877bdfea"><td class="memTemplParams" colspan="2">
template&lt;typename T &gt; </td></tr>
<tr class="memitem:af6cbac2c13bdb37f107eb411877bdfea inherit pub_methods_class_tree_simple"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><b>PointsWithinCircle</b> (T center[2], float radius, std::list&lt; unsigned long &gt; &amp;neighborkist)</td></tr>
<tr class="memdesc:af6cbac2c13bdb37f107eb411877bdfea inherit pub_methods_class_tree_simple"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the points within a circle around center and puts their index numbers in a list. <br /></td></tr>
<tr class="separator:af6cbac2c13bdb37f107eb411877bdfea inherit pub_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bfcfb60b036c3393546d43b67509ee5 inherit pub_methods_class_tree_simple" id="r_a4bfcfb60b036c3393546d43b67509ee5"><td class="memTemplParams" colspan="2">
template&lt;typename T &gt; </td></tr>
<tr class="memitem:a4bfcfb60b036c3393546d43b67509ee5 inherit pub_methods_class_tree_simple"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><b>PointsWithinEllipse</b> (T center[2], float a_max, float a_min, float posangle, std::list&lt; unsigned long &gt; &amp;neighborkist)</td></tr>
<tr class="memdesc:a4bfcfb60b036c3393546d43b67509ee5 inherit pub_methods_class_tree_simple"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the points within an ellipse around center and puts their index numbers in a list. <br /></td></tr>
<tr class="separator:a4bfcfb60b036c3393546d43b67509ee5 inherit pub_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a679035c518472da2b5ee4349f6098a02 inherit pub_methods_class_tree_simple" id="r_a679035c518472da2b5ee4349f6098a02"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a679035c518472da2b5ee4349f6098a02 inherit pub_methods_class_tree_simple"><td class="memTemplItemLeft" align="right" valign="top">T&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="class_tree_simple.html#a679035c518472da2b5ee4349f6098a02">NNDistance</a> (T *ray, int Nneighbors) const</td></tr>
<tr class="memdesc:a679035c518472da2b5ee4349f6098a02 inherit pub_methods_class_tree_simple"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finds the nearest N neighbors and puts their index numbers in an array, also returns the distance to the Nth neighbor for calculating smoothing.  <br /></td></tr>
<tr class="separator:a679035c518472da2b5ee4349f6098a02 inherit pub_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a833bd1da5c170273db01a6d1c76f8618 inherit pub_methods_class_tree_simple" id="r_a833bd1da5c170273db01a6d1c76f8618"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a833bd1da5c170273db01a6d1c76f8618 inherit pub_methods_class_tree_simple"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="class_tree_simple.html#a833bd1da5c170273db01a6d1c76f8618">PointsWithinEllipse</a> (T *ray, float rmax, float rmin, float posangle, std::list&lt; unsigned long &gt; &amp;neighborlist)</td></tr>
<tr class="separator:a833bd1da5c170273db01a6d1c76f8618 inherit pub_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa434956ba070e6af6ff8d42938a79716 inherit pub_methods_class_tree_simple" id="r_aa434956ba070e6af6ff8d42938a79716"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:aa434956ba070e6af6ff8d42938a79716 inherit pub_methods_class_tree_simple"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="class_tree_simple.html#aa434956ba070e6af6ff8d42938a79716">PointsWithinCircle</a> (T *ray, float rmax, std::list&lt; unsigned long &gt; &amp;neighborlist)</td></tr>
<tr class="separator:aa434956ba070e6af6ff8d42938a79716 inherit pub_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a40975fd223310857fe6e4efae50190eb" id="r_a40975fd223310857fe6e4efae50190eb"><td class="memItemLeft" align="right" valign="top"><a id="a40975fd223310857fe6e4efae50190eb" name="a40975fd223310857fe6e4efae50190eb"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>CalcMoments</b> ()</td></tr>
<tr class="separator:a40975fd223310857fe6e4efae50190eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e124dae6aa348df5e7398d68e20d0ec" id="r_a4e124dae6aa348df5e7398d68e20d0ec"><td class="memItemLeft" align="right" valign="top"><a id="a4e124dae6aa348df5e7398d68e20d0ec" name="a4e124dae6aa348df5e7398d68e20d0ec"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>rotate_coordinates</b> (PosType **coord)</td></tr>
<tr class="memdesc:a4e124dae6aa348df5e7398d68e20d0ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">simple rotates the coordinates in the xp array <br /></td></tr>
<tr class="separator:a4e124dae6aa348df5e7398d68e20d0ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a155b70e1721702765af6cbe8934b24c1" id="r_a155b70e1721702765af6cbe8934b24c1"><td class="memItemLeft" align="right" valign="top"><a id="a155b70e1721702765af6cbe8934b24c1" name="a155b70e1721702765af6cbe8934b24c1"></a>
virtual PosType&#160;</td><td class="memItemRight" valign="bottom"><b>alpha_h</b> (PosType r2s2, PosType sigma)</td></tr>
<tr class="separator:a155b70e1721702765af6cbe8934b24c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d2fe0bb9b78246e50fd35e66cbe8bdb" id="r_a0d2fe0bb9b78246e50fd35e66cbe8bdb"><td class="memItemLeft" align="right" valign="top"><a id="a0d2fe0bb9b78246e50fd35e66cbe8bdb" name="a0d2fe0bb9b78246e50fd35e66cbe8bdb"></a>
virtual PosType&#160;</td><td class="memItemRight" valign="bottom"><b>kappa_h</b> (PosType r2s2, PosType sigma)</td></tr>
<tr class="separator:a0d2fe0bb9b78246e50fd35e66cbe8bdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98070fc4a2184a177bf3b7e97dd2b894" id="r_a98070fc4a2184a177bf3b7e97dd2b894"><td class="memItemLeft" align="right" valign="top"><a id="a98070fc4a2184a177bf3b7e97dd2b894" name="a98070fc4a2184a177bf3b7e97dd2b894"></a>
virtual PosType&#160;</td><td class="memItemRight" valign="bottom"><b>gamma_h</b> (PosType r2s2, PosType sigma)</td></tr>
<tr class="separator:a98070fc4a2184a177bf3b7e97dd2b894"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2989d4456b539884016138e58654d531" id="r_a2989d4456b539884016138e58654d531"><td class="memItemLeft" align="right" valign="top"><a id="a2989d4456b539884016138e58654d531" name="a2989d4456b539884016138e58654d531"></a>
virtual PosType&#160;</td><td class="memItemRight" valign="bottom"><b>phi_o</b> (PosType r2, PosType sigma)</td></tr>
<tr class="separator:a2989d4456b539884016138e58654d531"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_class_tree_simple"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pro_methods_class_tree_simple')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="class_tree_simple.html">TreeSimple&lt; PType &gt;</a></td></tr>
<tr class="memitem:ac71a9dc1577110130d45d6c6bbff1199 inherit pro_methods_class_tree_simple" id="r_ac71a9dc1577110130d45d6c6bbff1199"><td class="memItemLeft" align="right" valign="top">
<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *&#160;</td><td class="memItemRight" valign="bottom"><b>BuildTreeNB</b> (PType *xxp, IndexType Nparticles, IndexType *particles, int Ndimensions, PosType theta)</td></tr>
<tr class="separator:ac71a9dc1577110130d45d6c6bbff1199 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a583a62b40126c7842175b758157c16b7 inherit pro_methods_class_tree_simple" id="r_a583a62b40126c7842175b758157c16b7"><td class="memItemLeft" align="right" valign="top">
void&#160;</td><td class="memItemRight" valign="bottom"><b>_BuildTreeNB</b> (<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *tree, IndexType nparticles, IndexType *particles)</td></tr>
<tr class="separator:a583a62b40126c7842175b758157c16b7 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb44c200eed8e2acd698796ae5b78b74 inherit pro_methods_class_tree_simple" id="r_afb44c200eed8e2acd698796ae5b78b74"><td class="memTemplParams" colspan="2">
template&lt;typename T &gt; </td></tr>
<tr class="memitem:afb44c200eed8e2acd698796ae5b78b74 inherit pro_methods_class_tree_simple"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><b>_findleaf</b> (T *ray, TreeSimple::iterator &amp;it) const</td></tr>
<tr class="separator:afb44c200eed8e2acd698796ae5b78b74 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00689f8ece60bd298e376a1d16dd08da inherit pro_methods_class_tree_simple" id="r_a00689f8ece60bd298e376a1d16dd08da"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a00689f8ece60bd298e376a1d16dd08da inherit pro_methods_class_tree_simple"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="class_tree_simple.html#a00689f8ece60bd298e376a1d16dd08da">_PointsWithin</a> (T *ray, float *rmax, std::list&lt; unsigned long &gt; &amp;neighborkist)</td></tr>
<tr class="separator:a00689f8ece60bd298e376a1d16dd08da inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdaf208f665887ce9d2b6e27005548a7 inherit pro_methods_class_tree_simple" id="r_acdaf208f665887ce9d2b6e27005548a7"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:acdaf208f665887ce9d2b6e27005548a7 inherit pro_methods_class_tree_simple"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="class_tree_simple.html#acdaf208f665887ce9d2b6e27005548a7">_NearestNeighbors</a> (T *ray, int Nneighbors, unsigned long *neighbors, PosType *rneighbors)</td></tr>
<tr class="separator:acdaf208f665887ce9d2b6e27005548a7 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a155fe08dba52e39388c12461c6efc304 inherit pro_methods_class_tree_simple" id="r_a155fe08dba52e39388c12461c6efc304"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_branch_n_b.html">BranchNB</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_simple.html#a155fe08dba52e39388c12461c6efc304">NewBranchNB</a> (IndexType *particles, IndexType nparticles, PosType boundary_p1[], PosType boundary_p2[], PosType center[], int level, unsigned long branchNBnumber)</td></tr>
<tr class="separator:a155fe08dba52e39388c12461c6efc304 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29f7197db38b03b81f8146468e48ffa2 inherit pro_methods_class_tree_simple" id="r_a29f7197db38b03b81f8146468e48ffa2"><td class="memItemLeft" align="right" valign="top">
void&#160;</td><td class="memItemRight" valign="bottom"><b>FreeBranchNB</b> (<a class="el" href="struct_branch_n_b.html">BranchNB</a> *branchNB)</td></tr>
<tr class="separator:a29f7197db38b03b81f8146468e48ffa2 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1a673ca55e41b0c582958a4db38fac9 inherit pro_methods_class_tree_simple" id="r_ae1a673ca55e41b0c582958a4db38fac9"><td class="memItemLeft" align="right" valign="top">
<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *&#160;</td><td class="memItemRight" valign="bottom"><b>NewTreeNB</b> (IndexType *particles, IndexType nparticles, PosType boundary_p1[], PosType boundary_p2[], PosType center[], short Ndimensions)</td></tr>
<tr class="separator:ae1a673ca55e41b0c582958a4db38fac9 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a845c054d38f9a33752150638b4c69f01 inherit pro_methods_class_tree_simple" id="r_a845c054d38f9a33752150638b4c69f01"><td class="memItemLeft" align="right" valign="top">
void&#160;</td><td class="memItemRight" valign="bottom"><b>freeTreeNB</b> (<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *tree)</td></tr>
<tr class="separator:a845c054d38f9a33752150638b4c69f01 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a32c3b0d04e9a3956b622e69eb70b842b inherit pro_methods_class_tree_simple" id="r_a32c3b0d04e9a3956b622e69eb70b842b"><td class="memItemLeft" align="right" valign="top">
short&#160;</td><td class="memItemRight" valign="bottom"><b>emptyTreeNB</b> (<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *tree)</td></tr>
<tr class="separator:a32c3b0d04e9a3956b622e69eb70b842b inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec6eeb30d2d41ae69267927d7329e498 inherit pro_methods_class_tree_simple" id="r_aec6eeb30d2d41ae69267927d7329e498"><td class="memItemLeft" align="right" valign="top">
void&#160;</td><td class="memItemRight" valign="bottom"><b>_freeTreeNB</b> (<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *tree, short child)</td></tr>
<tr class="separator:aec6eeb30d2d41ae69267927d7329e498 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3f44fa79150076715d5bd954cd9ab15 inherit pro_methods_class_tree_simple" id="r_aa3f44fa79150076715d5bd954cd9ab15"><td class="memItemLeft" align="right" valign="top">
bool&#160;</td><td class="memItemRight" valign="bottom"><b>isEmptyNB</b> (<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *tree)</td></tr>
<tr class="separator:aa3f44fa79150076715d5bd954cd9ab15 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a011d262211dd25798303615460f730a6 inherit pro_methods_class_tree_simple" id="r_a011d262211dd25798303615460f730a6"><td class="memItemLeft" align="right" valign="top">
bool&#160;</td><td class="memItemRight" valign="bottom"><b>atTopNB</b> (<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *tree)</td></tr>
<tr class="separator:a011d262211dd25798303615460f730a6 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a713bed64196efc96c7770d759573ad51 inherit pro_methods_class_tree_simple" id="r_a713bed64196efc96c7770d759573ad51"><td class="memItemLeft" align="right" valign="top">
bool&#160;</td><td class="memItemRight" valign="bottom"><b>noChildNB</b> (<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *tree)</td></tr>
<tr class="separator:a713bed64196efc96c7770d759573ad51 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a81ad081e36f4581adf2ca3b6dd209f inherit pro_methods_class_tree_simple" id="r_a1a81ad081e36f4581adf2ca3b6dd209f"><td class="memItemLeft" align="right" valign="top">
bool&#160;</td><td class="memItemRight" valign="bottom"><b>offEndNB</b> (<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *tree)</td></tr>
<tr class="separator:a1a81ad081e36f4581adf2ca3b6dd209f inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa35e689478228cfd51b88d722818a8a6 inherit pro_methods_class_tree_simple" id="r_aa35e689478228cfd51b88d722818a8a6"><td class="memItemLeft" align="right" valign="top">
void&#160;</td><td class="memItemRight" valign="bottom"><b>getCurrentNB</b> (<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *tree, IndexType *particles, IndexType *nparticles)</td></tr>
<tr class="separator:aa35e689478228cfd51b88d722818a8a6 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d09da58f74e52674fb21fb773f12a63 inherit pro_methods_class_tree_simple" id="r_a4d09da58f74e52674fb21fb773f12a63"><td class="memItemLeft" align="right" valign="top">
unsigned long&#160;</td><td class="memItemRight" valign="bottom"><b>getNbranchesNB</b> (<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *tree)</td></tr>
<tr class="separator:a4d09da58f74e52674fb21fb773f12a63 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fd9284d6a1fc9c1ab0fd0c4b3a96e70 inherit pro_methods_class_tree_simple" id="r_a5fd9284d6a1fc9c1ab0fd0c4b3a96e70"><td class="memItemLeft" align="right" valign="top">
void&#160;</td><td class="memItemRight" valign="bottom"><b>moveTopNB</b> (<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *tree)</td></tr>
<tr class="separator:a5fd9284d6a1fc9c1ab0fd0c4b3a96e70 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfb8055b1b8a68cce5b498d3067f68fe inherit pro_methods_class_tree_simple" id="r_acfb8055b1b8a68cce5b498d3067f68fe"><td class="memItemLeft" align="right" valign="top">
void&#160;</td><td class="memItemRight" valign="bottom"><b>moveUpNB</b> (<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *tree)</td></tr>
<tr class="separator:acfb8055b1b8a68cce5b498d3067f68fe inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72bdb9da61cd9ca3fb012e1c8f87ffac inherit pro_methods_class_tree_simple" id="r_a72bdb9da61cd9ca3fb012e1c8f87ffac"><td class="memItemLeft" align="right" valign="top">
void&#160;</td><td class="memItemRight" valign="bottom"><b>moveToChildNB</b> (<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *tree, int child)</td></tr>
<tr class="separator:a72bdb9da61cd9ca3fb012e1c8f87ffac inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a43e3aa665078fe83d0528b8e5de8a4 inherit pro_methods_class_tree_simple" id="r_a9a43e3aa665078fe83d0528b8e5de8a4"><td class="memItemLeft" align="right" valign="top">
void&#160;</td><td class="memItemRight" valign="bottom"><b>insertChildToCurrentNB</b> (<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *tree, IndexType *particles, IndexType nparticles, PosType boundary_p1[], PosType boundary_p2[], PosType center[], int child)</td></tr>
<tr class="separator:a9a43e3aa665078fe83d0528b8e5de8a4 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa41023243613d6baf820fc6ce5417970 inherit pro_methods_class_tree_simple" id="r_aa41023243613d6baf820fc6ce5417970"><td class="memItemLeft" align="right" valign="top">
void&#160;</td><td class="memItemRight" valign="bottom"><b>attachChildToCurrentNB</b> (<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *tree, <a class="el" href="struct_branch_n_b.html">BranchNB</a> &amp;data, int child)</td></tr>
<tr class="separator:aa41023243613d6baf820fc6ce5417970 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bfda34b54c25bd7ff33f56d78d31923 inherit pro_methods_class_tree_simple" id="r_a2bfda34b54c25bd7ff33f56d78d31923"><td class="memItemLeft" align="right" valign="top">
bool&#160;</td><td class="memItemRight" valign="bottom"><b>TreeNBWalkStep</b> (<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *tree, bool allowDescent)</td></tr>
<tr class="separator:a2bfda34b54c25bd7ff33f56d78d31923 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ed22edbda487903fa9e447522e23d30 inherit pro_methods_class_tree_simple" id="r_a7ed22edbda487903fa9e447522e23d30"><td class="memItemLeft" align="right" valign="top">
bool&#160;</td><td class="memItemRight" valign="bottom"><b>atLeaf</b> ()</td></tr>
<tr class="separator:a7ed22edbda487903fa9e447522e23d30 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86d4477c3dc38da2875f713f79d4ee87 inherit pro_methods_class_tree_simple" id="r_a86d4477c3dc38da2875f713f79d4ee87"><td class="memTemplParams" colspan="2">
template&lt;typename T &gt; </td></tr>
<tr class="memitem:a86d4477c3dc38da2875f713f79d4ee87 inherit pro_methods_class_tree_simple"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><b>inbox</b> (const T *center, PosType *p1, PosType *p2) const</td></tr>
<tr class="separator:a86d4477c3dc38da2875f713f79d4ee87 inherit pro_methods_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:adefb6e7b1cc3a3fff2d2d0eeb6cb1f78" id="r_adefb6e7b1cc3a3fff2d2d0eeb6cb1f78"><td class="memItemLeft" align="right" valign="top"><a id="adefb6e7b1cc3a3fff2d2d0eeb6cb1f78" name="adefb6e7b1cc3a3fff2d2d0eeb6cb1f78"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>init</b></td></tr>
<tr class="memdesc:adefb6e7b1cc3a3fff2d2d0eeb6cb1f78"><td class="mdescLeft">&#160;</td><td class="mdescRight">provides a way to change the profiles of the particles, by default Gaussian <br /></td></tr>
<tr class="separator:adefb6e7b1cc3a3fff2d2d0eeb6cb1f78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a03e820fcfde1a984937c59977e52c2" id="r_a5a03e820fcfde1a984937c59977e52c2"><td class="memItemLeft" align="right" valign="top"><a id="a5a03e820fcfde1a984937c59977e52c2" name="a5a03e820fcfde1a984937c59977e52c2"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>MultiMass</b></td></tr>
<tr class="memdesc:a5a03e820fcfde1a984937c59977e52c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">true if particles have different masses. <br /></td></tr>
<tr class="separator:a5a03e820fcfde1a984937c59977e52c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade43422c62af1a47f78f725e4151cf6a" id="r_ade43422c62af1a47f78f725e4151cf6a"><td class="memItemLeft" align="right" valign="top"><a id="ade43422c62af1a47f78f725e4151cf6a" name="ade43422c62af1a47f78f725e4151cf6a"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>MultiRadius</b></td></tr>
<tr class="memdesc:ade43422c62af1a47f78f725e4151cf6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">true if particles have different sizes. <br /></td></tr>
<tr class="separator:ade43422c62af1a47f78f725e4151cf6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf5bfc6384c6717f967d888fbd7fcb24" id="r_aaf5bfc6384c6717f967d888fbd7fcb24"><td class="memItemLeft" align="right" valign="top"><a id="aaf5bfc6384c6717f967d888fbd7fcb24" name="aaf5bfc6384c6717f967d888fbd7fcb24"></a>
float *&#160;</td><td class="memItemRight" valign="bottom"><b>masses</b></td></tr>
<tr class="memdesc:aaf5bfc6384c6717f967d888fbd7fcb24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array of particle masses. <br /></td></tr>
<tr class="separator:aaf5bfc6384c6717f967d888fbd7fcb24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77be3597cacacfb4c108a32cf3eeed1f" id="r_a77be3597cacacfb4c108a32cf3eeed1f"><td class="memItemLeft" align="right" valign="top"><a id="a77be3597cacacfb4c108a32cf3eeed1f" name="a77be3597cacacfb4c108a32cf3eeed1f"></a>
float *&#160;</td><td class="memItemRight" valign="bottom"><b>rsph</b></td></tr>
<tr class="memdesc:a77be3597cacacfb4c108a32cf3eeed1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Array of particle sizes. <br /></td></tr>
<tr class="separator:a77be3597cacacfb4c108a32cf3eeed1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdb57d9d285c3718886c04229dd09dfc" id="r_acdb57d9d285c3718886c04229dd09dfc"><td class="memItemLeft" align="right" valign="top">PosType&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#acdb57d9d285c3718886c04229dd09dfc">kappa_background</a></td></tr>
<tr class="separator:acdb57d9d285c3718886c04229dd09dfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d44a298e6b04054c902990de1582b0d" id="r_a4d44a298e6b04054c902990de1582b0d"><td class="memItemLeft" align="right" valign="top"><a id="a4d44a298e6b04054c902990de1582b0d" name="a4d44a298e6b04054c902990de1582b0d"></a>
PosType&#160;</td><td class="memItemRight" valign="bottom"><b>force_theta</b></td></tr>
<tr class="separator:a4d44a298e6b04054c902990de1582b0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acee047b1b2f495f91199d90196d965ef" id="r_acee047b1b2f495f91199d90196d965ef"><td class="memItemLeft" align="right" valign="top"><a id="acee047b1b2f495f91199d90196d965ef" name="acee047b1b2f495f91199d90196d965ef"></a>
bool&#160;</td><td class="memItemRight" valign="bottom"><b>haloON</b></td></tr>
<tr class="separator:acee047b1b2f495f91199d90196d965ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59b5d567288269bf067f824ed2083e5b" id="r_a59b5d567288269bf067f824ed2083e5b"><td class="memItemLeft" align="right" valign="top"><a id="a59b5d567288269bf067f824ed2083e5b" name="a59b5d567288269bf067f824ed2083e5b"></a>
<a class="el" href="class_lens_halo.html">LensHalo</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>halos</b></td></tr>
<tr class="separator:a59b5d567288269bf067f824ed2083e5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_class_tree_simple"><td colspan="2" onclick="javascript:dynsection.toggleInherit('pro_attribs_class_tree_simple')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="class_tree_simple.html">TreeSimple&lt; PType &gt;</a></td></tr>
<tr class="memitem:a4de0e8a905de62286e5111f65217d99b inherit pro_attribs_class_tree_simple" id="r_a4de0e8a905de62286e5111f65217d99b"><td class="memItemLeft" align="right" valign="top">
int&#160;</td><td class="memItemRight" valign="bottom"><b>Ndim</b></td></tr>
<tr class="separator:a4de0e8a905de62286e5111f65217d99b inherit pro_attribs_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a165a6e79819332a0c3cc3d81b0a7b7 inherit pro_attribs_class_tree_simple" id="r_a1a165a6e79819332a0c3cc3d81b0a7b7"><td class="memItemLeft" align="right" valign="top">
int&#160;</td><td class="memItemRight" valign="bottom"><b>incell</b></td></tr>
<tr class="separator:a1a165a6e79819332a0c3cc3d81b0a7b7 inherit pro_attribs_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a403b7d9fd205fe29b83e96860a92789e inherit pro_attribs_class_tree_simple" id="r_a403b7d9fd205fe29b83e96860a92789e"><td class="memItemLeft" align="right" valign="top">
<a class="el" href="struct_tree_n_b_struct.html">TreeNBStruct</a>&lt; PType &gt; *&#160;</td><td class="memItemRight" valign="bottom"><b>tree</b></td></tr>
<tr class="separator:a403b7d9fd205fe29b83e96860a92789e inherit pro_attribs_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5e542935585fe3ff8eff6627b894b8c inherit pro_attribs_class_tree_simple" id="r_af5e542935585fe3ff8eff6627b894b8c"><td class="memItemLeft" align="right" valign="top">
IndexType *&#160;</td><td class="memItemRight" valign="bottom"><b>index</b></td></tr>
<tr class="separator:af5e542935585fe3ff8eff6627b894b8c inherit pro_attribs_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bcf3e84a82fc1418c5dd94779f2e432 inherit pro_attribs_class_tree_simple" id="r_a2bcf3e84a82fc1418c5dd94779f2e432"><td class="memItemLeft" align="right" valign="top">
IndexType&#160;</td><td class="memItemRight" valign="bottom"><b>Nparticles</b></td></tr>
<tr class="separator:a2bcf3e84a82fc1418c5dd94779f2e432 inherit pro_attribs_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacf40dd5a51fe1896f416c71521110a4 inherit pro_attribs_class_tree_simple" id="r_aacf40dd5a51fe1896f416c71521110a4"><td class="memItemLeft" align="right" valign="top">
bool&#160;</td><td class="memItemRight" valign="bottom"><b>median_cut</b></td></tr>
<tr class="separator:aacf40dd5a51fe1896f416c71521110a4 inherit pro_attribs_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab799ad43f5c9e8910d0b99f4be4ba454 inherit pro_attribs_class_tree_simple" id="r_ab799ad43f5c9e8910d0b99f4be4ba454"><td class="memItemLeft" align="right" valign="top">
int&#160;</td><td class="memItemRight" valign="bottom"><b>Nbucket</b></td></tr>
<tr class="separator:ab799ad43f5c9e8910d0b99f4be4ba454 inherit pro_attribs_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36c65d6ce8c393c66ea8d0c5728a808e inherit pro_attribs_class_tree_simple" id="r_a36c65d6ce8c393c66ea8d0c5728a808e"><td class="memItemLeft" align="right" valign="top">
PosType&#160;</td><td class="memItemRight" valign="bottom"><b>realray</b> [3]</td></tr>
<tr class="separator:a36c65d6ce8c393c66ea8d0c5728a808e inherit pro_attribs_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae56438a5693add844693e08a7614e3c7 inherit pro_attribs_class_tree_simple" id="r_ae56438a5693add844693e08a7614e3c7"><td class="memItemLeft" align="right" valign="top">
PType *&#160;</td><td class="memItemRight" valign="bottom"><b>xxp</b></td></tr>
<tr class="separator:ae56438a5693add844693e08a7614e3c7 inherit pro_attribs_class_tree_simple"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Object used to calculate the force or deflection caused by a collection of "particles" by the tree method. </p>
<p>The particles can be point masses or have multiple sizes in which case they have a Gaussian profile. They can also have the same mass or multiple masses.</p>
<p>xp[][], masses[] and rsph[] need to be allocated before a <a class="el" href="class_tree_force.html" title="Object used to calculate the force or deflection caused by a collection of &quot;particles&quot; by the tree me...">TreeForce</a> is constructed and de-allocated after it is destructed. If the boolean flags are set to false these arrays need only be one element long. Multiple TreeForces can be made from the same particles. Do not rotate the particles without reconstructing a <a class="el" href="class_tree_force.html" title="Object used to calculate the force or deflection caused by a collection of &quot;particles&quot; by the tree me...">TreeForce</a>.</p>
<p>Most of the code in the earlier TreeNBForce.c is duplicated here as private methods and a few public ones.</p>
<p>The default value of theta = 0.1 generally gives better than 1% accuracy on alpha. The shear and kappa is always more accurate than the deflection. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="adeabe49704610a41cadfa7f04db796a1" name="adeabe49704610a41cadfa7f04db796a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeabe49704610a41cadfa7f04db796a1">&#9670;&#160;</a></span>TreeForce() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TreeForce::TreeForce </td>
          <td>(</td>
          <td class="paramtype">PosType **</td>          <td class="paramname"><span class="paramname"><em>xp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IndexType</td>          <td class="paramname"><span class="paramname"><em>Npoints</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>masses</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>rsph</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>Multimass</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>Multisize</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PosType</td>          <td class="paramname"><span class="paramname"><em>my_kappa_background</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>bucket</em></span><span class="paramdefsep"> = </span><span class="paramdefval">5</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>dimensions</em></span><span class="paramdefsep"> = </span><span class="paramdefval">2</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>median</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PosType</td>          <td class="paramname"><span class="paramname"><em>theta</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">my_kappa_background</td><td>background kappa that is subtracted </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a1fceae859e1c8badda8437c88cb175f6" name="a1fceae859e1c8badda8437c88cb175f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1fceae859e1c8badda8437c88cb175f6">&#9670;&#160;</a></span>TreeForce() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TreeForce::TreeForce </td>
          <td>(</td>
          <td class="paramtype">PosType **</td>          <td class="paramname"><span class="paramname"><em>xp</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IndexType</td>          <td class="paramname"><span class="paramname"><em>Npoints</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_lens_halo.html">LensHalo</a> *</td>          <td class="paramname"><span class="paramname"><em>my_halos</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>Multisize</em></span><span class="paramdefsep"> = </span><span class="paramdefval">true</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PosType</td>          <td class="paramname"><span class="paramname"><em>my_kappa_bk</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.0</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>bucket</em></span><span class="paramdefsep"> = </span><span class="paramdefval">5</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>dimension</em></span><span class="paramdefsep"> = </span><span class="paramdefval">2</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool</td>          <td class="paramname"><span class="paramname"><em>median</em></span><span class="paramdefsep"> = </span><span class="paramdefval">false</span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PosType</td>          <td class="paramname"><span class="paramname"><em>theta</em></span><span class="paramdefsep"> = </span><span class="paramdefval">0.1</span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">xp</td><td>positions of the halos xp[0..Npoints-1][0..1 or 2]  </td></tr>
    <tr><td class="paramname">Npoints</td><td>number of halos  </td></tr>
    <tr><td class="paramname">my_halos</td><td>array with internal properties of halos  </td></tr>
    <tr><td class="paramname">Multisize</td><td>flag false if only one halo size and structure should be used, default is true  </td></tr>
    <tr><td class="paramname">my_kappa_bk</td><td>Background convergence to be subtracted  </td></tr>
    <tr><td class="paramname">bucket</td><td>maximum number of halos in a leaf of the tree  </td></tr>
    <tr><td class="paramname">dimension</td><td>2 or 3, dimension of tree, default 2  </td></tr>
    <tr><td class="paramname">median</td><td>If true will divide branches at the median position of the particles, if false an equal area cut is used, default false  </td></tr>
    <tr><td class="paramname">theta</td><td>Opening angle used in tree force calculation </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a3259836d3275204c9a3a68e10c9da7b2" name="a3259836d3275204c9a3a68e10c9da7b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3259836d3275204c9a3a68e10c9da7b2">&#9670;&#160;</a></span>force2D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TreeForce::force2D </td>
          <td>(</td>
          <td class="paramtype">PosType const *</td>          <td class="paramname"><span class="paramname"><em>ray</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PosType *</td>          <td class="paramname"><span class="paramname"><em>alpha</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">KappaType *</td>          <td class="paramname"><span class="paramname"><em>kappa</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">KappaType *</td>          <td class="paramname"><span class="paramname"><em>gamma</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">KappaType *</td>          <td class="paramname"><span class="paramname"><em>phi</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculate the deflection and lensing propertie </p>
<p>TreeNBForce2D calculates the defection, convergence and shear using the plane-lens approximation with 3D SPH smoothing of the density rsph must be calculated before doing this with FindRSPH or by other means. tangent[3] - the direction of light rays or orientation of the simulation tree can be either a 3d or 2d tree although 2d is more efficient need to change the projected cm in _TreeNBForce to us 3d tree</p>
<p>The output alpha[] is in units of mass_scale/Mpc, ie it needs to be divided by Sigma_crit and multiplied by mass_scale to be the defelction in the lens equation expressed on the lens plane or multiplied by 4*pi*G*mass_scale to get the deflection angle caused by the plane lens. </p>
<p>intersecting, subtract the point particle</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="acdb57d9d285c3718886c04229dd09dfc" name="acdb57d9d285c3718886c04229dd09dfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdb57d9d285c3718886c04229dd09dfc">&#9670;&#160;</a></span>kappa_background</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PosType TreeForce::kappa_background</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A uniform mass sheet in units of mass_scale/Mpc^2 used to subtract of the contribution of the particles to the mean density of the universe </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>SLsimLib/include/<a class="el" href="force_tree_8h_source.html">forceTree.h</a></li>
<li>SLsimLib/TreeCode/<b>forceTree.cpp</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Sep 8 2024 19:31:03 for GLAMERDOC++ by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
