\hypertarget{class_lens_halo_multi_map}{}\doxysection{Lens\+Halo\+Multi\+Map Class Reference}
\label{class_lens_halo_multi_map}\index{LensHaloMultiMap@{LensHaloMultiMap}}


A lens halo that calculates all lensing quantities on two grids -\/ a low res long range grid and a high res short range grid. This is done to reduce the required memory required.  




{\ttfamily \#include $<$multimap.\+h$>$}



Inheritance diagram for Lens\+Halo\+Multi\+Map\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=179pt]{class_lens_halo_multi_map__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Lens\+Halo\+Multi\+Map\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=240pt]{class_lens_halo_multi_map__coll__graph}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_lens_halo_multi_map_a47d977f45c6e79b0ac619bc2bdad0b4f}{Lens\+Halo\+Multi\+Map}} (std\+::string fitsfile, std\+::string dir\+\_\+data, double redshift, double mass\+\_\+unit, double npane, int number\+\_\+of\+\_\+subfields, C\+O\+S\+M\+O\+L\+O\+GY \&c, bool write\+\_\+subfields=false, std\+::string dir\+\_\+scratch=\char`\"{}\char`\"{}, bool subtract\+\_\+ave=true, double ffactor=5, double gfactor=5, double rsmooth2=0)
\item 
void \mbox{\hyperlink{class_lens_halo_multi_map_a30ed57c69b9bec07ac44a617bfe01718}{resetsubmap}} (int i, const std\+::vector$<$ long $>$ \&lower\+\_\+left\+\_\+pix)
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a3ec68c906a7a1cdf23709e4eb6234843}\label{class_lens_halo_multi_map_a3ec68c906a7a1cdf23709e4eb6234843}} 
void \mbox{\hyperlink{class_lens_halo_multi_map_a3ec68c906a7a1cdf23709e4eb6234843}{resetsubmap\+Phys}} (int i, \mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} ll)
\begin{DoxyCompactList}\small\item\em Sets the least highres smaller map in physical coordinates relative to the center of the original map, periodic boundary conditions apply. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_af3272392f8eb2960c1fb6ceddf67d76a}\label{class_lens_halo_multi_map_af3272392f8eb2960c1fb6ceddf67d76a}} 
void {\bfseries resetsubmap\+Angular} (int i, \mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} ll)
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a0480d632182361d89f390c5409d8da80}\label{class_lens_halo_multi_map_a0480d632182361d89f390c5409d8da80}} 
void {\bfseries force\+\_\+halo} (double $\ast$alpha, Kappa\+Type $\ast$kappa, Kappa\+Type $\ast$gamma, Kappa\+Type $\ast$phi, double const $\ast$xcm, bool subtract\+\_\+point=false, Pos\+Type screening=1.\+0)
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a9fffde8d0920d1037857d6c9aae9c611}\label{class_lens_halo_multi_map_a9fffde8d0920d1037857d6c9aae9c611}} 
void {\bfseries write\+Image} (std\+::string fn)
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a62574c4e60b6aea190a3f623815a50b0}\label{class_lens_halo_multi_map_a62574c4e60b6aea190a3f623815a50b0}} 
\mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} \mbox{\hyperlink{class_lens_halo_multi_map_a62574c4e60b6aea190a3f623815a50b0}{get\+Lower\+Left\+\_\+lr}} () const
\begin{DoxyCompactList}\small\item\em lower left of long range map in physical Mpc \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_aa75e10a37d94aa14efac48785aa4309f}\label{class_lens_halo_multi_map_aa75e10a37d94aa14efac48785aa4309f}} 
\mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} \mbox{\hyperlink{class_lens_halo_multi_map_aa75e10a37d94aa14efac48785aa4309f}{get\+Upper\+Right\+\_\+lr}} () const
\begin{DoxyCompactList}\small\item\em upper right of short range map in physical Mpc \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a17decbf5feed2c78edab1162b13ec4b9}\label{class_lens_halo_multi_map_a17decbf5feed2c78edab1162b13ec4b9}} 
\mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} \mbox{\hyperlink{class_lens_halo_multi_map_a17decbf5feed2c78edab1162b13ec4b9}{get\+Center\+\_\+lr}} () const
\begin{DoxyCompactList}\small\item\em center of short range map in physical Mpc \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a35620fb0b5da1a49046fedb0503a58f6}\label{class_lens_halo_multi_map_a35620fb0b5da1a49046fedb0503a58f6}} 
\mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} \mbox{\hyperlink{class_lens_halo_multi_map_a35620fb0b5da1a49046fedb0503a58f6}{get\+Lower\+Left\+\_\+sr}} (int i) const
\begin{DoxyCompactList}\small\item\em lower left of short range map in physical Mpc \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_ac6d882347d9f49f7ba74672f6fa4b2b7}\label{class_lens_halo_multi_map_ac6d882347d9f49f7ba74672f6fa4b2b7}} 
\mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} \mbox{\hyperlink{class_lens_halo_multi_map_ac6d882347d9f49f7ba74672f6fa4b2b7}{get\+Upper\+Right\+\_\+sr}} (int i) const
\begin{DoxyCompactList}\small\item\em upper right of short range map in physical Mpc \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a6b899c88e491207990d5b95b5d633591}\label{class_lens_halo_multi_map_a6b899c88e491207990d5b95b5d633591}} 
\mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} \mbox{\hyperlink{class_lens_halo_multi_map_a6b899c88e491207990d5b95b5d633591}{get\+Center\+\_\+sr}} (int i) const
\begin{DoxyCompactList}\small\item\em center of short range map in physical Mpc \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a422b0d05144688192f6bc80b0ea51d3e}\label{class_lens_halo_multi_map_a422b0d05144688192f6bc80b0ea51d3e}} 
int \mbox{\hyperlink{class_lens_halo_multi_map_a422b0d05144688192f6bc80b0ea51d3e}{Number\+Of\+Short\+Range\+Maps}} ()
\begin{DoxyCompactList}\small\item\em the number of short range grids \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_acc889a0d4e16f6de4d53e7dc6e875545}\label{class_lens_halo_multi_map_acc889a0d4e16f6de4d53e7dc6e875545}} 
double \mbox{\hyperlink{class_lens_halo_multi_map_acc889a0d4e16f6de4d53e7dc6e875545}{get\+Range\+Mpc\+\_\+lr}} () const
\begin{DoxyCompactList}\small\item\em return range of long range map in physical Mpc \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a9afa958352ef80a28be702a102a3d985}\label{class_lens_halo_multi_map_a9afa958352ef80a28be702a102a3d985}} 
double \mbox{\hyperlink{class_lens_halo_multi_map_a9afa958352ef80a28be702a102a3d985}{get\+Range\+Mpc\+\_\+sr}} () const
\begin{DoxyCompactList}\small\item\em return range of long range map in physical Mpc \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a5ee649c177483e8a3bf45d381496e050}\label{class_lens_halo_multi_map_a5ee649c177483e8a3bf45d381496e050}} 
size\+\_\+t \mbox{\hyperlink{class_lens_halo_multi_map_a5ee649c177483e8a3bf45d381496e050}{get\+Nx\+\_\+lr}} () const
\begin{DoxyCompactList}\small\item\em return number of pixels on a x-\/axis side in original map \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a577dfa81bd1e33e9fcd12861c107efeb}\label{class_lens_halo_multi_map_a577dfa81bd1e33e9fcd12861c107efeb}} 
size\+\_\+t \mbox{\hyperlink{class_lens_halo_multi_map_a577dfa81bd1e33e9fcd12861c107efeb}{get\+Ny\+\_\+lr}} () const
\begin{DoxyCompactList}\small\item\em return number of pixels on a y-\/axis side in original map \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a1c1942ea8a9844a1b26445fb055e557c}\label{class_lens_halo_multi_map_a1c1942ea8a9844a1b26445fb055e557c}} 
size\+\_\+t \mbox{\hyperlink{class_lens_halo_multi_map_a1c1942ea8a9844a1b26445fb055e557c}{get\+Nx\+\_\+sr}} () const
\begin{DoxyCompactList}\small\item\em return number of pixels on a x-\/axis side in short range map (margins are hidden internally) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a01e4daccf7432a38b3a6ec2003717ab5}\label{class_lens_halo_multi_map_a01e4daccf7432a38b3a6ec2003717ab5}} 
size\+\_\+t \mbox{\hyperlink{class_lens_halo_multi_map_a01e4daccf7432a38b3a6ec2003717ab5}{get\+Ny\+\_\+sr}} () const
\begin{DoxyCompactList}\small\item\em return number of pixels on a y-\/axis side in short range map (margins are hidden internally) \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_ac2144fead49404f2ed827906c089e904}\label{class_lens_halo_multi_map_ac2144fead49404f2ed827906c089e904}} 
size\+\_\+t \mbox{\hyperlink{class_lens_halo_multi_map_ac2144fead49404f2ed827906c089e904}{get\+Nx}} () const
\begin{DoxyCompactList}\small\item\em return number of pixels on a x-\/axis side in original map \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_ac7cbe45757cae1d4a3a6f292fffdea03}\label{class_lens_halo_multi_map_ac7cbe45757cae1d4a3a6f292fffdea03}} 
size\+\_\+t \mbox{\hyperlink{class_lens_halo_multi_map_ac7cbe45757cae1d4a3a6f292fffdea03}{get\+Ny}} () const
\begin{DoxyCompactList}\small\item\em return number of pixels on a y-\/axis side in original map \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_aabb78ee85418bcc1629116da2c80a39e}\label{class_lens_halo_multi_map_aabb78ee85418bcc1629116da2c80a39e}} 
double {\bfseries get\+Max} () const
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a90fa739fbd21e0bf67feb3961d870f45}\label{class_lens_halo_multi_map_a90fa739fbd21e0bf67feb3961d870f45}} 
double {\bfseries get\+Min} () const
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_ac49acf0abed998e5e3682d90fb06ce6c}\label{class_lens_halo_multi_map_ac49acf0abed998e5e3682d90fb06ce6c}} 
double {\bfseries get\+Resolution\+Mpc} () const
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a13c45c0a5cce1ab4053fdc712bcb30ab}\label{class_lens_halo_multi_map_a13c45c0a5cce1ab4053fdc712bcb30ab}} 
double {\bfseries get\+Resolution\+Angular} () const
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a73c4950adb8e9c920ba1c1f23cc01279}\label{class_lens_halo_multi_map_a73c4950adb8e9c920ba1c1f23cc01279}} 
void {\bfseries operator=} (\mbox{\hyperlink{class_lens_halo_multi_map}{Lens\+Halo\+Multi\+Map}} \&\&m)
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_aba16ea51028f8aa81d28d8363fbe0c21}\label{class_lens_halo_multi_map_aba16ea51028f8aa81d28d8363fbe0c21}} 
{\bfseries Lens\+Halo\+Multi\+Map} (\mbox{\hyperlink{class_lens_halo_multi_map}{Lens\+Halo\+Multi\+Map}} \&\&m)
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a8fc9a5e1ee1533f0696f12198af2694d}\label{class_lens_halo_multi_map_a8fc9a5e1ee1533f0696f12198af2694d}} 
double {\bfseries ffactor}
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a083434778cc2fd71b979f8aff3d4b47f}\label{class_lens_halo_multi_map_a083434778cc2fd71b979f8aff3d4b47f}} 
double {\bfseries gfactor}
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a4bb15207db4ee11fb1885475d208884e}\label{class_lens_halo_multi_map_a4bb15207db4ee11fb1885475d208884e}} 
\mbox{\hyperlink{struct_lens_map}{Lens\+Map}} {\bfseries long\+\_\+range\+\_\+map}
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_ac1b79d6859d91b52921dfa7da9bf86e1}\label{class_lens_halo_multi_map_ac1b79d6859d91b52921dfa7da9bf86e1}} 
std\+::vector$<$ \mbox{\hyperlink{struct_lens_map}{Lens\+Map}} $>$ {\bfseries short\+\_\+range\+\_\+maps}
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a1c478f3e241ab0134ba0281e241f3957}\label{class_lens_halo_multi_map_a1c478f3e241ab0134ba0281e241f3957}} 
static my\+\_\+fftw\+\_\+plan \mbox{\hyperlink{class_lens_halo_multi_map_a1c478f3e241ab0134ba0281e241f3957}{plan\+\_\+short\+\_\+range}}
\begin{DoxyCompactList}\small\item\em these plans will be shared between all instances of \mbox{\hyperlink{class_lens_halo_multi_map}{Lens\+Halo\+Multi\+Map}} \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_abf1432a4dd4fad9ffd85f871ad1cbf0a}\label{class_lens_halo_multi_map_abf1432a4dd4fad9ffd85f871ad1cbf0a}} 
static my\+\_\+fftw\+\_\+plan {\bfseries plan\+\_\+long\+\_\+range}
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_ad634d0d53e8c427a9f6246a62b1e5b8b}\label{class_lens_halo_multi_map_ad634d0d53e8c427a9f6246a62b1e5b8b}} 
static std\+::mutex {\bfseries mutex\+\_\+multimap}
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_aa07e2a41429fb76e4864943a54307327}\label{class_lens_halo_multi_map_aa07e2a41429fb76e4864943a54307327}} 
static bool {\bfseries plans\+\_\+set\+\_\+up} = false
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a66fc594be6c0802ebf21d691fa98dc50}\label{class_lens_halo_multi_map_a66fc594be6c0802ebf21d691fa98dc50}} 
static size\+\_\+t {\bfseries nx\+\_\+sub} = 0
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_af2e40602b2f88f63d3fff2e062451020}\label{class_lens_halo_multi_map_af2e40602b2f88f63d3fff2e062451020}} 
static size\+\_\+t {\bfseries ny\+\_\+sub} = 0
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_ae929e25d6a35aae220a7710e712d1e25}\label{class_lens_halo_multi_map_ae929e25d6a35aae220a7710e712d1e25}} 
static size\+\_\+t {\bfseries nx\+\_\+long} = 0
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a65acdc0f9637b06a2dd22147130713d7}\label{class_lens_halo_multi_map_a65acdc0f9637b06a2dd22147130713d7}} 
static size\+\_\+t {\bfseries ny\+\_\+long} = 0
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a38737e3dee6683c2a3809d686bf8c8ad}\label{class_lens_halo_multi_map_a38737e3dee6683c2a3809d686bf8c8ad}} 
static size\+\_\+t {\bfseries nx\+\_\+sub\+\_\+extended} = 0
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a7ade61d256d54a8b386af57ba18d118b}\label{class_lens_halo_multi_map_a7ade61d256d54a8b386af57ba18d118b}} 
static size\+\_\+t {\bfseries ny\+\_\+sub\+\_\+extended} = 0
\item 
\mbox{\Hypertarget{class_lens_halo_multi_map_a2dc1c4f6586d73940b2fcf478fcd32c8}\label{class_lens_halo_multi_map_a2dc1c4f6586d73940b2fcf478fcd32c8}} 
static int {\bfseries count}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
A lens halo that calculates all lensing quantities on two grids -\/ a low res long range grid and a high res short range grid. This is done to reduce the required memory required. 

Note\+: To use this class requires setting the E\+N\+A\+B\+L\+E\+\_\+\+F\+I\+TS compiler flag and linking the cfits library. 

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{class_lens_halo_multi_map_a47d977f45c6e79b0ac619bc2bdad0b4f}\label{class_lens_halo_multi_map_a47d977f45c6e79b0ac619bc2bdad0b4f}} 
\index{LensHaloMultiMap@{LensHaloMultiMap}!LensHaloMultiMap@{LensHaloMultiMap}}
\index{LensHaloMultiMap@{LensHaloMultiMap}!LensHaloMultiMap@{LensHaloMultiMap}}
\doxysubsubsection{\texorpdfstring{LensHaloMultiMap()}{LensHaloMultiMap()}}
{\footnotesize\ttfamily Lens\+Halo\+Multi\+Map\+::\+Lens\+Halo\+Multi\+Map (\begin{DoxyParamCaption}\item[{std\+::string}]{fitsfile,  }\item[{std\+::string}]{dir\+\_\+data,  }\item[{double}]{redshift,  }\item[{double}]{mass\+\_\+unit,  }\item[{double}]{npane,  }\item[{int}]{number\+\_\+of\+\_\+subfields,  }\item[{C\+O\+S\+M\+O\+L\+O\+GY \&}]{c,  }\item[{bool}]{write\+\_\+subfields = {\ttfamily false},  }\item[{std\+::string}]{dir\+\_\+scratch = {\ttfamily \char`\"{}\char`\"{}},  }\item[{bool}]{subtract\+\_\+ave = {\ttfamily true},  }\item[{double}]{ffactor = {\ttfamily 5},  }\item[{double}]{gfactor = {\ttfamily 5},  }\item[{double}]{rsmooth2 = {\ttfamily 0} }\end{DoxyParamCaption})}

long\+\_\+range\+\_\+file\+\_\+exists = false;

set prefix to subfield maps

set up fftw plans for short range maps
\begin{DoxyParams}{Parameters}
{\em fitsfile} & Original fits map of the density \\
\hline
{\em mass\+\_\+unit} & should include h factors \\
\hline
{\em npane} & number of submaps in full map \\
\hline
{\em number\+\_\+of\+\_\+subfields} & number of subfields \\
\hline
{\em write\+\_\+subfields} & write subfields to be read if they already exist \\
\hline
{\em dir\+\_\+scratch} & directory for saving long rang force if different than directory where fitsfile is \\
\hline
{\em subtract\+\_\+ave} & subtract the average of the full field \\
\hline
\end{DoxyParams}


\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_lens_halo_multi_map_a30ed57c69b9bec07ac44a617bfe01718}\label{class_lens_halo_multi_map_a30ed57c69b9bec07ac44a617bfe01718}} 
\index{LensHaloMultiMap@{LensHaloMultiMap}!resetsubmap@{resetsubmap}}
\index{resetsubmap@{resetsubmap}!LensHaloMultiMap@{LensHaloMultiMap}}
\doxysubsubsection{\texorpdfstring{resetsubmap()}{resetsubmap()}}
{\footnotesize\ttfamily void Lens\+Halo\+Multi\+Map\+::resetsubmap (\begin{DoxyParamCaption}\item[{int}]{i,  }\item[{const std\+::vector$<$ long $>$ \&}]{lower\+\_\+left\+\_\+pix }\end{DoxyParamCaption})}

reset the short range map

The pixel position is for the usable region for ray-\/shooting and should not include the margin which is handled internally 
\begin{DoxyParams}{Parameters}
{\em i} & the subfield \\
\hline
{\em lower\+\_\+left\+\_\+pix} & the lower left of the subfield in pixels of full field \\
\hline
\end{DoxyParams}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
S\+Lsim\+Lib/include/multimap.\+h\item 
S\+Lsim\+Lib/\+Multi\+Plane/multimap.\+cpp\end{DoxyCompactItemize}
