\hypertarget{class_lens}{}\doxysection{Lens Class Reference}
\label{class_lens}\index{Lens@{Lens}}


A class to represents a lens with multiple planes.  




{\ttfamily \#include $<$lens.\+h$>$}

\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_lens_acc69ae46a84f55e9f89633d0e4182230}\label{class_lens_acc69ae46a84f55e9f89633d0e4182230}} 
\mbox{\hyperlink{class_lens_acc69ae46a84f55e9f89633d0e4182230}{Lens}} (long $\ast$seed, Pos\+Type z\+\_\+source, Cosmo\+Param\+Set cosmoset, bool verbose=false)
\begin{DoxyCompactList}\small\item\em Creates an empty lens. Main halos and field halos need to be inserted by hand from the user. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_a7d35c838440ad6d526e402492be04fc3}\label{class_lens_a7d35c838440ad6d526e402492be04fc3}} 
{\bfseries Lens} (long $\ast$seed, Pos\+Type z\+\_\+source, const C\+O\+S\+M\+O\+L\+O\+GY \&cosmo, bool verbose=false)
\item 
\mbox{\Hypertarget{class_lens_a0ce0eee4b6bf7070d5524d27b3474168}\label{class_lens_a0ce0eee4b6bf7070d5524d27b3474168}} 
int \mbox{\hyperlink{class_lens_a0ce0eee4b6bf7070d5524d27b3474168}{get\+Nplanes}} () const
\begin{DoxyCompactList}\small\item\em the total number of lens planes \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_a4269648ebbcbfcb1df353a92a5da2710}\label{class_lens_a4269648ebbcbfcb1df353a92a5da2710}} 
Pos\+Type \mbox{\hyperlink{class_lens_a4269648ebbcbfcb1df353a92a5da2710}{getfov}} () const
\begin{DoxyCompactList}\small\item\em field of view in square degrees \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_ac32d8eedc7ff362eed924f1dacea54ad}\label{class_lens_ac32d8eedc7ff362eed924f1dacea54ad}} 
void {\bfseries setfov} (Pos\+Type fov)
\item 
\mbox{\Hypertarget{class_lens_a1f2196496f170af2ee0a410ba064e2fa}\label{class_lens_a1f2196496f170af2ee0a410ba064e2fa}} 
void \mbox{\hyperlink{class_lens_a1f2196496f170af2ee0a410ba064e2fa}{reset\+Field\+Nplanes}} (std\+::size\+\_\+t field\+\_\+\+Nplanes, bool verbose=false)
\begin{DoxyCompactList}\small\item\em reset the number of planes, but keep the field halos and main lens \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_lens_ae4151410075a47b095f2f716055b1c69}{reset\+Field\+Halos}} (bool verbose=false)
\item 
\mbox{\Hypertarget{class_lens_a39c41fbb1d57645660161259c6352d85}\label{class_lens_a39c41fbb1d57645660161259c6352d85}} 
void \mbox{\hyperlink{class_lens_a39c41fbb1d57645660161259c6352d85}{print\+Multi\+Lens}} ()
\begin{DoxyCompactList}\small\item\em print the main parameters of the lens \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_ac96bfac69304667e16af07feb20843f8}\label{class_lens_ac96bfac69304667e16af07feb20843f8}} 
Pos\+Type \mbox{\hyperlink{class_lens_ac96bfac69304667e16af07feb20843f8}{get\+Zlens}} () const
\begin{DoxyCompactList}\small\item\em Redshift of first main lens plane. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_a9b720d302cc40cc8dc820b98e766339e}\label{class_lens_a9b720d302cc40cc8dc820b98e766339e}} 
Pos\+Type \mbox{\hyperlink{class_lens_a9b720d302cc40cc8dc820b98e766339e}{get\+Ang\+Dist\+Lens}} () const
\begin{DoxyCompactList}\small\item\em Angular size distance (Mpc) to first main lens plane. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_a4b21ff2601808978cc0783a53c305c43}\label{class_lens_a4b21ff2601808978cc0783a53c305c43}} 
\mbox{\hyperlink{class_utilities_1_1_geometry_1_1_spherical_point}{Utilities\+::\+Geometry\+::\+Spherical\+Point}} {\bfseries get\+Center} () const
\item 
\mbox{\Hypertarget{class_lens_a01b0553693fdcff5a9cafc8f6c49e387}\label{class_lens_a01b0553693fdcff5a9cafc8f6c49e387}} 
void \mbox{\hyperlink{class_lens_a01b0553693fdcff5a9cafc8f6c49e387}{clear\+Main\+Halos}} (bool verbose=false)
\begin{DoxyCompactList}\small\item\em remove all main halos \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_ad3fc4fa967bf6f74cfc0bdf257bc0f30}\label{class_lens_ad3fc4fa967bf6f74cfc0bdf257bc0f30}} 
{\footnotesize template$<$typename Halo\+Type $>$ }\\void \mbox{\hyperlink{class_lens_ad3fc4fa967bf6f74cfc0bdf257bc0f30}{clear\+Main\+Halo}} (bool verbose=false)
\begin{DoxyCompactList}\small\item\em remaove all main halo of given type \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_a177ee7cbb406d835865edd855b556d63}\label{class_lens_a177ee7cbb406d835865edd855b556d63}} 
{\footnotesize template$<$typename T $>$ }\\void \mbox{\hyperlink{class_lens_a177ee7cbb406d835865edd855b556d63}{insert\+Main\+Halo}} (const T \&halo\+\_\+in, bool addplanes, bool verbose=false)
\begin{DoxyCompactList}\small\item\em inserts a single main lens halo and adds it to the existing ones \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T $>$ }\\void \mbox{\hyperlink{class_lens_aa8a8bbd818794bc97ee6d3f842e82e54}{movein\+Main\+Halo}} (T \&halo\+\_\+in, bool addplanes, bool verbose=false)
\begin{DoxyCompactList}\small\item\em This has the same effect as \mbox{\hyperlink{class_lens_a177ee7cbb406d835865edd855b556d63}{insert\+Main\+Halo()}}, but the halo is not copied, it is moved. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T $>$ }\\void \mbox{\hyperlink{class_lens_aba7e1b3c66565092fdc7555dc4704896}{replace\+Main\+Halo}} (const T \&halo\+\_\+in, bool addplanes, bool verbose=false)
\begin{DoxyCompactList}\small\item\em Inserts a single main lens halo and deletes all previous ones. Then all lensing planes are updated accordingly. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T $>$ }\\void \mbox{\hyperlink{class_lens_af7403e6372cd1a396fb098cbd1d824cc}{insert\+Main\+Halos}} (std\+::vector$<$ T $>$ \&my\+\_\+halos, bool addplanes, bool verbose=false)
\begin{DoxyCompactList}\small\item\em Inserts a sequense of main lens halos and adds them to the existing ones. Then all lensing planes are updated accordingly. If addplanes is true new planes will be added otherwise the halo is added to the nearest plane and a plane is added only if none exited on entry. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T $>$ }\\void \mbox{\hyperlink{class_lens_a0cfbb73f3ff13e43beccb50d18a89af4}{replace\+Main\+Halos}} (std\+::vector$<$ T $>$ \&my\+\_\+halos, bool verbose)
\begin{DoxyCompactList}\small\item\em Inserts a sequense of main lens halos and remove all previous ones. \end{DoxyCompactList}\item 
std\+::size\+\_\+t \mbox{\hyperlink{class_lens_ad5edcf261950dab5a8d3339626b01eed}{get\+N\+Main\+Halos}} () const
\begin{DoxyCompactList}\small\item\em inserts a sequence of main lens halos and adds them to the existing ones \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_a44cfbf61d32fcad6120af5a472132391}\label{class_lens_a44cfbf61d32fcad6120af5a472132391}} 
{\footnotesize template$<$typename Halo\+Type $>$ }\\std\+::size\+\_\+t \mbox{\hyperlink{class_lens_a44cfbf61d32fcad6120af5a472132391}{get\+N\+Main\+Halos}} () const
\begin{DoxyCompactList}\small\item\em get number of main halos of given type \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_aecc7754f42783ebe2f3d7a8074591322}\label{class_lens_aecc7754f42783ebe2f3d7a8074591322}} 
\mbox{\hyperlink{class_lens_halo}{Lens\+Halo}} $\ast$ \mbox{\hyperlink{class_lens_aecc7754f42783ebe2f3d7a8074591322}{get\+Main\+Halo}} (std\+::size\+\_\+t i)
\begin{DoxyCompactList}\small\item\em get single main halo \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_afbff81a6b811293718d2f58665b81571}\label{class_lens_afbff81a6b811293718d2f58665b81571}} 
{\footnotesize template$<$typename Halo\+Type $>$ }\\Halo\+Type $\ast$ \mbox{\hyperlink{class_lens_afbff81a6b811293718d2f58665b81571}{get\+Main\+Halo}} (std\+::size\+\_\+t i)
\begin{DoxyCompactList}\small\item\em get single main halo of given type \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_lens_a7a8ed89e743c26f14ab8e3992fa3118a}{rayshooter}} (\mbox{\hyperlink{struct_r_a_y}{R\+AY}} \&ray)
\begin{DoxyCompactList}\small\item\em Using to shoot a single ray. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_lens_a711067d75213f4e6bc0f8a5606faf66a}{rayshooter\+Internal}} (unsigned long Npoints, \mbox{\hyperlink{struct_point}{Point}} $\ast$i\+\_\+points, bool R\+S\+Iverbose=false)
\begin{DoxyCompactList}\small\item\em Main routine for shooting rays in parrallel. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_lens_a2575c6d766091cde0ce87249e97333f1}{rayshooter\+Internal}} (unsigned long Npoints, \mbox{\hyperlink{struct_linked_point}{Linked\+Point}} $\ast$i\+\_\+points, std\+::vector$<$ double $>$ \&source\+\_\+zs, bool R\+S\+Iverbose=false)
\begin{DoxyCompactList}\small\item\em Routine for shooting rays with differnt source redshifts in parrallel. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_lens_ae505c3e066e52d60372449aecc7ae6b0}{rayshooter\+Internal}} (unsigned long Npoints, \mbox{\hyperlink{struct_r_a_y}{R\+AY}} $\ast$rays)
\item 
\mbox{\Hypertarget{class_lens_ae67ceb70df6830db1fbcb8e33aa60176}\label{class_lens_ae67ceb70df6830db1fbcb8e33aa60176}} 
void {\bfseries rayshooter\+Internal} (\mbox{\hyperlink{struct_r_a_y}{R\+AY}} \&ray)
\item 
void \mbox{\hyperlink{class_lens_a4fa714f37553b29a50a6d2b532a99013}{info\+\_\+rayshooter}} (\mbox{\hyperlink{struct_r_a_y}{R\+AY}} \&i\+\_\+point, std\+::vector$<$ \mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} $>$ \&ang\+\_\+positions, std\+::vector$<$ Kappa\+Type $>$ \&kappa\+\_\+on\+\_\+planes, std\+::vector$<$ std\+::vector$<$ \mbox{\hyperlink{class_lens_halo}{Lens\+Halo}} $\ast$ $>$$>$ \&halo\+\_\+neighbors, \mbox{\hyperlink{class_lens_halo}{Lens\+Halo}} \&halo\+\_\+max, Kappa\+Type \&kappa\+\_\+max, Kappa\+Type gamma\+\_\+max\mbox{[}$\,$\mbox{]}, Pos\+Type rmax, int tag=0, short mode=0, bool verbose=false)
\begin{DoxyCompactList}\small\item\em single ray \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_lens_a5e683b56effd97638db0dceb4cd04c3c}{mass\+\_\+on\+\_\+planes}} (const std\+::vector$<$ \mbox{\hyperlink{struct_r_a_y}{R\+AY}} $>$ \&rays, std\+::vector$<$ double $>$ \&masses, bool verbose=false)
\begin{DoxyCompactList}\small\item\em finds the mass within a curve of rays one every lens plane im Msun \end{DoxyCompactList}\item 
\mbox{\hyperlink{struct_r_a_y}{R\+AY}} \mbox{\hyperlink{class_lens_a73758de70585bda93be75065f772f85b}{find\+\_\+image\+\_\+min}} (\mbox{\hyperlink{struct_point}{Point}} \&p, double zs, Pos\+Type ytol2, Pos\+Type \&dy2, bool use\+\_\+image\+\_\+guess)
\begin{DoxyCompactList}\small\item\em Find the image position of a source without grid refinement. \end{DoxyCompactList}\item 
\mbox{\hyperlink{struct_r_a_y}{R\+AY}} \mbox{\hyperlink{class_lens_a6ea1caf11ec4eff16655de132a701165}{find\+\_\+image\+\_\+min}} (const \mbox{\hyperlink{struct_r_a_y}{R\+AY}} \&in\+\_\+ray, Pos\+Type ytol2)
\item 
\mbox{\hyperlink{struct_r_a_y}{R\+AY}} \mbox{\hyperlink{class_lens_a29120751ca87eb68c2c2afc3a6ca9ae4}{find\+\_\+image\+\_\+min}} (\mbox{\hyperlink{struct_point}{Point}} \&p, double zs, Pos\+Type ytol2, Pos\+Type \&dy2, std\+::vector$<$ \mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} $>$ \&boundary)
\begin{DoxyCompactList}\small\item\em This is the same, but the image is forced to stay within boundary. \end{DoxyCompactList}\item 
std\+::vector$<$ \mbox{\hyperlink{struct_r_a_y}{R\+AY}} $>$ \mbox{\hyperlink{class_lens_ac4a8cd1c9c69e16aa7f01a8b0eaff596}{find\+\_\+images}} (\mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} y\+\_\+source, double z\+\_\+source, \mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} center, double range, double stop\+\_\+res)
\begin{DoxyCompactList}\small\item\em finds images by telescoping triangle method \end{DoxyCompactList}\item 
std\+::vector$<$ \mbox{\hyperlink{struct_r_a_y}{R\+AY}} $>$ \mbox{\hyperlink{class_lens_adb05102639f1d175bad05f64e4e3bf56}{find\+\_\+images}} (\mbox{\hyperlink{struct_grid_map}{Grid\+Map}} \&init\+\_\+grid, \mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} y\+\_\+source, double z\+\_\+source, double stop\+\_\+res)
\begin{DoxyCompactList}\small\item\em finds images by telescoping triangle method \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_ac408b0446806251de0022c4600acfdb7}\label{class_lens_ac408b0446806251de0022c4600acfdb7}} 
void {\bfseries find\+\_\+images\+\_\+min\+\_\+parallel} (std\+::vector$<$ \mbox{\hyperlink{struct_r_a_y}{R\+AY}} $>$ \&rays, double ytol2, std\+::vector$<$ bool $>$ \&success)
\item 
short \mbox{\hyperlink{class_lens_a71b1279d35b08c49d537708a46c1d3a6}{Reset\+Source\+Plane}} (Pos\+Type z, bool nearest=false, bool verbose=false)
\begin{DoxyCompactList}\small\item\em reset the redshift of the source plane \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_lens_a7ddbfe99548eb3e63d1d45af2f005972}{Find\+Source\+Plane}} (Pos\+Type zs, long \&jmax, double \&Dls, double \&Ds)
\begin{DoxyCompactList}\small\item\em find information on the position of the source plane with respect to the lens planes \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_af4c16d98618b2a26e75c2673af2058c2}\label{class_lens_af4c16d98618b2a26e75c2673af2058c2}} 
void \mbox{\hyperlink{class_lens_af4c16d98618b2a26e75c2673af2058c2}{Revert\+Source\+Plane}} ()
\begin{DoxyCompactList}\small\item\em Revert the source redshift to the value it was when the \mbox{\hyperlink{class_lens}{Lens}} was created. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_af77f423ad5bbf4d7256673256a601037}\label{class_lens_af77f423ad5bbf4d7256673256a601037}} 
Pos\+Type {\bfseries get\+SourceZ} ()
\item 
\mbox{\Hypertarget{class_lens_a45fd74bb5f5ffc4ee1610db34bb96def}\label{class_lens_a45fd74bb5f5ffc4ee1610db34bb96def}} 
Pos\+Type {\bfseries get\+Zmax} () const
\item 
\mbox{\Hypertarget{class_lens_a6e65d6c8d5c97e4024d7002eb8cc7d04}\label{class_lens_a6e65d6c8d5c97e4024d7002eb8cc7d04}} 
void \mbox{\hyperlink{class_lens_a6e65d6c8d5c97e4024d7002eb8cc7d04}{Print\+Cosmology}} ()
\begin{DoxyCompactList}\small\item\em print the cosmological parameters \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_a53108c7002e0cb4ce7064d43c5efdb0e}\label{class_lens_a53108c7002e0cb4ce7064d43c5efdb0e}} 
Pos\+Type \mbox{\hyperlink{class_lens_a53108c7002e0cb4ce7064d43c5efdb0e}{get\+Sigma\+Crit}} (Pos\+Type zsource) const
\begin{DoxyCompactList}\small\item\em returns the critical density at the main lens in Msun/ Mpc$^\wedge$2 for a source at zsource \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_a5576b59d2f70c1d0f0a798b8a92a4f81}\label{class_lens_a5576b59d2f70c1d0f0a798b8a92a4f81}} 
const C\+O\+S\+M\+O\+L\+O\+GY \& \mbox{\hyperlink{class_lens_a5576b59d2f70c1d0f0a798b8a92a4f81}{get\+Cosmo}} ()
\begin{DoxyCompactList}\small\item\em returns a const reference to the cosmology so that constant functions can be used, but the cosmological parameters cannot be changed. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_a40ef8e31f5a9d3ada238db9c8a8babe9}\label{class_lens_a40ef8e31f5a9d3ada238db9c8a8babe9}} 
void \mbox{\hyperlink{class_lens_a40ef8e31f5a9d3ada238db9c8a8babe9}{Turn\+Field\+Off}} ()
\begin{DoxyCompactList}\small\item\em set flag\+\_\+switch\+\_\+field\+\_\+off, turn the field On/\+Off \+: \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_a15b527844992bbd710bb5bee3c7e55f3}\label{class_lens_a15b527844992bbd710bb5bee3c7e55f3}} 
void {\bfseries Turn\+Field\+On} ()
\item 
\mbox{\Hypertarget{class_lens_a3769e1aec46d81eab053a7de55f464cc}\label{class_lens_a3769e1aec46d81eab053a7de55f464cc}} 
Pos\+Type \mbox{\hyperlink{class_lens_a3769e1aec46d81eab053a7de55f464cc}{get\+Field\+Min\+Mass}} () const
\begin{DoxyCompactList}\small\item\em get the field min mass \+: \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_lens_a6a6ea256727745b13b6df8258cfa7ec0}\label{class_lens_a6a6ea256727745b13b6df8258cfa7ec0}} 
bool {\bfseries getfield\+Off} () const
\item 
void \mbox{\hyperlink{class_lens_a9925ac3f8486c262f0d10096f3ad902a}{Generate\+Field\+Halos}} (double min\+\_\+mass, \mbox{\hyperlink{_input_params_8h_a5f08f39a7095359c5ef668d6fdce6470}{Mass\+Func\+Type}} mass\+\_\+function, double field\+\_\+of\+\_\+view, int Nplanes, \mbox{\hyperlink{_input_params_8h_adc636f57bc26ded1ea43d457bba6da97}{Lens\+Halo\+Type}} halo\+\_\+type=Lens\+Halo\+Type\+::nfw\+\_\+lens, \mbox{\hyperlink{_input_params_8h_a84369a9df44a3e61609a068b4debd98f}{Galaxy\+Lens\+Halo\+Type}} galaxy\+\_\+type=Galaxy\+Lens\+Halo\+Type\+::null\+\_\+gal, double buffer=1.\+0, bool verbose=false)
\begin{DoxyCompactList}\small\item\em Add random halos to the light cone according to standard structure formation theory. A new realization of the light-\/cone can be made with \mbox{\hyperlink{class_lens_ae4151410075a47b095f2f716055b1c69}{Lens\+::reset\+Field\+Halos()}} after this function is called once. \end{DoxyCompactList}\item 
\mbox{\hyperlink{class_lens}{Lens}} \& \mbox{\hyperlink{class_lens_a2e312accd9681ad7e131b5530ca2affd}{operator=}} (\mbox{\hyperlink{class_lens}{Lens}} \&\&lens)
\item 
\mbox{\Hypertarget{class_lens_a557f940236f66e88f8a3b73efbb7c2bc}\label{class_lens_a557f940236f66e88f8a3b73efbb7c2bc}} 
{\bfseries Lens} (\mbox{\hyperlink{class_lens}{Lens}} \&\&lens)
\item 
\mbox{\Hypertarget{class_lens_aad9941c8999a39551c900932442993ed}\label{class_lens_aad9941c8999a39551c900932442993ed}} 
std\+::vector$<$ Pos\+Type $>$ {\bfseries get\+\_\+plane\+\_\+redshifts} ()
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_lens_a09c7b4946959331f7dc5aed93053727c}\label{class_lens_a09c7b4946959331f7dc5aed93053727c}} 
bool \mbox{\hyperlink{class_lens_a09c7b4946959331f7dc5aed93053727c}{set}}
\begin{DoxyCompactList}\small\item\em marks if the lens has been setup. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_lens_aee17d6e92bea425de358a9381ad6280b}\label{class_lens_aee17d6e92bea425de358a9381ad6280b}} 
Pos\+Type \mbox{\hyperlink{class_lens_aee17d6e92bea425de358a9381ad6280b}{fieldofview}}
\begin{DoxyCompactList}\small\item\em field of view in square degrees \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
A class to represents a lens with multiple planes. 


\begin{DoxyPre}
 The rays are traced through multiple deflections.  On each plane there is a deflection
 solver.  An \mbox{\hyperlink{class_lens_halo_ana_n_s_i_e}{LensHaloAnaNSIE}} or \mbox{\hyperlink{class_lens_halo_mass_map}{LensHaloMassMap}} can be put on one of the planes.  The other planes can be
 populated with random field\_halos drawn from a mass function or they can be retrieved from an
 external catalog.\end{DoxyPre}



\begin{DoxyPre}   Input Parameters (variable names):\end{DoxyPre}



\begin{DoxyPre}   main\_halo\_on -\/-\/ 0: no major lens present; 1: there is a major lens present
   main\_halo\_type -\/-\/ profile type for the main DM lens halo
    0 or nolens, 1 or NFW, 2 or PseudoNFW, 3 or PowerLaw, 4 or NSIE, 5 or AnaLens, 6 or UniLens, 7 or MOKALens, 8 or DummyLens
   main\_galaxy\_halo\_type -\/-\/ profile typ for the main galaxy lens halo 0 or none, 1 or NSIE
   redshift\_planes\_file -\/-\/ asci file with the redshifts of the lensing planes, if not set then created internaly
   flag\_switch\_field\_off -\/-\/ false: field halos are created, true: no field halos are created; default is false\end{DoxyPre}



\begin{DoxyPre}   if field\_off == false, i.e. there are field halos then also the following are used:
   field\_Nplanes -\/-\/ number of field planes
   field\_fov -\/-\/ field of view of the light cone, filled with field halos
   field\_internal\_profile -\/-\/ profile type of the DM field lens halos
    0 or nolens, 1 or NFW, 2 or PseudoNFW, 3 or PowerLaw, 4 or NSIE, 5 or AnaLens, 6 or UniLens, 7 or MOKALens, 8 or DummyLens, 9 or Hernquist, 10 or Jaffe
   field\_prof\_internal\_slope\_pl -\/-\/ slope of the surface density for power law
   field\_prof\_internal\_slope\_pnfw -\/-\/ slope of the surface density for pseudo nfw profiles
   field\_internal\_profile\_galaxy -\/-\/ profile type of the galaxy field halos; if not set, no galaxies are used
    0 or none, 1 or NSIE\end{DoxyPre}



\begin{DoxyPre}   field\_input\_sim\_file -\/-\/ filename of the Millennium simulation data to be read in and used to populate the light cone with field halos\end{DoxyPre}



\begin{DoxyPre}   if field\_input\_sim\_file is  \_not\_ set, then the field halos are generated from a mass function and the following are used:
   field\_mass\_func\_type -\/-\/ type of the halo mass function
    PS (0), ST (1), and power law (2)
   mass\_func\_PL\_slope -\/-\/ slope of the mass function in the power law case; default is -\/1/6
   field\_min\_mass -\/-\/ minimum mass for the generated field halos
   field\_buffer -\/-\/ a constant physical size buffer, padding every lens plane to increase its surface\end{DoxyPre}



\begin{DoxyPre}   zsource -\/-\/ source redshift
   flag\_switch\_deflection\_off -\/-\/ false: deflection is on, but kappa and gamma may be calculated, true: deflection is off; default is false
   flag\_switch\_lensing\_off -\/-\/ false: lensing is on, true: lensing is off (no alpha, kappa or gamma); default is false\end{DoxyPre}



\begin{DoxyPre}   \# Cosmology -\/ Any cosmological parameters that are not set will have default values\end{DoxyPre}



\begin{DoxyPre}  Omega\_matter -\/-\/ Total mass (baryons + dark matter) in the units of the critical density, optional
  Omega\_lambda -\/-\/ Density in a cosmological constant, if not set it will be = 1 -\/ Omega\_matter
  Omega\_baryon -\/-\/ Density in baryons
  Omega\_neutrino -\/-\/ Density in neutrinos
  hubble -\/-\/ Hubble parameter in units of 100 km/s/Mpc
  sigm\_8 -\/-\/ normalization of power spectrum\end{DoxyPre}



\begin{DoxyPre} \end{DoxyPre}
 

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_lens_a6ea1caf11ec4eff16655de132a701165}\label{class_lens_a6ea1caf11ec4eff16655de132a701165}} 
\index{Lens@{Lens}!find\_image\_min@{find\_image\_min}}
\index{find\_image\_min@{find\_image\_min}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{find\_image\_min()}{find\_image\_min()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily \mbox{\hyperlink{struct_r_a_y}{R\+AY}} Lens\+::find\+\_\+image\+\_\+min (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{struct_r_a_y}{R\+AY}} \&}]{in\+\_\+ray,  }\item[{Pos\+Type}]{ytol2 }\end{DoxyParamCaption})}

this version uses the redshift stored in the ray,

Tthe ray is replaced with the best guess so the source position is replaced. 
\begin{DoxyParams}{Parameters}
{\em in\+\_\+ray} & p.\+y\mbox{[}\mbox{]} should be set to source position \\
\hline
{\em ytol2} & target tolerance in source position squared \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_lens_a73758de70585bda93be75065f772f85b}\label{class_lens_a73758de70585bda93be75065f772f85b}} 
\index{Lens@{Lens}!find\_image\_min@{find\_image\_min}}
\index{find\_image\_min@{find\_image\_min}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{find\_image\_min()}{find\_image\_min()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily \mbox{\hyperlink{struct_r_a_y}{R\+AY}} Lens\+::find\+\_\+image\+\_\+min (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_point}{Point}} \&}]{p,  }\item[{double}]{zs,  }\item[{Pos\+Type}]{ytol2,  }\item[{Pos\+Type \&}]{dy2,  }\item[{bool}]{use\+\_\+image\+\_\+guess }\end{DoxyParamCaption})}



Find the image position of a source without grid refinement. 

Find an image position for a source position.

This uses Powell\textquotesingle{}s algorithm to minimise the distance between the source point of an image and the desired source point. No grid is necessary. This should be fast, but will miss multiple images. This is useful for finding the position of weakly lensed images or the rough region where a grid should be put down for a strong lens.

Find the image position of a source without grid refinement.

This finds an image position given a source postion. No grid is necessary.

If use\+\_\+image\+\_\+guess=true the input image position will be used as a first guess and the output image will be guarenteed to have the same pairity.

This is useful for finding the position of weakly lensed images or for refining the image positions that are found on a finite grid.

This routine finds the image position by minimizing the seporation on the source plane with Powell\textquotesingle{}s method of minimization. This will not find all images. For that you must use another routine. In the weak lensing regiam this should be sufficient. 
\begin{DoxyParams}{Parameters}
{\em p} & p.\+image-\/$>$x should be set to source position \\
\hline
{\em zs} & redhsift of source \\
\hline
{\em ytol2} & target tolerance in source position squared \\
\hline
{\em dy2} & final value of Delta y $^\wedge$2 \\
\hline
{\em use\+\_\+image\+\_\+guess} & if true p.\+x\mbox{[}\mbox{]} will be used as a guess for the image position \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_lens_a29120751ca87eb68c2c2afc3a6ca9ae4}\label{class_lens_a29120751ca87eb68c2c2afc3a6ca9ae4}} 
\index{Lens@{Lens}!find\_image\_min@{find\_image\_min}}
\index{find\_image\_min@{find\_image\_min}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{find\_image\_min()}{find\_image\_min()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily \mbox{\hyperlink{struct_r_a_y}{R\+AY}} Lens\+::find\+\_\+image\+\_\+min (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_point}{Point}} \&}]{p,  }\item[{double}]{zs,  }\item[{Pos\+Type}]{ytol2,  }\item[{Pos\+Type \&}]{dy2,  }\item[{std\+::vector$<$ \mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} $>$ \&}]{boundary }\end{DoxyParamCaption})}



This is the same, but the image is forced to stay within boundary. 


\begin{DoxyParams}{Parameters}
{\em p} & p\mbox{[}\mbox{]} is \\
\hline
{\em zs} & source redshift \\
\hline
{\em ytol2} & target tolerance in source position squared \\
\hline
{\em dy2} & final value of Delta y $^\wedge$2 \\
\hline
{\em boundary} & image will be limited to within this boundary \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_lens_adb05102639f1d175bad05f64e4e3bf56}\label{class_lens_adb05102639f1d175bad05f64e4e3bf56}} 
\index{Lens@{Lens}!find\_images@{find\_images}}
\index{find\_images@{find\_images}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{find\_images()}{find\_images()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily std\+::vector$<$ \mbox{\hyperlink{struct_r_a_y}{R\+AY}} $>$ Lens\+::find\+\_\+images (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_grid_map}{Grid\+Map}} \&}]{init\+\_\+grid,  }\item[{\mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}}}]{y\+\_\+source,  }\item[{double}]{z\+\_\+source,  }\item[{double}]{stop\+\_\+res }\end{DoxyParamCaption})}



finds images by telescoping triangle method 

find rays using telescoping triangle method starting with a \mbox{\hyperlink{struct_grid_map}{Grid\+Map}} init\+\_\+grid

Meant for refining the image positions to higher resolution than the initial grid \mbox{\Hypertarget{class_lens_ac4a8cd1c9c69e16aa7f01a8b0eaff596}\label{class_lens_ac4a8cd1c9c69e16aa7f01a8b0eaff596}} 
\index{Lens@{Lens}!find\_images@{find\_images}}
\index{find\_images@{find\_images}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{find\_images()}{find\_images()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily std\+::vector$<$ \mbox{\hyperlink{struct_r_a_y}{R\+AY}} $>$ Lens\+::find\+\_\+images (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}}}]{y\+\_\+source,  }\item[{double}]{z\+\_\+source,  }\item[{\mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}}}]{center,  }\item[{double}]{range,  }\item[{double}]{stop\+\_\+res }\end{DoxyParamCaption})}



finds images by telescoping triangle method 

find rays using telescoping triangle method \mbox{\Hypertarget{class_lens_a7ddbfe99548eb3e63d1d45af2f005972}\label{class_lens_a7ddbfe99548eb3e63d1d45af2f005972}} 
\index{Lens@{Lens}!FindSourcePlane@{FindSourcePlane}}
\index{FindSourcePlane@{FindSourcePlane}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{FindSourcePlane()}{FindSourcePlane()}}
{\footnotesize\ttfamily void Lens\+::\+Find\+Source\+Plane (\begin{DoxyParamCaption}\item[{Pos\+Type}]{zs,  }\item[{long \&}]{jmax,  }\item[{double \&}]{Dls,  }\item[{double \&}]{Ds }\end{DoxyParamCaption})}



find information on the position of the source plane with respect to the lens planes 


\begin{DoxyParams}{Parameters}
{\em zs} & redshift of implanted source \\
\hline
{\em jmax} & index of last plane at lower redshift \\
\hline
{\em Dls} & coordinate distance between last plane and source plane \\
\hline
{\em Ds} & total coordinate distance to source plane \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_lens_a9925ac3f8486c262f0d10096f3ad902a}\label{class_lens_a9925ac3f8486c262f0d10096f3ad902a}} 
\index{Lens@{Lens}!GenerateFieldHalos@{GenerateFieldHalos}}
\index{GenerateFieldHalos@{GenerateFieldHalos}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{GenerateFieldHalos()}{GenerateFieldHalos()}}
{\footnotesize\ttfamily void Lens\+::\+Generate\+Field\+Halos (\begin{DoxyParamCaption}\item[{double}]{min\+\_\+mass,  }\item[{\mbox{\hyperlink{_input_params_8h_a5f08f39a7095359c5ef668d6fdce6470}{Mass\+Func\+Type}}}]{mass\+\_\+function,  }\item[{double}]{field\+\_\+of\+\_\+view,  }\item[{int}]{Nplanes,  }\item[{\mbox{\hyperlink{_input_params_8h_adc636f57bc26ded1ea43d457bba6da97}{Lens\+Halo\+Type}}}]{halo\+\_\+type = {\ttfamily LensHaloType\+:\+:nfw\+\_\+lens},  }\item[{\mbox{\hyperlink{_input_params_8h_a84369a9df44a3e61609a068b4debd98f}{Galaxy\+Lens\+Halo\+Type}}}]{galaxy\+\_\+type = {\ttfamily GalaxyLensHaloType\+:\+:null\+\_\+gal},  }\item[{double}]{buffer = {\ttfamily 1.0},  }\item[{bool}]{verbose = {\ttfamily false} }\end{DoxyParamCaption})}



Add random halos to the light cone according to standard structure formation theory. A new realization of the light-\/cone can be made with \mbox{\hyperlink{class_lens_ae4151410075a47b095f2f716055b1c69}{Lens\+::reset\+Field\+Halos()}} after this function is called once. 

The cone is filled up until the redshift of the current zsource that is stored in the \mbox{\hyperlink{class_lens}{Lens}} class. The field is a circular on the sky. There is no clustering of the halos. 
\begin{DoxyParams}{Parameters}
{\em min\+\_\+mass} & minimum mass of halos \\
\hline
{\em mass\+\_\+function} & type of mass function \\
\hline
{\em field\+\_\+of\+\_\+view} & in square degrees \\
\hline
{\em Nplanes} & number of lens planes \\
\hline
{\em halo\+\_\+type} & type of halo \\
\hline
{\em galaxy\+\_\+type} & type of galaxy, if null\+\_\+gal no galaxy \\
\hline
{\em buffer} & buffer in Mpc for cone \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_lens_ad5edcf261950dab5a8d3339626b01eed}\label{class_lens_ad5edcf261950dab5a8d3339626b01eed}} 
\index{Lens@{Lens}!getNMainHalos@{getNMainHalos}}
\index{getNMainHalos@{getNMainHalos}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{getNMainHalos()}{getNMainHalos()}}
{\footnotesize\ttfamily std\+::size\+\_\+t Lens\+::get\+N\+Main\+Halos (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}}



inserts a sequence of main lens halos and adds them to the existing ones 

replaces existing main halos with a single main halo replaces existing main halos with a sequence of main halos get number of main halos \mbox{\Hypertarget{class_lens_a4fa714f37553b29a50a6d2b532a99013}\label{class_lens_a4fa714f37553b29a50a6d2b532a99013}} 
\index{Lens@{Lens}!info\_rayshooter@{info\_rayshooter}}
\index{info\_rayshooter@{info\_rayshooter}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{info\_rayshooter()}{info\_rayshooter()}}
{\footnotesize\ttfamily void Lens\+::info\+\_\+rayshooter (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_r_a_y}{R\+AY}} \&}]{ray,  }\item[{std\+::vector$<$ \mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} $>$ \&}]{ang\+\_\+positions,  }\item[{std\+::vector$<$ Kappa\+Type $>$ \&}]{kappa\+\_\+on\+\_\+planes,  }\item[{std\+::vector$<$ std\+::vector$<$ \mbox{\hyperlink{class_lens_halo}{Lens\+Halo}} $\ast$ $>$$>$ \&}]{halo\+\_\+neighbors,  }\item[{\mbox{\hyperlink{class_lens_halo}{Lens\+Halo}} \&}]{halo\+\_\+max,  }\item[{Kappa\+Type \&}]{kappa\+\_\+max,  }\item[{Kappa\+Type}]{gamma\+\_\+max\mbox{[}$\,$\mbox{]},  }\item[{Pos\+Type}]{rmax,  }\item[{int}]{tag = {\ttfamily 0},  }\item[{short}]{mode = {\ttfamily 0},  }\item[{bool}]{verbose = {\ttfamily false} }\end{DoxyParamCaption})}



single ray 

Collects information about the halos and kappa contributions along the light path.

Information on the nearest halos is collected where nearest is defined by rmax and mode. When mode == 2 the unlensed angular coordinates are used to evaluate proximity not the lensed ones. 
\begin{DoxyParams}{Parameters}
{\em ray} & ray, ray.\+x needs to be set, all other quantities will be calculated \\
\hline
{\em ang\+\_\+positions} & angular positions on each plane \\
\hline
{\em kappa\+\_\+on\+\_\+planes} & convergence on each plane \\
\hline
{\em halo\+\_\+neighbors} & neighboring halos within rmax of ray on each plane \\
\hline
{\em halo\+\_\+max} & halo with the larges kappa \\
\hline
{\em kappa\+\_\+max} & the kappa from that halo \\
\hline
{\em gamma\+\_\+max} & shear from that halo \\
\hline
{\em rmax} & distance from ray on each plane, units depend on mode parameter \\
\hline
{\em tag} & i f not 0, information on halos with this tag are gathered \\
\hline
{\em mode} & 0\+:physical distance, 1\+: comoving distance, 2\+: angular distance \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_lens_af7403e6372cd1a396fb098cbd1d824cc}\label{class_lens_af7403e6372cd1a396fb098cbd1d824cc}} 
\index{Lens@{Lens}!insertMainHalos@{insertMainHalos}}
\index{insertMainHalos@{insertMainHalos}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{insertMainHalos()}{insertMainHalos()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
void Lens\+::insert\+Main\+Halos (\begin{DoxyParamCaption}\item[{std\+::vector$<$ T $>$ \&}]{my\+\_\+halos,  }\item[{bool}]{addplanes,  }\item[{bool}]{verbose = {\ttfamily false} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Inserts a sequense of main lens halos and adds them to the existing ones. Then all lensing planes are updated accordingly. If addplanes is true new planes will be added otherwise the halo is added to the nearest plane and a plane is added only if none exited on entry. 

The angular position of the halo should be preserved, but the x coordinates may change The halos are copied so the input halos can be destoyed without affecting the \mbox{\hyperlink{class_lens}{Lens}}. \mbox{\Hypertarget{class_lens_a5e683b56effd97638db0dceb4cd04c3c}\label{class_lens_a5e683b56effd97638db0dceb4cd04c3c}} 
\index{Lens@{Lens}!mass\_on\_planes@{mass\_on\_planes}}
\index{mass\_on\_planes@{mass\_on\_planes}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{mass\_on\_planes()}{mass\_on\_planes()}}
{\footnotesize\ttfamily void Lens\+::mass\+\_\+on\+\_\+planes (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ \mbox{\hyperlink{struct_r_a_y}{R\+AY}} $>$ \&}]{rays,  }\item[{std\+::vector$<$ double $>$ \&}]{masses,  }\item[{bool}]{verbose = {\ttfamily false} }\end{DoxyParamCaption})}



finds the mass within a curve of rays one every lens plane im Msun 


\begin{DoxyParams}{Parameters}
{\em rays} & ray, ray.\+x needs to be set \\
\hline
{\em masses} & mass within curve on each lens plane \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_lens_aa8a8bbd818794bc97ee6d3f842e82e54}\label{class_lens_aa8a8bbd818794bc97ee6d3f842e82e54}} 
\index{Lens@{Lens}!moveinMainHalo@{moveinMainHalo}}
\index{moveinMainHalo@{moveinMainHalo}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{moveinMainHalo()}{moveinMainHalo()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
void Lens\+::movein\+Main\+Halo (\begin{DoxyParamCaption}\item[{T \&}]{halo\+\_\+in,  }\item[{bool}]{addplanes,  }\item[{bool}]{verbose = {\ttfamily false} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



This has the same effect as \mbox{\hyperlink{class_lens_a177ee7cbb406d835865edd855b556d63}{insert\+Main\+Halo()}}, but the halo is not copied, it is moved. 

The \mbox{\hyperlink{class_lens}{Lens}} will take possession of the halo and will destroy it when it is destroyed. This is to avoid copying halos that take up a lot of memory and require a lot of time to copy like \mbox{\hyperlink{class_lens_halo_particles}{Lens\+Halo\+Particles()}}. \mbox{\Hypertarget{class_lens_a2e312accd9681ad7e131b5530ca2affd}\label{class_lens_a2e312accd9681ad7e131b5530ca2affd}} 
\index{Lens@{Lens}!operator=@{operator=}}
\index{operator=@{operator=}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{operator=()}{operator=()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_lens}{Lens}}\& Lens\+::operator= (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{class_lens}{Lens}} \&\&}]{lens }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Mixed\+Vector cannot be copyed\mbox{\Hypertarget{class_lens_a7a8ed89e743c26f14ab8e3992fa3118a}\label{class_lens_a7a8ed89e743c26f14ab8e3992fa3118a}} 
\index{Lens@{Lens}!rayshooter@{rayshooter}}
\index{rayshooter@{rayshooter}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{rayshooter()}{rayshooter()}}
{\footnotesize\ttfamily void Lens\+::rayshooter (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_r_a_y}{R\+AY}} \&}]{ray }\end{DoxyParamCaption})}



Using to shoot a single ray. 

This function calculates the deflection, shear, convergence, rotation and time-\/delay of rays in parallel. The source redshift must be set for the ray.

ray.\+x should be set to the image position. The kappa,gamma,deflection, time-\/delay and source position will be calculated at that image point. \mbox{\Hypertarget{class_lens_a2575c6d766091cde0ce87249e97333f1}\label{class_lens_a2575c6d766091cde0ce87249e97333f1}} 
\index{Lens@{Lens}!rayshooterInternal@{rayshooterInternal}}
\index{rayshooterInternal@{rayshooterInternal}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{rayshooterInternal()}{rayshooterInternal()}\hspace{0.1cm}{\footnotesize\ttfamily [1/3]}}
{\footnotesize\ttfamily void Lens\+::rayshooter\+Internal (\begin{DoxyParamCaption}\item[{unsigned long}]{Npoints,  }\item[{\mbox{\hyperlink{struct_linked_point}{Linked\+Point}} $\ast$}]{i\+\_\+points,  }\item[{std\+::vector$<$ double $>$ \&}]{source\+\_\+zs,  }\item[{bool}]{R\+S\+Iverbose = {\ttfamily false} }\end{DoxyParamCaption})}



Routine for shooting rays with differnt source redshifts in parrallel. 

i\+\_\+points\mbox{[}\mbox{]}.x must be set to the image postion in angular radians. 
\begin{DoxyParams}{Parameters}
{\em Npoints} & number of points to be shot \\
\hline
{\em i\+\_\+points} & poinst on the image plane \\
\hline
{\em source\+\_\+zs} & source redshifts \\
\hline
{\em R\+S\+Iverbose} & verbose option \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_lens_a711067d75213f4e6bc0f8a5606faf66a}\label{class_lens_a711067d75213f4e6bc0f8a5606faf66a}} 
\index{Lens@{Lens}!rayshooterInternal@{rayshooterInternal}}
\index{rayshooterInternal@{rayshooterInternal}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{rayshooterInternal()}{rayshooterInternal()}\hspace{0.1cm}{\footnotesize\ttfamily [2/3]}}
{\footnotesize\ttfamily void Lens\+::rayshooter\+Internal (\begin{DoxyParamCaption}\item[{unsigned long}]{Npoints,  }\item[{\mbox{\hyperlink{struct_point}{Point}} $\ast$}]{i\+\_\+points,  }\item[{bool}]{R\+S\+Iverbose = {\ttfamily false} }\end{DoxyParamCaption})}



Main routine for shooting rays in parrallel. 

i\+\_\+points\mbox{[}\mbox{]}.x must be set to the image postion in angular radians.

i\+\_\+points must have linked image points. {\ttfamily \mbox{\hyperlink{struct_linked_point}{Linked\+Point}}}s could be used, but for its internal use this is not done. 
\begin{DoxyParams}{Parameters}
{\em Npoints} & number of points to be shot \\
\hline
{\em i\+\_\+points} & points on the image plane \\
\hline
{\em R\+S\+Iverbose} & verbose option \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_lens_ae505c3e066e52d60372449aecc7ae6b0}\label{class_lens_ae505c3e066e52d60372449aecc7ae6b0}} 
\index{Lens@{Lens}!rayshooterInternal@{rayshooterInternal}}
\index{rayshooterInternal@{rayshooterInternal}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{rayshooterInternal()}{rayshooterInternal()}\hspace{0.1cm}{\footnotesize\ttfamily [3/3]}}
{\footnotesize\ttfamily void Lens\+::rayshooter\+Internal (\begin{DoxyParamCaption}\item[{unsigned long}]{Npoints,  }\item[{\mbox{\hyperlink{struct_r_a_y}{R\+AY}} $\ast$}]{rays }\end{DoxyParamCaption})}


\begin{DoxyParams}{Parameters}
{\em Npoints} & number of points to be shot \\
\hline
{\em rays} & points on the image plane \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{class_lens_aba7e1b3c66565092fdc7555dc4704896}\label{class_lens_aba7e1b3c66565092fdc7555dc4704896}} 
\index{Lens@{Lens}!replaceMainHalo@{replaceMainHalo}}
\index{replaceMainHalo@{replaceMainHalo}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{replaceMainHalo()}{replaceMainHalo()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
void Lens\+::replace\+Main\+Halo (\begin{DoxyParamCaption}\item[{const T \&}]{halo\+\_\+in,  }\item[{bool}]{addplanes,  }\item[{bool}]{verbose = {\ttfamily false} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Inserts a single main lens halo and deletes all previous ones. Then all lensing planes are updated accordingly. 

Note that this does delete all the halos that were there. \mbox{\Hypertarget{class_lens_a0cfbb73f3ff13e43beccb50d18a89af4}\label{class_lens_a0cfbb73f3ff13e43beccb50d18a89af4}} 
\index{Lens@{Lens}!replaceMainHalos@{replaceMainHalos}}
\index{replaceMainHalos@{replaceMainHalos}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{replaceMainHalos()}{replaceMainHalos()}}
{\footnotesize\ttfamily template$<$typename T $>$ \\
void Lens\+::replace\+Main\+Halos (\begin{DoxyParamCaption}\item[{std\+::vector$<$ T $>$ \&}]{my\+\_\+halos,  }\item[{bool}]{verbose }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



Inserts a sequense of main lens halos and remove all previous ones. 

Note that this does delete the halos that were there. Then all lensing planes are updated accordingly. \mbox{\Hypertarget{class_lens_ae4151410075a47b095f2f716055b1c69}\label{class_lens_ae4151410075a47b095f2f716055b1c69}} 
\index{Lens@{Lens}!resetFieldHalos@{resetFieldHalos}}
\index{resetFieldHalos@{resetFieldHalos}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{resetFieldHalos()}{resetFieldHalos()}}
{\footnotesize\ttfamily void Lens\+::reset\+Field\+Halos (\begin{DoxyParamCaption}\item[{bool}]{verbose = {\ttfamily false} }\end{DoxyParamCaption})}

keep the main lens and the number of planes constant, but generate new field halos. \mbox{\Hypertarget{class_lens_a71b1279d35b08c49d537708a46c1d3a6}\label{class_lens_a71b1279d35b08c49d537708a46c1d3a6}} 
\index{Lens@{Lens}!ResetSourcePlane@{ResetSourcePlane}}
\index{ResetSourcePlane@{ResetSourcePlane}!Lens@{Lens}}
\doxysubsubsection{\texorpdfstring{ResetSourcePlane()}{ResetSourcePlane()}}
{\footnotesize\ttfamily short Lens\+::\+Reset\+Source\+Plane (\begin{DoxyParamCaption}\item[{Pos\+Type}]{z,  }\item[{bool}]{nearest = {\ttfamily false},  }\item[{bool}]{verbose = {\ttfamily false} }\end{DoxyParamCaption})}



reset the redshift of the source plane 

Changes the maximum redshift that the rays are shot to. Warning\+: Grids that have already been made with this \mbox{\hyperlink{class_lens}{Lens}} will not have this new source redshift.

The multilens must have been initially constructed with a source redshift that is higher than this redshift. This is used to rayshoot to a source whose line of sight passes through the simulation volume. The source can be at higher redshift than the simulation volume.

To revert the source redshift to its original value use \mbox{\hyperlink{class_lens_af4c16d98618b2a26e75c2673af2058c2}{Lens\+::\+Revert\+Source\+Plane()}}. 
\begin{DoxyParams}{Parameters}
{\em z} & redshift of implanted source \\
\hline
{\em nearest} & If true, set the source plane to the nearest (in coordinate distance) lensing plane that was created already. This can be used to avoid self-\/lensing by the halo of the source. If the source is at higher redshift than the simulation volume the source will be at its real redshift. \\
\hline
\end{DoxyParams}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
S\+Lsim\+Lib/include/lens.\+h\item 
S\+Lsim\+Lib/\+Full\+Range/internal\+\_\+rayshooter\+\_\+multi.\+cpp\item 
S\+Lsim\+Lib/\+Multi\+Plane/lens.\+cpp\item 
S\+Lsim\+Lib/\+Multi\+Plane/lens\+\_\+multi\+\_\+dark.\+cpp\item 
S\+Lsim\+Lib/\+Tree\+Code\+\_\+link/image\+\_\+finder.\+cpp\end{DoxyCompactItemize}
