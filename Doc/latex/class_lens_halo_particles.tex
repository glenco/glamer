\doxysection{Lens\+Halo\+Particles\texorpdfstring{$<$}{<} PType \texorpdfstring{$>$}{>} Class Template Reference}
\hypertarget{class_lens_halo_particles}{}\label{class_lens_halo_particles}\index{LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}}


A class that represents the lensing by a collection of simulation particles.  




{\ttfamily \#include $<$particle\+\_\+halo.\+h$>$}



Inheritance diagram for Lens\+Halo\+Particles\texorpdfstring{$<$}{<} PType \texorpdfstring{$>$}{>}\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=182pt]{class_lens_halo_particles__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Lens\+Halo\+Particles\texorpdfstring{$<$}{<} PType \texorpdfstring{$>$}{>}\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_lens_halo_particles__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_lens_halo_particles_a9930f80c98af4265ecd12f72419aa7fa}{Lens\+Halo\+Particles}} (const std\+::string \&simulation\+\_\+filename, \mbox{\hyperlink{particle__types_8h_a37e57edf96c5308d47d38beee2b4cb2c}{Sim\+File\+Format}} format, Pos\+Type redshift, int Nsmooth, const \mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&cosmo, \mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} theta\+\_\+rotate, bool recenter, bool my\+\_\+multimass, double inv\+\_\+area, Pos\+Type Min\+PSize=0, Pos\+Type rescale\+\_\+mass=1.\+0, bool verbose=false)
\item 
\mbox{\hyperlink{class_lens_halo_particles_abcbba40dce46b265c1873f32820fb71b}{Lens\+Halo\+Particles}} (std\+::vector$<$ PType $>$ \&pvector, float redshift, const \mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&cosmo, \mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} theta\+\_\+rotate, bool recenter, double my\+\_\+inv\+\_\+area, float Min\+PSize=0, double max\+\_\+range=-\/1, bool verbose=false)
\item 
\mbox{\hyperlink{class_lens_halo_particles_a48d4ed53ba5e81f0af6a1339423fbe66}{Lens\+Halo\+Particles}} (PType \texorpdfstring{$\ast$}{*}begin, size\+\_\+t n, float redshift, const \mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&cosmo, \mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} theta\+\_\+rotate, bool recenter, double my\+\_\+inv\+\_\+area, float Min\+PSize=0, double max\+\_\+range=-\/1, bool verbose=false)
\begin{DoxyCompactList}\small\item\em this constructor does not take possession of the particles \end{DoxyCompactList}\item 
\Hypertarget{class_lens_halo_particles_a0c31d8d5f869a0280a83113a85d5607d}\label{class_lens_halo_particles_a0c31d8d5f869a0280a83113a85d5607d} 
{\bfseries Lens\+Halo\+Particles} (\mbox{\hyperlink{class_lens_halo_particles}{Lens\+Halo\+Particles}} \&\&h)
\item 
\Hypertarget{class_lens_halo_particles_a408d7b39441e5444fc10e4553ce635f5}\label{class_lens_halo_particles_a408d7b39441e5444fc10e4553ce635f5} 
\mbox{\hyperlink{class_lens_halo_particles}{Lens\+Halo\+Particles}}$<$ PType $>$ \& {\bfseries operator=} (\mbox{\hyperlink{class_lens_halo_particles}{Lens\+Halo\+Particles}}$<$ PType $>$ \&\&h)
\item 
void \mbox{\hyperlink{class_lens_halo_particles_a9b240b0b6e022039c971dde8864ce6fd}{force\+\_\+halo}} (double \texorpdfstring{$\ast$}{*}alpha, Kappa\+Type \texorpdfstring{$\ast$}{*}kappa, Kappa\+Type \texorpdfstring{$\ast$}{*}gamma, Kappa\+Type \texorpdfstring{$\ast$}{*}phi, double const \texorpdfstring{$\ast$}{*}xcm, bool subtract\+\_\+point=false, Pos\+Type screening=1.\+0)
\item 
\Hypertarget{class_lens_halo_particles_ae71fae2b5d397b865c2f8df70019bf42}\label{class_lens_halo_particles_ae71fae2b5d397b865c2f8df70019bf42} 
size\+\_\+t {\bfseries getN} () const
\item 
void \mbox{\hyperlink{class_lens_halo_particles_a6d2a87ae29ff2a1840ffced17599d8a9}{rotate}} (\mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} theta)
\begin{DoxyCompactList}\small\item\em rotate the simulation around the origin of the simulation coordinates, (radians) \end{DoxyCompactList}\item 
\Hypertarget{class_lens_halo_particles_a5b60131204bd264e6ceb0bc1852f27fb}\label{class_lens_halo_particles_a5b60131204bd264e6ceb0bc1852f27fb} 
\mbox{\hyperlink{struct_point__3d}{Point\+\_\+3d}} {\bfseries Center\+Of\+Mass} ()
\begin{DoxyCompactList}\small\item\em get current center of mass in input coordinates \end{DoxyCompactList}\item 
\Hypertarget{class_lens_halo_particles_a0f055f6c37e1cedb5104c907e159fd6f}\label{class_lens_halo_particles_a0f055f6c37e1cedb5104c907e159fd6f} 
\mbox{\hyperlink{struct_point__3d}{Point\+\_\+3d}} {\bfseries Densest\+Point} ()
\begin{DoxyCompactList}\small\item\em get the densistt point in input coordinates \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_lens_halo_particles_a4fbe0f1a990d0e8c070e4f79b5c831b8}{read\+Position\+File\+ASCII}} (const std\+::string \&filename)
\begin{DoxyCompactList}\small\item\em Reads number of particle and particle positons into Npoint and xp from a ASCII file. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{class_lens_halo}{Lens\+Halo}}}
\begin{DoxyCompactItemize}
\item 
{\bfseries Lens\+Halo} ()
\begin{DoxyCompactList}\small\item\em Shell constructor. \end{DoxyCompactList}\item 
{\bfseries Lens\+Halo} (Pos\+Type z, const \mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&cosmo)
\item 
\mbox{\hyperlink{class_lens_halo_a0b96fdb10f3a10a2b65085fa5883ec1f}{Lens\+Halo}} (const \mbox{\hyperlink{class_lens_halo}{Lens\+Halo}} \&h)
\item 
{\bfseries Lens\+Halo} (\mbox{\hyperlink{class_lens_halo}{Lens\+Halo}} \&\&h)
\item 
\mbox{\hyperlink{class_lens_halo}{Lens\+Halo}} \& \mbox{\hyperlink{class_lens_halo_aaa135c7e56a24de4a1dee76604a44141}{operator=}} (const \mbox{\hyperlink{class_lens_halo}{Lens\+Halo}} \&h)
\item 
\mbox{\hyperlink{class_lens_halo}{Lens\+Halo}} \& \mbox{\hyperlink{class_lens_halo_a9be986a94c12228b2e5c173c1cf5d85c}{operator=}} (\mbox{\hyperlink{class_lens_halo}{Lens\+Halo}} \&\&h)
\item 
float \mbox{\hyperlink{class_lens_halo_a6aee0c9abc88ca6d3d8ed9e44a18e6e3}{get\+\_\+\+Rmax}} () const
\begin{DoxyCompactList}\small\item\em this can be used to tag types of Lens\+Halos \end{DoxyCompactList}\item 
float {\bfseries get\+Rsize} () const
\begin{DoxyCompactList}\small\item\em get the Rsize which is the size of the halo in Mpc \end{DoxyCompactList}\item 
float {\bfseries get\+\_\+mass} () const
\begin{DoxyCompactList}\small\item\em get the mass solar units \end{DoxyCompactList}\item 
float {\bfseries get\+\_\+rscale} () const
\begin{DoxyCompactList}\small\item\em get the scale radius in Mpc \end{DoxyCompactList}\item 
Pos\+Type {\bfseries get\+Zlens} () const
\begin{DoxyCompactList}\small\item\em get the redshift \end{DoxyCompactList}\item 
void {\bfseries getX} (Pos\+Type \texorpdfstring{$\ast$}{*}My\+Pos\+Halo) const
\begin{DoxyCompactList}\small\item\em get the position of the Halo in physical Mpc on the lens plane \end{DoxyCompactList}\item 
Pos\+Type {\bfseries operator\mbox{[}$\,$\mbox{]}} (int i) const
\begin{DoxyCompactList}\small\item\em returns position of the Halo in physical Mpc on the lens plane \end{DoxyCompactList}\item 
void {\bfseries set\+Theta} (Pos\+Type PosX, Pos\+Type PosY)
\begin{DoxyCompactList}\small\item\em set the position of the Halo in radians \end{DoxyCompactList}\item 
void {\bfseries set\+Theta} (Pos\+Type \texorpdfstring{$\ast$}{*}Pos\+XY)
\begin{DoxyCompactList}\small\item\em set the position of the Halo in radians \end{DoxyCompactList}\item 
void {\bfseries set\+Theta} (const \mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} \&p)
\begin{DoxyCompactList}\small\item\em set the position of the Halo in radians \end{DoxyCompactList}\item 
void {\bfseries get\+Theta} (Pos\+Type \texorpdfstring{$\ast$}{*}My\+Pos\+Halo) const
\begin{DoxyCompactList}\small\item\em get the position of the Halo in radians \end{DoxyCompactList}\item 
void {\bfseries set\+Dist} (\mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&co)
\begin{DoxyCompactList}\small\item\em Set the angular size distance to the halo. This should be the distance to the lens plane. \end{DoxyCompactList}\item 
Pos\+Type \mbox{\hyperlink{class_lens_halo_a50bd89dc5d7d11932c757eb4e962b6ba}{get\+Dist}} () const
\item 
void \mbox{\hyperlink{class_lens_halo_a81938111b0d90611edcff8b2d4dd8432}{display\+Pos}} ()
\item 
virtual void \mbox{\hyperlink{class_lens_halo_a645d2cbd9e686ce0d061d83d28c88eb0}{init\+From\+File}} (float my\+\_\+mass, long \texorpdfstring{$\ast$}{*}seed, float vmax, float r\+\_\+halfmass)
\begin{DoxyCompactList}\small\item\em initialize from a simulation file \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{class_lens_halo_a8b31bdf68c61572e7a32dc3da6b139c8}{init\+From\+Mass\+Func}} (float my\+\_\+mass, float my\+\_\+\+Rsize, float my\+\_\+rscale, Pos\+Type my\+\_\+slope, long \texorpdfstring{$\ast$}{*}seed)
\begin{DoxyCompactList}\small\item\em initialize from a mass function \end{DoxyCompactList}\item 
virtual void {\bfseries set\+\_\+\+Rsize\+Rmax} (float my\+\_\+\+Rsize)
\begin{DoxyCompactList}\small\item\em set Rsize (in Mpc) and reset Rmax \end{DoxyCompactList}\item 
void {\bfseries set\+\_\+mass} (float my\+\_\+mass)
\begin{DoxyCompactList}\small\item\em set mass (in solar masses) \end{DoxyCompactList}\item 
virtual void {\bfseries set\+\_\+rscale} (float my\+\_\+rscale)
\begin{DoxyCompactList}\small\item\em set scale radius (in Mpc) \end{DoxyCompactList}\item 
void {\bfseries set\+Zlens} (Pos\+Type my\+\_\+zlens, const \mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&cosmo)
\begin{DoxyCompactList}\small\item\em set redshift \end{DoxyCompactList}\item 
void {\bfseries set\+Rsize} (Pos\+Type R)
\item 
void {\bfseries set\+Zlens\+Dist} (Pos\+Type my\+\_\+zlens, const \mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&cos)
\item 
void {\bfseries set\+Mass} (Pos\+Type m)
\item 
virtual void \mbox{\hyperlink{class_lens_halo_ababdb795dfb3955b14078a8fe777d608}{set\+\_\+slope}} (Pos\+Type my\+\_\+slope)
\begin{DoxyCompactList}\small\item\em set slope \end{DoxyCompactList}\item 
virtual Pos\+Type \mbox{\hyperlink{class_lens_halo_a2deb914a879890de10a76323cf056aae}{get\+\_\+slope}} ()
\begin{DoxyCompactList}\small\item\em get slope \end{DoxyCompactList}\item 
bool {\bfseries get\+\_\+flag\+\_\+elliptical} ()
\begin{DoxyCompactList}\small\item\em flag=True if halo elliptical \end{DoxyCompactList}\item 
void {\bfseries set\+\_\+flag\+\_\+elliptical} (bool ell)
\item 
bool {\bfseries get\+\_\+switch\+\_\+flag} ()
\item 
void {\bfseries set\+\_\+switch\+\_\+flag} (bool swt)
\begin{DoxyCompactList}\small\item\em flag permits case distinction in force\+\_\+halo\+\_\+asym for elliptical NFWs only (get\+\_\+switch\+\_\+flag==true), in latter case the mass\+\_\+norm\+\_\+factor\texorpdfstring{$^\wedge$}{\string^}2 is used instead of mass\+\_\+norm\+\_\+factor. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{class_lens_halo_ae93d20b6fdeaaab7d1f0a61a13e6d644}{set\+Cosmology}} (const \mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&cosmo)
\begin{DoxyCompactList}\small\item\em used for elliptical NFWs only, in that case get\+\_\+switch\+\_\+flag==true \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{class_lens_halo_a9125a5a6f4685d157dfbeacd00433ab2}{compareZ}} (Pos\+Type z)
\begin{DoxyCompactList}\small\item\em force tree calculation for stars \end{DoxyCompactList}\item 
\mbox{\hyperlink{_input_params_8h_abeeb8c8413457c56ac46767a52fc2618}{Ellip\+Method}} \mbox{\hyperlink{class_lens_halo_ae4e6a8b770a38df28c9bee8799385923}{get\+Ellip\+Method}} () const
\begin{DoxyCompactList}\small\item\em stars \end{DoxyCompactList}\item 
std\+::vector$<$ double $>$ {\bfseries get\+\_\+mod} ()
\begin{DoxyCompactList}\small\item\em get vector of Fourier modes, which are calculated in the constructors of the Lens\+Haloes when main\+\_\+ellip\+\_\+method is set to \textquotesingle{}Fourier\textquotesingle{} \end{DoxyCompactList}\item 
virtual std\+::size\+\_\+t {\bfseries Nparams} () const
\begin{DoxyCompactList}\small\item\em get the number of halo parameters \end{DoxyCompactList}\item 
virtual Pos\+Type {\bfseries get\+Param} (std\+::size\+\_\+t p) const
\begin{DoxyCompactList}\small\item\em get the value of a scaled halo parameter by index \end{DoxyCompactList}\item 
virtual Pos\+Type {\bfseries set\+Param} (std\+::size\+\_\+t p, Pos\+Type value)
\begin{DoxyCompactList}\small\item\em set the value of a scaled halo parameter by index \end{DoxyCompactList}\item 
virtual void {\bfseries print\+CSV} (std\+::ostream \&, bool header=false) const
\begin{DoxyCompactList}\small\item\em print the halo parameters in CSV format \end{DoxyCompactList}\item 
Pos\+Type \mbox{\hyperlink{class_lens_halo_a7184a202e39fac7cf8f7d0436abdc982}{Mass\+By2\+DIntegation}} (Pos\+Type R)
\begin{DoxyCompactList}\small\item\em Prints star parameters; if show\+\_\+stars is true, prints data for single stars. \end{DoxyCompactList}\item 
Pos\+Type {\bfseries Mass\+By1\+DIntegation} (Pos\+Type R)
\begin{DoxyCompactList}\small\item\em calculates the mass within radius R by integating alpha on a ring and using Gauss\textquotesingle{} law, used only for testing \end{DoxyCompactList}\item 
Pos\+Type {\bfseries test\+\_\+average\+\_\+gt} (Pos\+Type R)
\begin{DoxyCompactList}\small\item\em calculates the average gamma\+\_\+t for \doxylink{class_lens_halo_a9b357894d8d644741be0cec08e45bb30}{Lens\+Halo\+::test()} \end{DoxyCompactList}\item 
Pos\+Type {\bfseries test\+\_\+average\+\_\+kappa} (Pos\+Type R)
\item 
void {\bfseries set\+\_\+norm\+\_\+factor} ()
\item 
void {\bfseries set\+\_\+rsize} (float my\+\_\+rsize)
\begin{DoxyCompactList}\small\item\em set radius rsize beyond which interpolation values between alpha\+\_\+ellip and alpha\+\_\+iso are computed \end{DoxyCompactList}\item 
float {\bfseries get\+\_\+rsize} ()
\item 
bool \mbox{\hyperlink{class_lens_halo_a9b357894d8d644741be0cec08e45bb30}{test}} ()
\begin{DoxyCompactList}\small\item\em perform some basic consistancy checks for halo \end{DoxyCompactList}\item 
size\+\_\+t {\bfseries get\+ID} () const
\item 
void {\bfseries set\+ID} (size\+\_\+t id)
\item 
Pos\+Type {\bfseries renormalization} (Pos\+Type r\+\_\+max)
\item 
\mbox{\hyperlink{class_pixel_map}{Pixel\+Map}}$<$ double $>$ \mbox{\hyperlink{class_lens_halo_a0652d15d437d73b38dc8b057ed2c025f}{map\+\_\+variables}} (\mbox{\hyperlink{standard_8h_a73d5f5042d9b38366d0b3781d199f9e7}{Lensing\+Variable}} lensvar, size\+\_\+t Nx, size\+\_\+t Ny, double res)
\begin{DoxyCompactList}\small\item\em Map a \doxylink{class_pixel_map}{Pixel\+Map} of the surface, density, potential and potential gradient centred on (0,0) in \doxylink{class_lens_halo}{Lens\+Halo} coordinates. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static void \mbox{\hyperlink{class_lens_halo_particles_a6f74ecb8b18030fe0f01136192d9e4bb}{make\+SIE}} (std\+::string new\+\_\+filename, Pos\+Type redshift, double particle\+\_\+mass, double total\+\_\+mass, double sigma, double q, \mbox{\hyperlink{class_utilities_1_1_random_numbers___n_r}{Utilities\+::\+Random\+Numbers\+\_\+\+NR}} \&ran)
\begin{DoxyCompactList}\small\item\em This is a test static function that makes a truncated SIE out of particles and puts it into a file in the right format for constructing a \doxylink{class_lens_halo_particles}{Lens\+Halo\+Particles}. \end{DoxyCompactList}\item 
static \mbox{\hyperlink{class_lens_halo_particles}{Lens\+Halo\+Particles}}$<$ \mbox{\hyperlink{struct_particle_type_simple}{Particle\+Type\+Simple}} $>$ \mbox{\hyperlink{class_lens_halo_particles_a46def593bc40d817ca3c45d521b700ce}{SIE}} (Pos\+Type redshift, double particle\+\_\+mass, double total\+\_\+mass, double sigma, double q, int Nneighbors, \mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&cosmo, \mbox{\hyperlink{class_utilities_1_1_random_numbers___n_r}{Utilities\+::\+Random\+Numbers\+\_\+\+NR}} \&ran)
\begin{DoxyCompactList}\small\item\em This is a test static function that makes a truncated SIE out of particles and puts it into a file in the right format for constructing a \doxylink{class_lens_halo_particles}{Lens\+Halo\+Particles}. \end{DoxyCompactList}\item 
\Hypertarget{class_lens_halo_particles_a8cbb000f56bbde0f4df611fe12580a41}\label{class_lens_halo_particles_a8cbb000f56bbde0f4df611fe12580a41} 
static void {\bfseries calculate\+\_\+smoothing} (int Nsmooth, PType \texorpdfstring{$\ast$}{*}pp, size\+\_\+t Npoints, bool verbose=false)
\item 
\Hypertarget{class_lens_halo_particles_a99b7ae99ee5a6eb463c92aca9337e5a7}\label{class_lens_halo_particles_a99b7ae99ee5a6eb463c92aca9337e5a7} 
static void {\bfseries write\+Sizes} (const std\+::string \&filename, int Nsmooth, const PType \texorpdfstring{$\ast$}{*}pp, size\+\_\+t Npoints)
\item 
\Hypertarget{class_lens_halo_particles_a199a8067e9aaa50fd8a56169f397f47e}\label{class_lens_halo_particles_a199a8067e9aaa50fd8a56169f397f47e} 
static bool {\bfseries read\+Sizes\+File} (const std\+::string \&filename, PType \texorpdfstring{$\ast$}{*}pp, size\+\_\+t Npoints, int Nsmooth, Pos\+Type min\+\_\+size)
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions inherited from \mbox{\hyperlink{class_lens_halo}{Lens\+Halo}}}
\begin{DoxyCompactItemize}
\item 
static const int {\bfseries get\+\_\+\+Nmod} ()
\begin{DoxyCompactList}\small\item\em get length of mod array, which is Nmod. Not to be confused with get\+Nmodes in the class \doxylink{class_lens_halo_fit}{Lens\+Halo\+Fit} \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_lens_halo_particles_a287284a34695af4542c2dad6bf610baf}{Lens\+Halo\+Particles}} (float redshift, const \mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&cosmo)
\item 
\mbox{\hyperlink{class_lens_halo_particles_a36d9e0624adb91026d7ac1c648800f8c}{Lens\+Halo\+Particles}} (PType \texorpdfstring{$\ast$}{*}pdata, size\+\_\+t Nparticles, float redshift, const \mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&cosmo, \mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} theta\+\_\+rotate, bool recenter, double my\+\_\+inv\+\_\+area, bool verbose=false)
\item 
\Hypertarget{class_lens_halo_particles_ab7fcf2f83bdba9b31b1016cc3df2055d}\label{class_lens_halo_particles_ab7fcf2f83bdba9b31b1016cc3df2055d} 
void {\bfseries rotate\+\_\+particles} (Pos\+Type theta\+\_\+x, Pos\+Type theta\+\_\+y)
\item 
\Hypertarget{class_lens_halo_particles_a6f957aa525feeee444dc47085add1f2c}\label{class_lens_halo_particles_a6f957aa525feeee444dc47085add1f2c} 
void {\bfseries assign\+Params} (\mbox{\hyperlink{class_input_params}{Input\+Params}} \&params)
\item 
void \mbox{\hyperlink{class_lens_halo_particles_a96e7e332fc3494f003293e608ebc5bb6}{set\+\_\+up}} (float redshift, const \mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&cosmo, \mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}} theta\+\_\+rotate, double max\+\_\+range, bool recenter, bool verbose)
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions inherited from \mbox{\hyperlink{class_lens_halo}{Lens\+Halo}}}
\begin{DoxyCompactItemize}
\item 
Pos\+Type {\bfseries alpha\+\_\+int} (Pos\+Type x) const
\begin{DoxyCompactList}\small\item\em Calculates potential (phi\+\_\+int) from alpha\+\_\+h. If flag is\+\_\+alphah\+\_\+a\+\_\+table is True it takes and integrates directly the gfunction instead of alpha\+\_\+h. The gfunction is used for the Interpolation\+Table used in alpha\+\_\+h. Setting the flag to False speeds up the calculation of phi\+\_\+h. \end{DoxyCompactList}\item 
Pos\+Type {\bfseries norm\+\_\+int} (Pos\+Type r\+\_\+max)
\item 
void \mbox{\hyperlink{class_lens_halo_a374d199861689b8186c04d29bf92d6a2}{force\+\_\+halo\+\_\+sym}} (Pos\+Type \texorpdfstring{$\ast$}{*}alpha, Kappa\+Type \texorpdfstring{$\ast$}{*}kappa, Kappa\+Type \texorpdfstring{$\ast$}{*}gamma, Kappa\+Type \texorpdfstring{$\ast$}{*}phi, Pos\+Type const \texorpdfstring{$\ast$}{*}xcm, bool subtract\+\_\+point=false, Pos\+Type screening=1.\+0)
\begin{DoxyCompactList}\small\item\em returns the lensing quantities of a ray in center of mass coordinates for a symmetric halo \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_lens_halo_a78cc531d36104d72bec891424aba9fcb}{force\+\_\+halo\+\_\+asym}} (Pos\+Type \texorpdfstring{$\ast$}{*}alpha, Kappa\+Type \texorpdfstring{$\ast$}{*}kappa, Kappa\+Type \texorpdfstring{$\ast$}{*}gamma, Kappa\+Type \texorpdfstring{$\ast$}{*}phi, Pos\+Type const \texorpdfstring{$\ast$}{*}xcm, bool subtract\+\_\+point=false, Pos\+Type screening=1.\+0)
\item 
bool {\bfseries force\+\_\+point} (Pos\+Type \texorpdfstring{$\ast$}{*}alpha, Kappa\+Type \texorpdfstring{$\ast$}{*}kappa, Kappa\+Type \texorpdfstring{$\ast$}{*}gamma, Kappa\+Type \texorpdfstring{$\ast$}{*}phi, Pos\+Type const \texorpdfstring{$\ast$}{*}xcm, Pos\+Type rcm2, bool subtract\+\_\+point, Pos\+Type screening)
\item 
void {\bfseries assign\+Params} (\mbox{\hyperlink{class_input_params}{Input\+Params}} \&params, bool need\+Rsize)
\begin{DoxyCompactList}\small\item\em read in parameters from a parameterfile in \doxylink{class_input_params}{Input\+Params} params \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_lens_halo_a6a8cf22c76bab7821b1b0ee3b50ea75f}{error\+\_\+message1}} (std\+::string name, std\+::string filename)
\begin{DoxyCompactList}\small\item\em read in star parameters. This is valid for all halos and not overloaded. \end{DoxyCompactList}\item 
virtual Pos\+Type \mbox{\hyperlink{class_lens_halo_a9295b7b1d0a66b3742a81ead5bf2a863}{alpha\+\_\+h}} (Pos\+Type x) const
\item 
virtual Kappa\+Type {\bfseries kappa\+\_\+h} (Pos\+Type x) const
\item 
virtual Kappa\+Type {\bfseries gamma\+\_\+h} (Pos\+Type x) const
\item 
virtual Kappa\+Type {\bfseries phi\+\_\+h} (Pos\+Type x) const
\item 
virtual Kappa\+Type {\bfseries phi\+\_\+int} (Pos\+Type x) const
\item 
virtual Pos\+Type {\bfseries ffunction} (Pos\+Type x) const
\item 
virtual Pos\+Type {\bfseries gfunction} (Pos\+Type x) const
\item 
virtual Pos\+Type {\bfseries dgfunctiondx} (Pos\+Type x)
\item 
virtual Pos\+Type {\bfseries bfunction} (Pos\+Type x)
\item 
virtual Pos\+Type {\bfseries dhfunction} (Pos\+Type x) const
\item 
virtual Pos\+Type {\bfseries ddhfunction} (Pos\+Type x, bool numerical)
\item 
virtual Pos\+Type {\bfseries dddhfunction} (Pos\+Type x, bool numerical)
\item 
virtual Pos\+Type {\bfseries bnumfunction} (Pos\+Type x)
\item 
virtual Pos\+Type {\bfseries dbfunction} (Pos\+Type x)
\item 
virtual Pos\+Type {\bfseries ddbfunction} (Pos\+Type x)
\item 
virtual Pos\+Type \mbox{\hyperlink{class_lens_halo_afeafc7e19741a79fdf5b2d1e3b21f2ee}{dmoddb}} (int whichmod, Pos\+Type q, Pos\+Type b)
\item 
virtual Pos\+Type {\bfseries ddmoddb} (int whichmod, Pos\+Type q, Pos\+Type b)
\item 
virtual Pos\+Type {\bfseries dmoddq} (int whichmod, Pos\+Type q, Pos\+Type b)
\item 
virtual Pos\+Type {\bfseries ddmoddq} (int whichmod, Pos\+Type q, Pos\+Type b)
\item 
void \mbox{\hyperlink{class_lens_halo_a825833ac8df009db76b5e4b4b4e140f9}{faxial}} (Pos\+Type x, Pos\+Type theta, Pos\+Type f\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em If set to true the correct normalization is applied for asymmetric NFW profiles, the mass\+\_\+norm\+\_\+factor is different for the other halos. \end{DoxyCompactList}\item 
void {\bfseries faxial0} (Pos\+Type theta, Pos\+Type f0\mbox{[}$\,$\mbox{]})
\item 
void {\bfseries faxial1} (Pos\+Type theta, Pos\+Type f1\mbox{[}$\,$\mbox{]})
\item 
void {\bfseries faxial2} (Pos\+Type theta, Pos\+Type f2\mbox{[}$\,$\mbox{]})
\item 
void {\bfseries gradial} (Pos\+Type r, Pos\+Type g\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Derivatives of the potential damping factor with respect to r ... TODO\+: come up with a better damping faction. \end{DoxyCompactList}\item 
void {\bfseries gradial2} (Pos\+Type r, Pos\+Type mu, Pos\+Type sigma, Pos\+Type g\mbox{[}$\,$\mbox{]})
\item 
void \mbox{\hyperlink{class_lens_halo_a70d44bd2ef4edee5fb918a61cf5d3fcf}{felliptical}} (Pos\+Type x, Pos\+Type q, Pos\+Type theta, Pos\+Type f\mbox{[}$\,$\mbox{]}, Pos\+Type g\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Calculate the derivatives of the G function = r\texorpdfstring{$\ast$}{*}sqrt(cos(theta)\texorpdfstring{$^\wedge$}{\string^}2 + q(r)\texorpdfstring{$^\wedge$}{\string^}2 sin(theta)) \end{DoxyCompactList}\item 
virtual void {\bfseries gamma\+\_\+asym} (Pos\+Type x, Pos\+Type theta, Pos\+Type gamma\mbox{[}$\,$\mbox{]})
\item 
virtual Pos\+Type \mbox{\hyperlink{class_lens_halo_ac3f16aeffae590925d115799698ebaf4}{kappa\+\_\+asym}} (Pos\+Type x, Pos\+Type theta)
\item 
virtual void \mbox{\hyperlink{class_lens_halo_a7e68cb08c90a52d21f6af474acfc20e2}{alphakappagamma\+\_\+asym}} (Pos\+Type x, Pos\+Type theta, Pos\+Type alpha\mbox{[}$\,$\mbox{]}, Pos\+Type \texorpdfstring{$\ast$}{*}kappa, Pos\+Type gamma\mbox{[}$\,$\mbox{]}, Pos\+Type \texorpdfstring{$\ast$}{*}phi)
\begin{DoxyCompactList}\small\item\em Pseudo-\/elliptical profiles by Phi(\+G)-\/Ansatz. \end{DoxyCompactList}\item 
virtual void \mbox{\hyperlink{class_lens_halo_ab90367cd516c00c93e8608894732e965}{alphakappagamma1asym}} (Pos\+Type x, Pos\+Type theta, Pos\+Type alpha\mbox{[}2\mbox{]}, Pos\+Type \texorpdfstring{$\ast$}{*}kappa, Pos\+Type gamma\mbox{[}$\,$\mbox{]}, Pos\+Type \texorpdfstring{$\ast$}{*}phi)
\begin{DoxyCompactList}\small\item\em Elliptical profiles by Fourier-\/\+Ansatz. \end{DoxyCompactList}\item 
virtual void {\bfseries alphakappagamma2asym} (Pos\+Type x, Pos\+Type theta, Pos\+Type alpha\mbox{[}2\mbox{]}, Pos\+Type \texorpdfstring{$\ast$}{*}kappa, Pos\+Type gamma\mbox{[}$\,$\mbox{]}, Pos\+Type \texorpdfstring{$\ast$}{*}phi)
\item 
virtual void {\bfseries alphakappagamma3asym} (Pos\+Type x, Pos\+Type theta, Pos\+Type alpha\mbox{[}2\mbox{]}, Pos\+Type \texorpdfstring{$\ast$}{*}kappa, Pos\+Type gamma\mbox{[}$\,$\mbox{]}, Pos\+Type \texorpdfstring{$\ast$}{*}phi)
\item 
virtual Pos\+Type {\bfseries alpha\+\_\+ell} (Pos\+Type x, Pos\+Type theta)
\item 
double {\bfseries fourier\+\_\+coeff} (double n, double q, double beta)
\begin{DoxyCompactList}\small\item\em Calculates fourier-\/coefficients for power law halo. \end{DoxyCompactList}\item 
double {\bfseries IDAXDM} (double lambda, double a2, double b2, double x\mbox{[}$\,$\mbox{]}, double rmax, double mo)
\item 
double {\bfseries IDAYDM} (double lambda, double a2, double b2, double x\mbox{[}$\,$\mbox{]}, double rmax, double mo)
\item 
double {\bfseries SCHRAMMKN} (double n, double x\mbox{[}$\,$\mbox{]}, double rmax)
\item 
double {\bfseries SCHRAMMJN} (double n, double x\mbox{[}$\,$\mbox{]}, double rmax)
\item 
double {\bfseries SCHRAMMI} (double x\mbox{[}$\,$\mbox{]}, double rmax)
\item 
void {\bfseries calc\+Modes} (double q, double beta, double rottheta, Pos\+Type newmod\mbox{[}$\,$\mbox{]})
\begin{DoxyCompactList}\small\item\em Calculates the modes for fourier expansion of power law halo. All the modes are relative to the zero mode to conserve mass throughout the calculation of kappa etc. \end{DoxyCompactList}\item 
void {\bfseries calc\+ModesB} (Pos\+Type x, double q, double beta, double rottheta, Pos\+Type newmod\mbox{[}$\,$\mbox{]})
\item 
void {\bfseries calc\+ModesC} (Pos\+Type beta\+\_\+r, double q, double rottheta, Pos\+Type newmod\mbox{[}$\,$\mbox{]})
\item 
virtual Pos\+Type {\bfseries Interpolate\+Modes} (int whichmod, Pos\+Type q, Pos\+Type b)
\item 
void \mbox{\hyperlink{class_lens_halo_affb1ead96e81d87f61d45e09a6f6fb3f}{anal\+Modes}} (int modnumber, Pos\+Type my\+\_\+beta, Pos\+Type q, Pos\+Type amod\mbox{[}3\mbox{]})
\end{DoxyCompactItemize}
\doxysubsubsection*{Static Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{class_lens_halo_particles_a87e36e35d0508c4d3b91a5bf191bcd19}\label{class_lens_halo_particles_a87e36e35d0508c4d3b91a5bf191bcd19} 
static void {\bfseries smooth\+\_\+} (\mbox{\hyperlink{class_tree_simple}{Tree\+Simple}}$<$ PType $>$ \texorpdfstring{$\ast$}{*}tree3d, PType \texorpdfstring{$\ast$}{*}xp, size\+\_\+t N, int Nsmooth)
\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{class_lens_halo_particles_a08e7a2adc2e0fcd9be5dbd40be1be230}\label{class_lens_halo_particles_a08e7a2adc2e0fcd9be5dbd40be1be230} 
\mbox{\hyperlink{struct_point__3d}{Point\+\_\+3d}} {\bfseries mcenter}
\item 
\Hypertarget{class_lens_halo_particles_a92c48538608447de920e68330e65db55}\label{class_lens_halo_particles_a92c48538608447de920e68330e65db55} 
\mbox{\hyperlink{struct_point__3d}{Point\+\_\+3d}} {\bfseries densest\+\_\+point}
\item 
\Hypertarget{class_lens_halo_particles_af258c24e430a22a319fbaa3c6ebb539c}\label{class_lens_halo_particles_af258c24e430a22a319fbaa3c6ebb539c} 
PType \texorpdfstring{$\ast$}{*} {\bfseries pp}
\item 
\Hypertarget{class_lens_halo_particles_ae2f31c2fa0aa7c84e9d2ea351c009c1b}\label{class_lens_halo_particles_ae2f31c2fa0aa7c84e9d2ea351c009c1b} 
std\+::vector$<$ PType $>$ {\bfseries trash\+\_\+collector}
\item 
\Hypertarget{class_lens_halo_particles_a59cf0f7d22f0236e72743b0b40f7d510}\label{class_lens_halo_particles_a59cf0f7d22f0236e72743b0b40f7d510} 
Pos\+Type {\bfseries min\+\_\+size}
\item 
\Hypertarget{class_lens_halo_particles_aacc642153b2118db6d6bba63999fce7e}\label{class_lens_halo_particles_aacc642153b2118db6d6bba63999fce7e} 
bool {\bfseries multimass}
\item 
\Hypertarget{class_lens_halo_particles_a6bf7b3f409b77b485fd26f84d8dad9d6}\label{class_lens_halo_particles_a6bf7b3f409b77b485fd26f84d8dad9d6} 
\mbox{\hyperlink{class_utilities_1_1_geometry_1_1_spherical_point}{Utilities\+::\+Geometry\+::\+Spherical\+Point}} {\bfseries center}
\item 
\Hypertarget{class_lens_halo_particles_aefb67743d0e07d92cffb95e0c806ea9e}\label{class_lens_halo_particles_aefb67743d0e07d92cffb95e0c806ea9e} 
size\+\_\+t {\bfseries Npoints}
\item 
\Hypertarget{class_lens_halo_particles_a429e6e1cc73da233bf6979a1970ff1e0}\label{class_lens_halo_particles_a429e6e1cc73da233bf6979a1970ff1e0} 
Pos\+Type {\bfseries inv\+\_\+area}
\item 
\Hypertarget{class_lens_halo_particles_a63f276c45da25a100e18591d1335ecc4}\label{class_lens_halo_particles_a63f276c45da25a100e18591d1335ecc4} 
std\+::string {\bfseries simfile}
\item 
\Hypertarget{class_lens_halo_particles_a176395b7de82b6dfbaa9506db8552a1c}\label{class_lens_halo_particles_a176395b7de82b6dfbaa9506db8552a1c} 
std\+::string {\bfseries sizefile}
\item 
\Hypertarget{class_lens_halo_particles_a92c1fabc38cc0c336562249c22892328}\label{class_lens_halo_particles_a92c1fabc38cc0c336562249c22892328} 
\mbox{\hyperlink{class_tree_quad_particles}{Tree\+Quad\+Particles}}$<$ PType $>$ \texorpdfstring{$\ast$}{*} {\bfseries qtree}
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes inherited from \mbox{\hyperlink{class_lens_halo}{Lens\+Halo}}}
\begin{DoxyCompactItemize}
\item 
float {\bfseries Rsize} = 0
\item 
float {\bfseries mass}
\item 
Pos\+Type {\bfseries Dist}
\item 
Pos\+Type {\bfseries mnorm}
\item 
float {\bfseries Rmax}
\item 
Pos\+Type {\bfseries beta}
\item 
float {\bfseries Rmax\+\_\+to\+\_\+\+Rsize\+\_\+ratio} = 1.\+2
\begin{DoxyCompactList}\small\item\em The factor by which Rmax is larger than Rsize. \end{DoxyCompactList}\item 
float {\bfseries rscale}
\begin{DoxyCompactList}\small\item\em scale length or core size. Different meaning in different cases. Not used in NSIE case. \end{DoxyCompactList}\item 
\mbox{\hyperlink{_input_params_8h_abeeb8c8413457c56ac46767a52fc2618}{Ellip\+Method}} {\bfseries main\+\_\+ellip\+\_\+method}
\item 
Pos\+Type {\bfseries xmax}
\item 
Pos\+Type {\bfseries mass\+\_\+norm\+\_\+factor} =1
\begin{DoxyCompactList}\small\item\em This is Rsize/rscale !! \end{DoxyCompactList}\item 
float {\bfseries pa}
\item 
float {\bfseries fratio} =1.\+0
\item 
bool {\bfseries elliptical\+\_\+flag} = false
\item 
bool {\bfseries switch\+\_\+flag} = false
\item 
Pos\+Type {\bfseries mod} \mbox{[}Nmod\mbox{]}
\item 
Pos\+Type {\bfseries mod1} \mbox{[}Nmod\mbox{]}
\item 
Pos\+Type {\bfseries mod2} \mbox{[}Nmod\mbox{]}
\item 
Pos\+Type {\bfseries r\+\_\+eps}
\end{DoxyCompactItemize}
\doxysubsubsection*{Friends}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{class_lens_halo_particles_a478a724a7073c7df9c437f1c1880fa7a}\label{class_lens_halo_particles_a478a724a7073c7df9c437f1c1880fa7a} 
class {\bfseries Make\+Particle\+Lenses}
\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}
\doxysubsection*{Public Attributes inherited from \mbox{\hyperlink{class_lens_halo}{Lens\+Halo}}}
\begin{DoxyCompactItemize}
\item 
int {\bfseries tag} =0
\end{DoxyCompactItemize}
\doxysubsection*{Static Protected Attributes inherited from \mbox{\hyperlink{class_lens_halo}{Lens\+Halo}}}
\begin{DoxyCompactItemize}
\item 
static const int {\bfseries Nmod} = 32
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$typename PType$>$\newline
class Lens\+Halo\+Particles$<$ PType $>$}
A class that represents the lensing by a collection of simulation particles. 

You can create a Lens\+Halo\+Particles$<$$>$ directly from a file, but it is recommended that you use the \doxylink{class_make_particle_lenses}{Make\+Particle\+Lenses} class to create them and then move them to a \doxylink{class_lens}{Lens} object.

Smoothing is done according to the density of particles in 3D. Smoothing sizes are either read in from a file (names simulation\+\_\+filename + "{}."{} + Nsmooth + "{}sizes"{}) or calculated if the file does not exist (in which case the file is created). This can be time and memory consuming when there are a large number of particles.

Input format\+: ASCII -\/ a table of three floats for positions in comoving Mpc (no h factor). The lines "{}\# nparticles ...."{} and "{}\# mass ...."{} must be in header at the top of the file. \# is otherwise a comment character. Only one type of particle in a single input file.

More input formats will be added in the future. 

\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{class_lens_halo_particles_a9930f80c98af4265ecd12f72419aa7fa}\index{LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}!LensHaloParticles@{LensHaloParticles}}
\index{LensHaloParticles@{LensHaloParticles}!LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}}
\doxysubsubsection{\texorpdfstring{LensHaloParticles()}{LensHaloParticles()}\hspace{0.1cm}{\footnotesize\ttfamily [1/5]}}
{\footnotesize\ttfamily \label{class_lens_halo_particles_a9930f80c98af4265ecd12f72419aa7fa} 
template$<$typename PType $>$ \\
\mbox{\hyperlink{class_lens_halo_particles}{Lens\+Halo\+Particles}}$<$ PType $>$\mbox{\hyperlink{class_lens_halo_particles}{\+::\+Lens\+Halo\+Particles}} (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{simulation\+\_\+filename}{, }\item[{\mbox{\hyperlink{particle__types_8h_a37e57edf96c5308d47d38beee2b4cb2c}{Sim\+File\+Format}}}]{format}{, }\item[{Pos\+Type}]{redshift}{, }\item[{int}]{Nsmooth}{, }\item[{const \mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&}]{cosmo}{, }\item[{\mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}}}]{theta\+\_\+rotate}{, }\item[{bool}]{recenter}{, }\item[{bool}]{my\+\_\+multimass}{, }\item[{double}]{inv\+\_\+area}{, }\item[{Pos\+Type}]{Min\+PSize}{ = {\ttfamily 0}, }\item[{Pos\+Type}]{rescale\+\_\+mass}{ = {\ttfamily 1.0}, }\item[{bool}]{verbose}{ = {\ttfamily false}}\end{DoxyParamCaption})}


\begin{DoxyParams}{Parameters}
{\em simulation\+\_\+filename} & name of data files  \\
\hline
{\em format} & format of data file  \\
\hline
{\em redshift} & redshift of origin  \\
\hline
{\em Nsmooth} & number of neighbours for adaptive smoothing  \\
\hline
{\em cosmo} & cosmology  \\
\hline
{\em theta\+\_\+rotate} & rotation of particles around the origin  \\
\hline
{\em recenter} & center on center of mass  \\
\hline
{\em my\+\_\+multimass} & set to true is particles have different sizes  \\
\hline
{\em inv\+\_\+area} & inverse area for mass compensation  \\
\hline
{\em Min\+PSize} & minimum particle size in Mpc, overrides nearest neighbors aor input sizes for small particle sizes  \\
\hline
{\em rescale\+\_\+mass} & rescale particle masses \\
\hline
\end{DoxyParams}
\Hypertarget{class_lens_halo_particles_abcbba40dce46b265c1873f32820fb71b}\index{LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}!LensHaloParticles@{LensHaloParticles}}
\index{LensHaloParticles@{LensHaloParticles}!LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}}
\doxysubsubsection{\texorpdfstring{LensHaloParticles()}{LensHaloParticles()}\hspace{0.1cm}{\footnotesize\ttfamily [2/5]}}
{\footnotesize\ttfamily \label{class_lens_halo_particles_abcbba40dce46b265c1873f32820fb71b} 
template$<$typename PType $>$ \\
\mbox{\hyperlink{class_lens_halo_particles}{Lens\+Halo\+Particles}}$<$ PType $>$\mbox{\hyperlink{class_lens_halo_particles}{\+::\+Lens\+Halo\+Particles}} (\begin{DoxyParamCaption}\item[{std\+::vector$<$ PType $>$ \&}]{pvector}{, }\item[{float}]{redshift}{, }\item[{const \mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&}]{cosmo}{, }\item[{\mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}}}]{theta\+\_\+rotate}{, }\item[{bool}]{recenter}{, }\item[{double}]{my\+\_\+inv\+\_\+area}{, }\item[{float}]{Min\+PSize}{ = {\ttfamily 0}, }\item[{double}]{max\+\_\+range}{ = {\ttfamily -\/1}, }\item[{bool}]{verbose}{ = {\ttfamily false}}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}


\begin{DoxyParams}{Parameters}
{\em pvector} & list of particles pdata\mbox{[}\mbox{]}\mbox{[}i\mbox{]} should be the position in physical Mpc, the class takes possession of the data and leaves the vector empty  \\
\hline
{\em redshift} & redshift of origin  \\
\hline
{\em cosmo} & cosmology  \\
\hline
{\em theta\+\_\+rotate} & rotation of particles around the origin  \\
\hline
{\em recenter} & center on center of mass  \\
\hline
{\em my\+\_\+inv\+\_\+area} & inverse area for mass compensation  \\
\hline
{\em Min\+PSize} & minimum particle size  \\
\hline
{\em max\+\_\+range} & if set this will cause the tree not be fully construct down to the bucket size outside this range \\
\hline
\end{DoxyParams}
\Hypertarget{class_lens_halo_particles_a48d4ed53ba5e81f0af6a1339423fbe66}\index{LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}!LensHaloParticles@{LensHaloParticles}}
\index{LensHaloParticles@{LensHaloParticles}!LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}}
\doxysubsubsection{\texorpdfstring{LensHaloParticles()}{LensHaloParticles()}\hspace{0.1cm}{\footnotesize\ttfamily [3/5]}}
{\footnotesize\ttfamily \label{class_lens_halo_particles_a48d4ed53ba5e81f0af6a1339423fbe66} 
template$<$typename PType $>$ \\
\mbox{\hyperlink{class_lens_halo_particles}{Lens\+Halo\+Particles}}$<$ PType $>$\mbox{\hyperlink{class_lens_halo_particles}{\+::\+Lens\+Halo\+Particles}} (\begin{DoxyParamCaption}\item[{PType \texorpdfstring{$\ast$}{*}}]{begin}{, }\item[{size\+\_\+t}]{n}{, }\item[{float}]{redshift}{, }\item[{const \mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&}]{cosmo}{, }\item[{\mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}}}]{theta\+\_\+rotate}{, }\item[{bool}]{recenter}{, }\item[{double}]{my\+\_\+inv\+\_\+area}{, }\item[{float}]{Min\+PSize}{ = {\ttfamily 0}, }\item[{double}]{max\+\_\+range}{ = {\ttfamily -\/1}, }\item[{bool}]{verbose}{ = {\ttfamily false}}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



this constructor does not take possession of the particles 


\begin{DoxyParams}{Parameters}
{\em begin} & pointer to first particles pdata\mbox{[}\mbox{]}\mbox{[}i\mbox{]} should be the position in physical Mpc, the class takes possession of the data and leaves the vector empty  \\
\hline
{\em redshift} & redshift of origin  \\
\hline
{\em cosmo} & cosmology  \\
\hline
{\em theta\+\_\+rotate} & rotation of particles around the origin  \\
\hline
{\em recenter} & center on center of mass  \\
\hline
{\em my\+\_\+inv\+\_\+area} & inverse area for mass compensation  \\
\hline
{\em Min\+PSize} & minimum particle size  \\
\hline
{\em max\+\_\+range} & if set this will cause the tree not be fully construct down to the bucket size outside this range \\
\hline
\end{DoxyParams}
\Hypertarget{class_lens_halo_particles_a287284a34695af4542c2dad6bf610baf}\index{LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}!LensHaloParticles@{LensHaloParticles}}
\index{LensHaloParticles@{LensHaloParticles}!LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}}
\doxysubsubsection{\texorpdfstring{LensHaloParticles()}{LensHaloParticles()}\hspace{0.1cm}{\footnotesize\ttfamily [4/5]}}
{\footnotesize\ttfamily \label{class_lens_halo_particles_a287284a34695af4542c2dad6bf610baf} 
template$<$typename PType $>$ \\
\mbox{\hyperlink{class_lens_halo_particles}{Lens\+Halo\+Particles}}$<$ PType $>$\mbox{\hyperlink{class_lens_halo_particles}{\+::\+Lens\+Halo\+Particles}} (\begin{DoxyParamCaption}\item[{float}]{redshift}{, }\item[{const \mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&}]{cosmo}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}


\begin{DoxyParams}{Parameters}
{\em redshift} & redshift of origin  \\
\hline
{\em cosmo} & cosmology \\
\hline
\end{DoxyParams}
\Hypertarget{class_lens_halo_particles_a36d9e0624adb91026d7ac1c648800f8c}\index{LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}!LensHaloParticles@{LensHaloParticles}}
\index{LensHaloParticles@{LensHaloParticles}!LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}}
\doxysubsubsection{\texorpdfstring{LensHaloParticles()}{LensHaloParticles()}\hspace{0.1cm}{\footnotesize\ttfamily [5/5]}}
{\footnotesize\ttfamily \label{class_lens_halo_particles_a36d9e0624adb91026d7ac1c648800f8c} 
template$<$typename PType $>$ \\
\mbox{\hyperlink{class_lens_halo_particles}{Lens\+Halo\+Particles}}$<$ PType $>$\mbox{\hyperlink{class_lens_halo_particles}{\+::\+Lens\+Halo\+Particles}} (\begin{DoxyParamCaption}\item[{PType \texorpdfstring{$\ast$}{*}}]{pdata}{, }\item[{size\+\_\+t}]{Nparticles}{, }\item[{float}]{redshift}{, }\item[{const \mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&}]{cosmo}{, }\item[{\mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}}}]{theta\+\_\+rotate}{, }\item[{bool}]{recenter}{, }\item[{double}]{my\+\_\+inv\+\_\+area}{, }\item[{bool}]{verbose}{ = {\ttfamily false}}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [protected]}}


\begin{DoxyParams}{Parameters}
{\em pdata} & particle data (all physical distances)  \\
\hline
{\em redshift} & redshift of origin  \\
\hline
{\em cosmo} & cosmology  \\
\hline
{\em theta\+\_\+rotate} & rotation of particles around the origin  \\
\hline
{\em recenter} & center on center of mass  \\
\hline
{\em my\+\_\+inv\+\_\+area} & inverse area for mass compensation \\
\hline
\end{DoxyParams}


\doxysubsection{Member Function Documentation}
\Hypertarget{class_lens_halo_particles_a9b240b0b6e022039c971dde8864ce6fd}\index{LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}!force\_halo@{force\_halo}}
\index{force\_halo@{force\_halo}!LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}}
\doxysubsubsection{\texorpdfstring{force\_halo()}{force\_halo()}}
{\footnotesize\ttfamily \label{class_lens_halo_particles_a9b240b0b6e022039c971dde8864ce6fd} 
template$<$typename PType $>$ \\
void \mbox{\hyperlink{class_lens_halo_particles}{Lens\+Halo\+Particles}}$<$ PType $>$\+::force\+\_\+halo (\begin{DoxyParamCaption}\item[{double \texorpdfstring{$\ast$}{*}}]{alpha}{, }\item[{Kappa\+Type \texorpdfstring{$\ast$}{*}}]{kappa}{, }\item[{Kappa\+Type \texorpdfstring{$\ast$}{*}}]{gamma}{, }\item[{Kappa\+Type \texorpdfstring{$\ast$}{*}}]{phi}{, }\item[{double const \texorpdfstring{$\ast$}{*}}]{xcm}{, }\item[{bool}]{subtract\+\_\+point}{ = {\ttfamily false}, }\item[{Pos\+Type}]{screening}{ = {\ttfamily 1.0}}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Reimplemented from \mbox{\hyperlink{class_lens_halo_a460de105e52520a328d5912455c02fdd}{Lens\+Halo}}.

\Hypertarget{class_lens_halo_particles_a6f74ecb8b18030fe0f01136192d9e4bb}\index{LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}!makeSIE@{makeSIE}}
\index{makeSIE@{makeSIE}!LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}}
\doxysubsubsection{\texorpdfstring{makeSIE()}{makeSIE()}}
{\footnotesize\ttfamily \label{class_lens_halo_particles_a6f74ecb8b18030fe0f01136192d9e4bb} 
template$<$typename PType $>$ \\
void \mbox{\hyperlink{class_lens_halo_particles}{Lens\+Halo\+Particles}}$<$ PType $>$\+::make\+SIE (\begin{DoxyParamCaption}\item[{std\+::string}]{new\+\_\+filename}{, }\item[{Pos\+Type}]{redshift}{, }\item[{double}]{particle\+\_\+mass}{, }\item[{double}]{total\+\_\+mass}{, }\item[{double}]{sigma}{, }\item[{double}]{q}{, }\item[{\mbox{\hyperlink{class_utilities_1_1_random_numbers___n_r}{Utilities\+::\+Random\+Numbers\+\_\+\+NR}} \&}]{ran}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



This is a test static function that makes a truncated SIE out of particles and puts it into a file in the right format for constructing a \doxylink{class_lens_halo_particles}{Lens\+Halo\+Particles}. 

This is useful for calculating the level of shot noise and finite source size. The particles are distributed in 3D according to the SIE profile with only the perpendicular coordinates (1st and 2nd) distorted into an elliptical shape. If the halo is rotated from the original orientation it will not be a oblate spheroid. 
\begin{DoxyParams}{Parameters}
{\em new\+\_\+filename} & file name to store the particles  \\
\hline
{\em redshift} & redshift of particles  \\
\hline
{\em particle\+\_\+mass} & particle mass  \\
\hline
{\em total\+\_\+mass} & total mass of SIE  \\
\hline
{\em sigma} & velocity dispersion in km/s  \\
\hline
{\em q} & axis ratio \\
\hline
\end{DoxyParams}
\Hypertarget{class_lens_halo_particles_a4fbe0f1a990d0e8c070e4f79b5c831b8}\index{LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}!readPositionFileASCII@{readPositionFileASCII}}
\index{readPositionFileASCII@{readPositionFileASCII}!LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}}
\doxysubsubsection{\texorpdfstring{readPositionFileASCII()}{readPositionFileASCII()}}
{\footnotesize\ttfamily \label{class_lens_halo_particles_a4fbe0f1a990d0e8c070e4f79b5c831b8} 
template$<$typename PType $>$ \\
void \mbox{\hyperlink{class_lens_halo_particles}{Lens\+Halo\+Particles}}$<$ PType $>$\+::read\+Position\+File\+ASCII (\begin{DoxyParamCaption}\item[{const std\+::string \&}]{filename}{}\end{DoxyParamCaption})}



Reads number of particle and particle positons into Npoint and xp from a ASCII file. 

Data file must have the lines "{}\# nparticles \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}"{} and "{}\# mass \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}"{} in the header. All header lines must begin with a "{}\# "{}

Coordinates of particles are in physical Mpc units. \Hypertarget{class_lens_halo_particles_a6d2a87ae29ff2a1840ffced17599d8a9}\index{LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}!rotate@{rotate}}
\index{rotate@{rotate}!LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}}
\doxysubsubsection{\texorpdfstring{rotate()}{rotate()}}
{\footnotesize\ttfamily \label{class_lens_halo_particles_a6d2a87ae29ff2a1840ffced17599d8a9} 
template$<$typename PType $>$ \\
void \mbox{\hyperlink{class_lens_halo_particles}{Lens\+Halo\+Particles}}$<$ PType $>$\+::rotate (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}}}]{theta}{}\end{DoxyParamCaption})}



rotate the simulation around the origin of the simulation coordinates, (radians) 

rotate simulation \Hypertarget{class_lens_halo_particles_a96e7e332fc3494f003293e608ebc5bb6}\index{LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}!set\_up@{set\_up}}
\index{set\_up@{set\_up}!LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}}
\doxysubsubsection{\texorpdfstring{set\_up()}{set\_up()}}
{\footnotesize\ttfamily \label{class_lens_halo_particles_a96e7e332fc3494f003293e608ebc5bb6} 
template$<$typename PType $>$ \\
void \mbox{\hyperlink{class_lens_halo_particles}{Lens\+Halo\+Particles}}$<$ PType $>$\+::set\+\_\+up (\begin{DoxyParamCaption}\item[{float}]{redshift}{, }\item[{const \mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&}]{cosmo}{, }\item[{\mbox{\hyperlink{struct_point__2d}{Point\+\_\+2d}}}]{theta\+\_\+rotate}{, }\item[{double}]{max\+\_\+range}{, }\item[{bool}]{recenter}{, }\item[{bool}]{verbose}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}


\begin{DoxyParams}{Parameters}
{\em redshift} & redshift of origin  \\
\hline
{\em cosmo} & cosmology  \\
\hline
{\em theta\+\_\+rotate} & rotation of particles around the origin  \\
\hline
{\em recenter} & center on center of mass \\
\hline
\end{DoxyParams}
\Hypertarget{class_lens_halo_particles_a46def593bc40d817ca3c45d521b700ce}\index{LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}!SIE@{SIE}}
\index{SIE@{SIE}!LensHaloParticles$<$ PType $>$@{LensHaloParticles$<$ PType $>$}}
\doxysubsubsection{\texorpdfstring{SIE()}{SIE()}}
{\footnotesize\ttfamily \label{class_lens_halo_particles_a46def593bc40d817ca3c45d521b700ce} 
template$<$typename PType $>$ \\
\mbox{\hyperlink{class_lens_halo_particles}{Lens\+Halo\+Particles}}$<$ \mbox{\hyperlink{struct_particle_type_simple}{Particle\+Type\+Simple}} $>$ \mbox{\hyperlink{class_lens_halo_particles}{Lens\+Halo\+Particles}}$<$ PType $>$\+::\+SIE (\begin{DoxyParamCaption}\item[{Pos\+Type}]{redshift}{, }\item[{double}]{particle\+\_\+mass}{, }\item[{double}]{total\+\_\+mass}{, }\item[{double}]{sigma}{, }\item[{double}]{q}{, }\item[{int}]{Nneighbors}{, }\item[{\mbox{\hyperlink{class_c_o_s_m_o_l_o_g_y}{COSMOLOGY}} \&}]{cosmo}{, }\item[{\mbox{\hyperlink{class_utilities_1_1_random_numbers___n_r}{Utilities\+::\+Random\+Numbers\+\_\+\+NR}} \&}]{ran}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



This is a test static function that makes a truncated SIE out of particles and puts it into a file in the right format for constructing a \doxylink{class_lens_halo_particles}{Lens\+Halo\+Particles}. 

This is useful for calculating the level of shot noise and finite source size. The particles are distributed in 3D according to the SIE profile with only the perpendicular coordinates (1st and 2nd) distorted into an elliptical shape. If the halo is rotated from the original orientation it will not be a oblate spheroid. 
\begin{DoxyParams}{Parameters}
{\em redshift} & redshift of particles  \\
\hline
{\em particle\+\_\+mass} & particle mass  \\
\hline
{\em total\+\_\+mass} & total mass of SIE  \\
\hline
{\em sigma} & velocity dispersion in km/s  \\
\hline
{\em q} & axis ratio  \\
\hline
{\em Nneighbors} & number of neighbor particles used in smoothing \\
\hline
\end{DoxyParams}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
SLsim\+Lib/include/particle\+\_\+halo.\+h\end{DoxyCompactItemize}
