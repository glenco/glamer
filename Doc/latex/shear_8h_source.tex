\doxysection{shear.\+h}
\hypertarget{shear_8h_source}{}\label{shear_8h_source}\index{SLsimLib/include/shear.h@{SLsimLib/include/shear.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ \ shear.h}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ \ GLAMER}}
\DoxyCodeLine{00004\ \textcolor{comment}{//}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ \ Created\ by\ Robert\ Benton\ Metcalf\ on\ 24/06/2020.}}
\DoxyCodeLine{00006\ \textcolor{comment}{//}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ These\ data\ structures\ and\ functions\ for\ storing\ and}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ minupulating\ shear\ and\ correlations\ between\ shears}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ on\ the\ sphere\ and\ flat-\/sky}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#ifndef\ shear\_h}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#define\ shear\_h}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ "{}geometry.h"{}}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00017\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00018\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_polar}{Polar}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_utilities_1_1_geometry_1_1_spherical_point}{Utilities::Geometry::SphericalPoint}}<T>}
\DoxyCodeLine{00019\ \{}
\DoxyCodeLine{00020\ \ \ \mbox{\hyperlink{struct_point__2d}{Point\_2d}}\ shear;}
\DoxyCodeLine{00021\ \ \ T\ kappa;}
\DoxyCodeLine{00022\ \};}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00025\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00026\ \mbox{\hyperlink{struct_point__2d}{Point\_2d}}\ tangent\_cross\_shear(}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_utilities_1_1_geometry_1_1_spherical_point}{Utilities::Geometry::SphericalPoint<T>}}\ \&xo}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ,\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_polar}{Polar<T>}}\ \&p}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )\{}
\DoxyCodeLine{00030\ \ \ \textcolor{comment}{//double\ d\ =\ xo.angular\_separation(p);}}
\DoxyCodeLine{00031\ \ \ \textcolor{comment}{//double\ cd\ =\ cos(d);}}
\DoxyCodeLine{00032\ \ \ \textcolor{comment}{//double\ sd\ =\ sin(d);}}
\DoxyCodeLine{00033\ \ }
\DoxyCodeLine{00034\ \ \ \mbox{\hyperlink{struct_point__3d}{Point\_3d<T>}}\ v1\ =\ xo.\mbox{\hyperlink{class_utilities_1_1_geometry_1_1_spherical_point_ad0cd07ad99b02ebd9ab7865628864a52}{TOcartisian}}()\ /(\ (xo.r\ <=\ 0)\ ?\ 1\ :\ xo.r\ );}
\DoxyCodeLine{00035\ \ \ \mbox{\hyperlink{struct_point__3d}{Point\_3d<T>}}\ v2\ =\ p.\mbox{\hyperlink{class_utilities_1_1_geometry_1_1_spherical_point_ad0cd07ad99b02ebd9ab7865628864a52}{TOcartisian}}()\ /(\ (p.r\ <=\ 0)\ ?\ 1\ :\ p.r\ );}
\DoxyCodeLine{00036\ \ \ \textcolor{keywordtype}{double}\ cd\ =\ v1*v2;}
\DoxyCodeLine{00037\ \ \ }
\DoxyCodeLine{00038\ \ \ \textcolor{comment}{//\ tangent\ vectors\ to\ the\ great\ circle\ at\ the\ two\ points}}
\DoxyCodeLine{00039\ \ \ \mbox{\hyperlink{struct_point__3d}{Point\_3d<T>}}\ t2\ =\ (v2\ *\ cd\ -\/\ v1);}
\DoxyCodeLine{00040\ \ \ \textcolor{comment}{//Point\_3d<T>\ t2\ =\ (\ v2\ -\/\ v1*cd\ );}}
\DoxyCodeLine{00041\ \ \ t2.\mbox{\hyperlink{struct_point__3d_a8f88aebedd3557d39440dba79cf02b39}{unitize}}();}
\DoxyCodeLine{00042\ \ \ }
\DoxyCodeLine{00043\ \ \ \textcolor{comment}{//\ unit\ vector\ in\ theta\ direction}}
\DoxyCodeLine{00044\ \ \ \textcolor{comment}{//Point\_3d<T>\ v\_theta\_2\ =\ p.theta\_hat();}}
\DoxyCodeLine{00045\ \ \ \mbox{\hyperlink{struct_point__3d}{Point\_3d<T>}}\ v\_theta\_2\ =\ p.phi\_hat();}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ T\ ct2\ =\ \ t2*v\_theta\_2;}
\DoxyCodeLine{00048\ \ \ T\ st2\ =\ (t2\string^v2)*v\_theta\_2;}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \textcolor{keywordtype}{double}\ c2theta\ =\ ct2*ct2-\/st2*st2;}
\DoxyCodeLine{00051\ \ \ \textcolor{keywordtype}{double}\ s2theta\ =\ 2*st2*ct2;}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \mbox{\hyperlink{struct_point__2d}{Point\_2d}}\ g2;}
\DoxyCodeLine{00054\ \ }
\DoxyCodeLine{00055\ \ \ g2[0]\ =\ c2theta\ *\ p.shear[0]\ +\ s2theta\ *\ p.shear[1];}
\DoxyCodeLine{00056\ \ \ g2[1]\ =\ c2theta\ *\ p.shear[1]\ -\/\ s2theta\ *\ p.shear[0];}
\DoxyCodeLine{00057\ \ \ }
\DoxyCodeLine{00058\ \ \ \textcolor{keywordflow}{return}\ g2;}
\DoxyCodeLine{00059\ \}}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00062\ \mbox{\hyperlink{struct_point__2d}{Point\_2d}}\ tangent\_cross\_shear(}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_point__2d}{Point\_2d}}\ \&xo}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ,\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_point__2d}{Point\_2d}}\ \&x}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ,\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_point__2d}{Point\_2d}}\ \&gamma}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )\{}
\DoxyCodeLine{00067\ \ \ }
\DoxyCodeLine{00068\ \ \ \mbox{\hyperlink{struct_point__2d}{Point\_2d}}\ t\ =\ (x-\/xo);}
\DoxyCodeLine{00069\ \ \ t.\mbox{\hyperlink{struct_point__2d_aa05515541562151e99c144fe83532df6}{unitize}}();}
\DoxyCodeLine{00070\ \ \ }
\DoxyCodeLine{00071\ \ \ \textcolor{keywordtype}{double}\ c2theta\ =\ t[0]*t[0]-\/t[1]*t[1];}
\DoxyCodeLine{00072\ \ \ \textcolor{keywordtype}{double}\ s2theta\ =\ 2*t[0]*t[1];}
\DoxyCodeLine{00073\ \ \ }
\DoxyCodeLine{00074\ \ \ \mbox{\hyperlink{struct_point__2d}{Point\_2d}}\ g2;}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ g2[0]\ =\ c2theta\ *\ gamma[0]\ -\/\ s2theta\ *\ gamma[1];}
\DoxyCodeLine{00077\ \ \ g2[1]\ =\ c2theta\ *\ gamma[1]\ +\ s2theta\ *\ gamma[0];}
\DoxyCodeLine{00078\ \ \ }
\DoxyCodeLine{00079\ \ \ \textcolor{keywordflow}{return}\ g2;}
\DoxyCodeLine{00080\ \}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00083\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{00084\ \mbox{\hyperlink{struct_point__3d}{Point\_3d<double>}}\ correlate(\mbox{\hyperlink{struct_polar}{Polar<T>}}\ \&p1,\mbox{\hyperlink{struct_polar}{Polar<T>}}\ \&p2)\{}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \mbox{\hyperlink{struct_point__2d}{Point\_2d}}\ g1,g2;}
\DoxyCodeLine{00087\ \ \ }
\DoxyCodeLine{00088\ \ \ g1\ =\ tangent\_cross\_shear(p2,\ p1);}
\DoxyCodeLine{00089\ \ \ g2\ =\ tangent\_cross\_shear(p1,\ p2);}
\DoxyCodeLine{00090\ }
\DoxyCodeLine{00091\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_point__3d}{Point\_3d<double>}}(g1[0]*g2[0],g1[1]*g2[1],g1[0]*g2[1]);}
\DoxyCodeLine{00092\ \}}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00095\ \mbox{\hyperlink{struct_point__3d}{Point\_3d<double>}}\ correlate(\mbox{\hyperlink{struct_point__2d}{Point\_2d}}\ \&x1,\mbox{\hyperlink{struct_point__2d}{Point\_2d}}\ \&g1,\mbox{\hyperlink{struct_point__2d}{Point\_2d}}\ \&x2,\mbox{\hyperlink{struct_point__2d}{Point\_2d}}\ \&g2)\{}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00097\ \ \ \mbox{\hyperlink{struct_point__2d}{Point\_2d}}\ gt1,gt2;}
\DoxyCodeLine{00098\ \ \ }
\DoxyCodeLine{00099\ \ \ gt1\ =\ tangent\_cross\_shear(x1,x2,g2);}
\DoxyCodeLine{00100\ \ \ gt2\ =\ tangent\_cross\_shear(x2,x1,g1);}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_point__3d}{Point\_3d<double>}}(gt1[0]*gt2[0],gt1[1]*gt2[1],gt1[0]*gt2[1]);}
\DoxyCodeLine{00103\ \}}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{/*\ shear\_h\ */}\textcolor{preprocessor}{}}

\end{DoxyCode}
